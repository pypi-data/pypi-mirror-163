"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_eventsRequest_tsx-app_views_performance_trends_changedTransactions_tsx","app_components_charts_eventsRequest_tsx"],{"./app/actionCreators/events.tsx":(e,t,r)=>{r.d(t,{JE:()=>c,eV:()=>d,lI:()=>l}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=r("../node_modules/lodash/pick.js"),n=r.n(a),s=r("./app/components/charts/utils.tsx"),o=r("./app/utils/getPeriod.tsx"),i=r("./app/utils/performance/constants.tsx");const l=(e,t)=>{var r;let{organization:a,project:n,environment:i,team:l,period:d,start:c,end:p,interval:u,comparisonDelta:m,includePrevious:g,query:h,yAxis:v,field:x,topEvents:f,orderby:Z,partial:y,withoutZerofill:b,referrer:w,queryBatching:_,generatePathname:D,queryExtras:j,excludeOther:S,includeAllArgs:T}=t;const E=null!==(r=null==D?void 0:D(a))&&void 0!==r?r:`/organizations/${a.slug}/events-stats/`,P=(0,s.Sw)(g,d),q={includeAllArgs:T,query:{...Object.fromEntries(Object.entries({interval:u,comparisonDelta:m,project:n,environment:i,team:l,query:h,yAxis:v,field:x,topEvents:f,orderby:Z,partial:y?"1":void 0,withoutZerofill:b?"1":void 0,referrer:w||"api.organization-event-stats",excludeOther:S?"1":void 0}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,o.X)({period:d,start:c,end:p},{shouldDoublePeriod:P}),...j}};return null!=_&&_.batchRequest?_.batchRequest(e,E,q):e.requestPromise(E,q)};function d(e,t,r){const a={...n()(r,Object.values(i.s)),query:r.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:a})}function c(e,t,r){const a={...n()(r,Object.values(i.s)),query:r.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:a}).then((e=>e.count))}},"./app/components/charts/eventsRequest.tsx":(e,t,r)=>{r.d(t,{Z:()=>y});var a=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),s=r("../node_modules/lodash/isEqual.js"),o=r.n(s),i=r("../node_modules/lodash/omitBy.js"),l=r.n(i),d=r("./app/actionCreators/events.tsx"),c=r("./app/actionCreators/indicator.tsx"),p=r("./app/components/charts/loadingPanel.tsx"),u=r("./app/components/charts/utils.tsx"),m=r("./app/locale.tsx"),g=r("./app/utils.tsx"),h=r("./app/utils/discover/fields.tsx"),v=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const x=["api","children","organization","loading","queryBatching","generatePathname"],f=e=>l()(e,((e,t)=>x.includes(t)));class Z extends n.PureComponent{constructor(){super(...arguments),(0,a.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,a.Z)(this,"unmounting",!1),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,onError:r,expired:a,name:n,hideError:s,...o}=this.props;let i,l=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),a)i=(0,m.t)("%s has an invalid date range. Please try a more recent date range.",n),(0,c.Iw)(i,{append:!0}),this.setState({errored:!0,errorMessage:i});else try{e.clear(),l=await(0,d.lI)(e,o)}catch(e){i=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,m.t)("Error loading chart data"),s||(0,c.Iw)(i),r&&r(i),this.setState({errored:!0,errorMessage:i})}this.unmounting||(this.setState({reloading:!1,timeseriesData:l,fetchedWithPrevious:o.includePrevious}),o.dataLoadedCallback&&o.dataLoadedCallback(l))}})),(0,a.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:r,includePrevious:a}=this.props,n=t||(0,u.Sw)(a,r),s=Math.floor(e.length/2);return{current:n?e.slice(s):e,previous:n?e.slice(0,s):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){o()(f(e),f(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>1e3*e;return e.map(((e,r)=>{let[a,n]=e;return{name:t(a,n,r),value:n.reduce(((e,t)=>{let{count:r}=t;return e+r}),0)}}))}transformPreviousPeriodData(e,t,r){return t?{seriesName:null!=r?r:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,r,a)=>1e3*e[a][0])),stack:"previous"}:null}transformAggregatedTimeseries(e){return{seriesName:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((e=>{let[t,r]=e;return{name:1e3*t,value:r.reduce(((e,t)=>{let{count:r}=t;return e+r}),0)}}))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((e=>{let[t,r]=e;return{name:1e3*t,value:r.reduce(((e,t)=>{let{comparisonCount:r}=t;return e+(null!=r?r:0)}),0)}}))}]}processData(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;const{data:n,isMetricsData:s,totals:o}=e,{includeTransformedData:i,includeTimeAggregation:l,timeAggregationSeriesName:d,currentSeriesNames:c,previousSeriesNames:p,comparisonDelta:m}=this.props,{current:g,previous:h}=this.getData(n);return{data:i?this.transformTimeseriesData(g,null!=a?a:null==c?void 0:c[r]):[],comparisonData:i&&m?this.transformComparisonTimeseriesData(g):[],allData:n,originalData:g,totals:o,isMetricsData:s,originalPreviousData:h,previousData:i?this.transformPreviousPeriodData(g,h,null!==(t=a?(0,u.TE)(a):void 0)&&void 0!==t?t:null==p?void 0:p[r]):null,timeAggregatedData:l?this.transformAggregatedTimeseries(g,d||""):{},timeframe:e.start&&e.end?h?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...r}=this.props,{topEvents:a}=this.props,{timeseriesData:n,reloading:s,errored:o,errorMessage:i}=this.state,l=this.props.loading||null===n;if(t&&l)return(0,v.tZ)(p.Z,{"data-test-id":"events-request-loading"});if((0,u.Xe)(n,(0,g.ri)(a))){let t;const a={},d=Object.keys(n).map(((e,r)=>{const s=n[e],o=this.processData(s,r,(0,h.bQ)(e));return t||(t=o.timeframe),o.isMetricsData&&(a[e]={isMetricsData:o.isMetricsData}),[s.order||0,o.data[0],o.previousData,{isMetricsData:o.isMetricsData}]})).sort(((e,t)=>e[0]-t[0])),c=d.map((e=>e[1])),p=d.some((e=>null===e[2]))?void 0:d.map((e=>e[2]));return e({loading:l,reloading:s,errored:o,errorMessage:i,results:c,timeframe:t,previousTimeseriesData:p,seriesAdditionalInfo:a,...r})}if(n){var d,c;const{data:t,comparisonData:a,allData:p,originalData:u,totals:m,originalPreviousData:g,previousData:h,timeAggregatedData:v,timeframe:x,isMetricsData:f}=this.processData(n);return e({loading:l,reloading:s,errored:o,errorMessage:i,seriesAdditionalInfo:{[null!==(d=null===(c=this.props.currentSeriesNames)||void 0===c?void 0:c[0])&&void 0!==d?d:"current"]:{isMetricsData:f}},timeseriesData:t,comparisonTimeseriesData:a,allTimeseriesData:p,originalTimeseriesData:u,timeseriesTotals:m,originalPreviousTimeseriesData:g,previousTimeseriesData:h?[h]:h,timeAggregatedData:v,timeframe:x,...r})}return e({loading:l,reloading:s,errored:o,errorMessage:i,...r})}}Z.displayName="EventsRequest",(0,a.Z)(Z,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const y=Z},"./app/components/charts/loadingPanel.tsx":(e,t,r)=>{r.d(t,{Z:()=>i});var a=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("./app/components/loadingMask.tsx"),s=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=(0,a.Z)((e=>{let{height:t,...r}=e;return(0,s.tZ)("div",{...r,children:(0,s.tZ)(n.Z,{})})}),{target:"eumb2md0"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");o.defaultProps={height:"200px"};const i=o},"./app/components/loadingMask.tsx":(e,t,r)=>{r.d(t,{Z:()=>a});const a=(0,r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1dnwgq10"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/utils/getPeriod.tsx":(e,t,r)=>{r.d(t,{X:()=>i}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.error.cause.js");var a=r("../node_modules/moment/moment.js"),n=r.n(a),s=r("./app/constants/index.tsx"),o=r("./app/utils/dates.tsx");function i(e){let{period:t,start:r,end:a}=e,{shouldDoublePeriod:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||r||a||(t=s.GY),t){if(!i)return{statsPeriod:t};const[,e,r]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${r}`}}if(!r||!a)throw new Error("start and end required");const l=(0,o.v5)(r),d=(0,o.v5)(a);if(i){const e=n()(a).diff(n()(r)),t=n()(r).subtract(e);return{start:(0,o.v5)(t),end:d}}return{start:l,end:d}}},"./app/views/performance/trends/changedTransactions.tsx":(e,t,r)=>{r.d(t,{H:()=>H,Z:()=>pe});var a,n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/react/index.js")),o=r("../node_modules/react-router/es/index.js"),i=r("./app/components/button.tsx"),l=r("./app/components/charts/styles.tsx"),d=r("./app/components/count.tsx"),c=r("./app/components/dropdownLink.tsx"),p=r("./app/components/duration.tsx"),u=r("./app/components/emptyStateWarning.tsx"),m=r("./app/components/forms/controls/radioGroup.tsx"),g=r("./app/components/idBadge/index.tsx"),h=r("./app/components/links/link.tsx"),v=r("./app/components/loadingIndicator.tsx"),x=r("./app/components/menuItem.tsx"),f=r("./app/components/pagination.tsx"),Z=r("./app/components/panels/index.tsx"),y=r("./app/components/questionTooltip.tsx"),b=r("./app/components/radio.tsx"),w=r("./app/components/tooltip.tsx"),_=r("./app/icons/index.tsx"),D=r("./app/locale.tsx"),j=r("./app/styles/space.tsx"),S=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),T=r("./app/utils/formatters.tsx"),E=r("./app/utils/performance/trends/trendsDiscoverQuery.tsx"),P=r("./app/utils/queryString.tsx"),q=r("./app/utils/tokenizeSearch.tsx"),C=r("./app/utils/useApi.tsx"),k=r("./app/utils/withOrganization.tsx"),R=r("./app/utils/withProjects.tsx"),M=r("./app/views/performance/transactionSummary/transactionOverview/charts.tsx"),A=r("./app/views/performance/transactionSummary/utils.tsx"),L=r("./app/views/performance/trends/chart.tsx"),N=r("./app/views/performance/trends/types.tsx"),z=r("./app/views/performance/trends/utils.tsx"),I=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function O(e){switch(e){case N.ER.IMPROVED:return(0,D.t)("Most Improved Transactions");case N.ER.REGRESSION:return(0,D.t)("Most Regressed Transactions");default:throw new Error("No trend type passed")}}function B(e,t,r){const a=(0,z.j_)(t),n=(0,P.ro)(e.query[a]);if(!r)return;return r.find((e=>`${e.transaction}-${e.project}`===n))||(r.length>0?r[0]:void 0)}function X(e,t,r){return function(a){const n=(0,z.j_)(r),s={...e.query};a?s[n]=a?`${a.transaction}-${a.project}`:void 0:delete s[n],o.browserHistory.push({pathname:e.pathname,query:s}),(0,S.Z)("performance_views.trends.widget_interaction",{organization:t,widget_type:r})}}function V(e,t,r,n,s,i,l){const d=(0,z.IO)(e,i,l).column,c=(0,P.ro)(e.query.query),p=new q.MY(null!=c?c:""),u=p.getFilterValues(d),m=n===a.GREATER_THAN_EQUALS?">":"<";u&&u.forEach((e=>{(e.startsWith(n)||e.startsWith(m))&&p.removeFilterValue(d,e)})),p.addFilterValues(d,[`${n}${r}`]);const g=p.formatString();o.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(g).trim()}}),(0,S.Z)("performance_views.trends.change_duration",{organization:t,widget_type:O(s),value:`${n}${r}`})}function F(e){const{location:t,trendChangeType:r,previousTrendFunction:a,previousTrendColumn:n,organization:i,projects:l,setError:d}=e,c=(0,C.Z)(),p=e.trendView.clone(),u=O(r);(0,z.kM)(p,t,r,l);const m=(e=>(t,r,a)=>{const n={};e===N.ER.IMPROVED?n.improvedCursor=t:e===N.ER.REGRESSION&&(n.regressionCursor=t),delete a[(0,z.j_)(e)],o.browserHistory.push({pathname:r,query:{...a,...n}})})(r),g=(0,P.ro)(t.query[z.vt[r]]),h=e=>{(0,S.Z)("performance_views.trends.widget_pagination",{organization:i,direction:e,widget_type:O(r)})};return(0,I.tZ)(E.ZP,{eventView:p,orgSlug:i.slug,location:t,trendChangeType:r,cursor:g,limit:5,setError:e=>d(null==e?void 0:e.message),children:o=>{let{isLoading:d,trendsData:g,pageLinks:x}=o;const Z=(0,z.CE)(t),b=(0,z.IO)(t,l,p.project),w=(0,z.RP)(g&&g.events&&g.events.data||[]),_=B(t,r,w),j=(null==g?void 0:g.stats)||{},S=w&&w.slice?w.slice(0,5):[],T=d&&a?a:Z.field,E=d&&n?n:b.column,P=(0,D.t)("This compares the baseline (%s) of the past with the present.",Z.legendLabel);return(0,I.BX)(U,{"data-test-id":"changed-transactions",children:[(0,I.BX)(W,{children:[(0,I.BX)(Y,{children:[u,(0,I.tZ)(y.Z,{size:"sm",position:"top",title:P})]}),d?(0,I.tZ)(v.Z,{style:{margin:"237px auto"}}):(0,I.tZ)(s.Fragment,{children:S.length?(0,I.BX)(s.Fragment,{children:[(0,I.tZ)(J,{children:(0,I.tZ)(L.Z,{statsData:j,query:p.query,project:p.project,environment:p.environment,start:p.start,end:p.end,statsPeriod:p.statsPeriod,transaction:_,isLoading:d,...e})}),S.map(((a,n)=>(0,I.tZ)($,{api:c,currentTrendFunction:T,currentTrendColumn:E,trendView:e.trendView,organization:i,transaction:a,index:n,trendChangeType:r,transactions:S,location:t,projects:l,statsData:j,handleSelectTransaction:X(t,i,r)},a.transaction)))]}):(0,I.tZ)(te,{small:!0,children:(0,D.t)("No results")})})]}),(0,I.tZ)(f.Z,{pageLinks:x,onCursor:m,paginationAnalyticsEvent:h})]})}})}function $(e){const{transaction:t,transactions:r,trendChangeType:n,currentTrendFunction:i,currentTrendColumn:l,index:p,location:u,organization:h,projects:v,handleSelectTransaction:f,trendView:Z}=e,y=z.es[n].default,j=B(u,n,r)===t,S=v.find((e=>{let{slug:r}=e;return r===t.project})),E=t.aggregate_range_2,C=t.aggregate_range_1,k=(0,T.rl)(Math.abs(t.trend_percentage-1),0),R=(0,T.g9)(C/1e3,C<1e3&&C>10?0:2),M=(0,T.g9)(E/1e3,E<1e3&&E>10?0:2),A=(0,D.t)("Over this period, the %s for %s has %s %s from %s to %s",i,l,n===N.ER.IMPROVED?(0,D.t)("decreased"):(0,D.t)("increased"),k,R,M),L=n===N.ER.IMPROVED?C:E,O=n===N.ER.IMPROVED?R:M;return(0,I.BX)(re,{"data-test-id":"trends-list-item-"+n,children:[(0,I.tZ)(ae,{color:y,children:(0,I.tZ)(w.Z,{title:(0,I.BX)(de,{children:[(0,I.tZ)("span",{children:(0,D.t)("Total Events")}),(0,I.BX)("span",{children:[(0,I.tZ)(d.Z,{value:t.count_range_1}),(0,I.tZ)(ce,{direction:"right",size:"xs"}),(0,I.tZ)(d.Z,{value:t.count_range_2})]})]}),disableForVisualTest:!0,children:(0,I.tZ)(m.V,{index:p,role:"radio",children:(0,I.tZ)(b.Z,{checked:j,onChange:()=>f(t)})})})}),(0,I.tZ)(Q,{...e}),(0,I.tZ)(ie,{children:(0,I.tZ)(w.Z,{title:A,children:(0,I.BX)(s.Fragment,{children:[n===N.ER.REGRESSION?"+":"",(0,T.rl)(t.trend_percentage-1,0)]})})}),(0,I.BX)(c.Z,{caret:!1,anchorRight:!0,title:(0,I.tZ)(K,{size:"xs",icon:(0,I.tZ)(_.YR,{"data-test-id":"trends-item-action",size:"xs"}),"aria-label":(0,D.t)("Actions")}),children:[(0,I.tZ)(x.Z,{onClick:()=>V(u,h,L,a.LESS_THAN_EQUALS,n,v,Z.project),children:(0,I.tZ)(ee,{children:(0,D.t)("Show ≤ %s",O)})}),(0,I.tZ)(x.Z,{onClick:()=>V(u,h,L,a.GREATER_THAN_EQUALS,n,v,Z.project),children:(0,I.tZ)(ee,{children:(0,D.t)("Show ≥ %s",O)})}),(0,I.tZ)(x.Z,{onClick:()=>function(e,t){const r=(0,P.ro)(e.query.query),a=new q.MY(null!=r?r:"");a.addFilterValues("!transaction",[t]);const n=a.formatString();o.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(n).trim()}})}(u,t.transaction),children:(0,I.tZ)(ee,{children:(0,D.t)("Hide from list")})})]}),(0,I.BX)(se,{children:[S&&(0,I.tZ)(w.Z,{title:t.project,children:(0,I.tZ)(g.Z,{avatarSize:16,project:S,hideName:!0})}),(0,I.tZ)(H,{...e})]}),(0,I.tZ)(le,{color:y,children:(0,I.tZ)(G,{...e})})]})}!function(e){e.GREATER_THAN_EQUALS=">=",e.LESS_THAN_EQUALS="<="}(a||(a={})),F.displayName="ChangedTransactions",$.displayName="TrendsListItem";const H=e=>{let{transaction:t}=e;const{fromSeconds:r,toSeconds:a,showDigits:n}=(0,z.Kt)(t.aggregate_range_1,t.aggregate_range_2);return(0,I.BX)(oe,{children:[(0,I.tZ)(p.Z,{seconds:r,fixedDigits:n?1:0,abbreviation:!0}),(0,I.tZ)(ce,{direction:"right",size:"xs"}),(0,I.tZ)(p.Z,{seconds:a,fixedDigits:n?1:0,abbreviation:!0})]})};H.displayName="CompareDurations";const G=e=>{let{transaction:t,trendChangeType:r}=e;const{seconds:a,fixedDigits:n,changeLabel:s}=(0,z.wx)(t.trend_difference,r);return(0,I.BX)("span",{children:[(0,I.tZ)(p.Z,{seconds:a,fixedDigits:n,abbreviation:!0})," ",s]})};G.displayName="ValueDelta";const Q=e=>{const{organization:t,trendView:r,transaction:a,projects:n,currentTrendFunction:s,currentTrendColumn:o}=e,i=r.clone(),l=(0,z._H)(a,n),d=(0,A.e1)({orgSlug:t.slug,transaction:String(a.transaction),query:i.generateQueryStringObject(),projectID:l,display:M.D.TREND,trendFunction:s,trendColumn:o});return(0,I.tZ)(ne,{to:d,"data-test-id":"item-transaction-name",children:a.transaction})};Q.displayName="TransactionSummaryLink";const U=(0,n.Z)("div",{target:"e11bn3w115"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),W=(0,n.Z)(Z.s_,{target:"e11bn3w114"})({name:"154zghl",styles:"margin:0;flex-grow:1"}),J=(0,n.Z)("div",{target:"e11bn3w113"})("padding:",(0,j.Z)(3),";"),Y=(0,n.Z)(l.ws,{target:"e11bn3w112"})("border-radius:",(e=>e.theme.borderRadius),";margin:",(0,j.Z)(2)," ",(0,j.Z)(3),";"),K=(0,n.Z)(i.ZP,{target:"e11bn3w111"})({name:"1989ovb",styles:"vertical-align:middle"}),ee=(0,n.Z)("div",{target:"e11bn3w110"})("white-space:nowrap;color:",(e=>e.theme.textColor),";");ee.defaultProps={"data-test-id":"menu-action"};const te=(0,n.Z)(u.Z,{target:"e11bn3w19"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),re=(0,n.Z)("div",{target:"e11bn3w18"})("display:grid;grid-template-columns:24px auto 100px 30px;grid-template-rows:repeat(2, auto);grid-column-gap:",(0,j.Z)(1),";border-top:1px solid ",(e=>e.theme.border),";padding:",(0,j.Z)(1)," ",(0,j.Z)(2),";"),ae=(0,n.Z)("div",{target:"e11bn3w17"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(e=>e.color),";}"),ne=(0,n.Z)(h.Z,{target:"e11bn3w16"})("font-size:",(e=>e.theme.fontSizeMedium),";margin-right:",(0,j.Z)(1),";",(e=>e.theme.overflowEllipsis),";"),se=(0,n.Z)("div",{target:"e11bn3w15"})("display:flex;align-items:center;font-size:",(e=>e.theme.fontSizeSmall),";"),oe=(0,n.Z)("span",{target:"e11bn3w14"})("color:",(e=>e.theme.gray300),";margin:0 ",(0,j.Z)(1),";"),ie=(0,n.Z)("div",{target:"e11bn3w13"})("text-align:right;font-size:",(e=>e.theme.fontSizeMedium),";"),le=(0,n.Z)("div",{target:"e11bn3w12"})("color:",(e=>e.color),";text-align:right;font-size:",(e=>e.theme.fontSizeSmall),";"),de=(0,n.Z)("div",{target:"e11bn3w11"})({name:"zigog8",styles:"display:flex;flex-direction:column;align-items:center"}),ce=(0,n.Z)(_.CC,{target:"e11bn3w10"})("margin:0 ",(0,j.Z)(1),";"),pe=(0,R.Z)((0,k.Z)(F))},"./app/views/performance/trends/chart.tsx":(e,t,r)=>{r.d(t,{Z:()=>y,k:()=>Z}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=r("../node_modules/react-router/es/index.js"),n=r("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),s=r("./app/components/charts/chartZoom.tsx"),o=r("./app/components/charts/lineChart.tsx"),i=r("./app/components/charts/transitionChart.tsx"),l=r("./app/components/charts/transparentLoadingMask.tsx"),d=r("./app/components/organizations/pageFilters/parse.tsx"),c=r("./app/locale.tsx"),p=r("./app/utils/dates.tsx"),u=r("./app/utils/discover/charts.tsx"),m=r("./app/utils/discover/fields.tsx"),g=r("./app/utils/getDynamicText.tsx"),h=r("./app/utils/queryString.tsx"),v=r("./app/views/performance/trends/utils.tsx"),x=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function f(e){return{right:10,top:0,itemGap:12,align:"left",data:[{name:"Baseline",icon:"path://M180 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40z, M810 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40zm, M1440 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40z"},{name:"Releases"},{name:e}]}}function Z(e){var t;let{trendChangeType:r,router:Z,statsPeriod:y,transaction:b,statsData:w,isLoading:_,location:D,start:j,end:S,trendFunctionField:T,disableXAxis:E,disableLegend:P,grid:q,height:C,projects:k,project:R}=e;const M=(0,n.a)(),A=e=>{const{selected:t}=e,n=Object.keys(t).filter((e=>!t[e])),s={...D.query};s[(0,v.P4)(r)]=n;const o={...D,query:s};a.browserHistory.push(o)},L=v.es[r||""],N=w&&null!=b&&b.project&&null!=b&&b.transaction?w[[b.project,b.transaction].join(",")]:void 0,z=null!==(t=null==N?void 0:N.data)&&void 0!==t?t:[],I=(0,v.CE)(D,T),O=(0,v.IO)(D,k,R),B=(0,v.ed)(I.field,O.column),X=function(e,t){return[{seriesName:t||"Current",data:e.map((e=>{let[t,r]=e;return{name:1e3*t,value:r.reduce(((e,t)=>{let{count:r}=t;return e+r}),0)}}))}]}(z,B),{smoothedResults:V,minValue:F,maxValue:$}=(0,v.vq)(X,B),H=j?(0,p.hC)(j):null,G=S?(0,p.hC)(S):null,{utc:Q}=(0,d.fK)(D.query),U=(0,h.qP)(D.query[(0,v.P4)(r)]).reduce(((e,t)=>(e[t]=!1,e)),{}),W=P?{show:!1}:{...f(B),selected:U},J=_,Y=_,K=Math.max($,(null==b?void 0:b.aggregate_range_2)||0,(null==b?void 0:b.aggregate_range_1)||0),ee=Math.min(F,(null==b?void 0:b.aggregate_range_1)||Number.MAX_SAFE_INTEGER,(null==b?void 0:b.aggregate_range_2)||Number.MAX_SAFE_INTEGER),te=V?V.map((e=>({...e,color:L.default,lineStyle:{opacity:1}}))):[],re=function(e,t,r,a){if(!(a&&t.length&&t[0].data&&t[0].data.length))return[];const n=parseInt(t[0].data[0].name,10),s=parseInt(t[0].data.slice(-1)[0].name,10);if(s<n)return[];const o={data:[],color:e.textColor,markLine:{data:[],label:{},lineStyle:{color:e.textColor,type:"dashed",width:1},symbol:["none","none"],tooltip:{show:!1}},seriesName:"Baseline"},i={fontSize:11,show:!0,color:e.textColor,silent:!0},l={...o,markLine:{...o.markLine},seriesName:"Baseline"},d={...o,markLine:{...o.markLine},seriesName:"Baseline"},p={...o,markLine:{...o.markLine},seriesName:"Period split"},m=.5*(s-n)+n;return l.markLine.data=[[{value:"Past",coord:[n,a.aggregate_range_1]},{coord:[m,a.aggregate_range_1]}]],l.markLine.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">',"<div>",`<span class="tooltip-label"><strong>${(0,c.t)("Past Baseline")}</strong></span>`,(0,u.CX)(a.aggregate_range_1,"duration"),"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")},d.markLine.data=[[{value:"Present",coord:[m,a.aggregate_range_2]},{coord:[s,a.aggregate_range_2]}]],d.markLine.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">',"<div>",`<span class="tooltip-label"><strong>${(0,c.t)("Present Baseline")}</strong></span>`,(0,u.CX)(a.aggregate_range_2,"duration"),"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")},p.markLine={data:[{xAxis:m}],label:{show:!1},lineStyle:{color:e.textColor,type:"solid",width:2},symbol:["none","none"],tooltip:{show:!1},silent:!0},l.markLine.label={...i,formatter:"Past",position:"insideStartBottom"},d.markLine.label={...i,formatter:"Present",position:"insideEndBottom"},[l,d,p]}(M,V||[],0,b),ae=.1*(K-ee),ne=[...te,...re],se=(0,u.Xp)(ne),oe={tooltip:{valueFormatter:(e,t)=>(0,u.CX)(e,(0,m.Px)(t))},yAxis:{min:Math.max(0,ee-ae),max:K+ae,minInterval:se,axisLabel:{color:M.chartLabel,formatter:e=>(0,u.gu)(e,"duration",void 0,se)}}};return(0,x.tZ)(s.Z,{router:Z,period:y,start:H,end:G,utc:"true"===Q,children:e=>(0,x.BX)(i.Z,{loading:J,reloading:Y,children:[(0,x.tZ)(l.Z,{visible:Y}),(0,g.Z)({value:(0,x.tZ)(o.w,{height:C,...e,...oe,onLegendSelectChanged:A,series:ne,seriesOptions:{showSymbol:!1},legend:W,toolBox:{show:!1},grid:null!=q?q:{left:"10px",right:"10px",top:"40px",bottom:"0px"},xAxis:E?{show:!1}:void 0}),fixed:"Duration Chart"})]})})}Z.displayName="Chart";const y=(0,a.withRouter)(Z)}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsRequest_tsx-app_views_performance_trends_changedTransactions_tsx.2240852a423809b973d35d546b3978a8.js.map