"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_loadingPanel_tsx-app_components_modals_widgetViewerModal_utils_tsx-app_-39afc0"],{"./app/actionCreators/events.tsx":(e,t,s)=>{s.d(t,{JE:()=>u,eV:()=>d,lI:()=>l}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/lodash/pick.js"),i=s.n(r),n=s("./app/components/charts/utils.tsx"),o=s("./app/utils/getPeriod.tsx"),a=s("./app/utils/performance/constants.tsx");const l=(e,t)=>{var s;let{organization:r,project:i,environment:a,team:l,period:d,start:u,end:c,interval:p,comparisonDelta:m,includePrevious:g,query:h,yAxis:v,field:f,topEvents:b,orderby:y,partial:x,withoutZerofill:w,referrer:Z,queryBatching:S,generatePathname:j,queryExtras:O,excludeOther:_,includeAllArgs:E}=t;const F=null!==(s=null==j?void 0:j(r))&&void 0!==s?s:`/organizations/${r.slug}/events-stats/`,C=(0,n.Sw)(g,d),T={includeAllArgs:E,query:{...Object.fromEntries(Object.entries({interval:p,comparisonDelta:m,project:i,environment:a,team:l,query:h,yAxis:v,field:f,topEvents:b,orderby:y,partial:x?"1":void 0,withoutZerofill:w?"1":void 0,referrer:Z||"api.organization-event-stats",excludeOther:_?"1":void 0}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,o.X)({period:d,start:u,end:c},{shouldDoublePeriod:C}),...O}};return null!=S&&S.batchRequest?S.batchRequest(e,F,T):e.requestPromise(F,T)};function d(e,t,s){const r={...i()(s,Object.values(a.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:r})}function u(e,t,s){const r={...i()(s,Object.values(a.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:r}).then((e=>e.count))}},"./app/components/charts/loadingPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/loadingMask.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=(0,r.Z)((e=>{let{height:t,...s}=e;return(0,n.tZ)("div",{...s,children:(0,n.tZ)(i.Z,{})})}),{target:"eumb2md0"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");o.defaultProps={height:"200px"};const a=o},"./app/components/charts/simpleTableChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>x,p:()=>y});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),n=s("./app/components/panels/panelTable.tsx"),o=s("./app/components/tooltip.tsx"),a=s("./app/components/truncate.tsx"),l=s("./app/styles/space.tsx"),d=s("./app/utils/discover/fieldRenderers.tsx"),u=s("./app/utils/discover/fields.tsx"),c=s("./app/utils/withOrganization.tsx"),p=s("./app/views/eventsV2/table/topResultsIndicator.tsx"),m=s("./app/views/eventsV2/utils.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function h(e){let{className:t,loading:s,eventView:r,fields:n,metadata:a,data:l,title:c,fieldHeaderMap:h,stickyHeaders:x,getCustomFieldRenderer:w,organization:Z,topResultsIndicators:S,location:j,fieldAliases:O,loader:_}=e;const E=null!=a?a:{},F=Z.features.includes("discover-frontend-use-events-endpoint"),C=(0,m.Hg)(n.map(((e,t)=>({field:e,alias:O[t]}))),F);return(0,g.BX)(i.Fragment,{children:[c&&(0,g.tZ)("h4",{children:c}),(0,g.tZ)(f,{className:t,isLoading:s,loader:_,headers:C.map(((e,t)=>{var s;const r=(0,u.qG)(e.name,e.type,E),i=e.column.alias||(null!==(s=null==h?void 0:h[e.key])&&void 0!==s?s:e.name);return(0,g.tZ)(b,{align:r,children:(0,g.tZ)(o.Z,{title:i,children:(0,g.tZ)(v,{value:i,maxLength:30,expandable:!1})})},t)})),isEmpty:!(null!=l&&l.length),stickyHeaders:x,disablePadding:!0,children:null==l?void 0:l.map(((e,t)=>function(e,t,s,i){return i.map(((i,n)=>{var o,a;const l=null!==(o=null==w?void 0:w(i.key,s,Z))&&void 0!==o?o:(0,d.Js)(i.key,s),u=null===(a=s.units)||void 0===a?void 0:a[i.key];return(0,g.BX)(y,{children:[S&&0===n&&(0,g.tZ)(p.Z,{count:S,index:e}),l(t,{organization:Z,location:j,eventView:r,unit:u})]},`${e}-${n}:${i.name}`)}))}(t,e,E,C)))})]})}h.displayName="SimpleTableChart";const v=(0,r.Z)(a.Z,{target:"e3tr8vk3"})({name:"1bmnxg7",styles:"white-space:nowrap"}),f=(0,r.Z)(n.Z,{target:"e3tr8vk2"})("border-radius:0;border-left:0;border-right:0;border-bottom:0;margin:0;",n.z,"{height:min-content;}"),b=(0,r.Z)("div",{target:"e3tr8vk1"})((e=>e.align?`text-align: ${e.align};`:"")," padding:",(0,l.Z)(1)," ",(0,l.Z)(3),";"),y=(0,r.Z)("div",{target:"e3tr8vk0"})("padding:",(0,l.Z)(1)," ",(0,l.Z)(3),";"),x=(0,c.Z)(h)},"./app/components/dashboards/widgetQueriesForm.tsx":(e,t,s)=>{s.d(t,{ZP:()=>T,_4:()=>j});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/cloneDeep.js"),a=s.n(o),l=s("./app/components/button.tsx"),d=s("./app/components/events/searchBar.tsx"),u=s("./app/components/forms/field/index.tsx"),c=s("./app/components/forms/selectControl.tsx"),p=s("./app/components/input.tsx"),m=s("./app/constants/index.tsx"),g=s("./app/icons/index.tsx"),h=s("./app/locale.tsx"),v=s("./app/styles/space.tsx"),f=s("./app/utils.tsx"),b=s("./app/utils/discover/fields.tsx"),y=s("./app/views/dashboardsV2/types.tsx"),x=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/releaseSearchBar.tsx"),w=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),Z=s("./app/components/dashboards/widgetQueryFields.tsx"),S=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const j=e=>{let{aggregates:t,columns:s,widgetType:r,widgetBuilderNewDesign:i=!1}=e;const n=r===y.l9.RELEASE,o=[];let a=0;return(n?[...t.map(b.hr),...s]:[...t,...s]).filter((e=>!!e)).filter((e=>!w.d2.includes(e))).filter((e=>!n||!w.aE.includes(e))).forEach((e=>{var t,s;let r;const n=(0,b.bQ)(e);var l;(0,b.GO)(e)&&(r=`equation[${a}]`,a+=1),i?o.push({label:n,value:null!==(l=r)&&void 0!==l?l:e}):(o.push({label:(0,h.t)("%s asc",n),value:null!==(t=r)&&void 0!==t?t:e}),o.push({label:(0,h.t)("%s desc",n),value:`-${null!==(s=r)&&void 0!==s?s:e}`}))})),o};class O extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"blurTimeout",void 0),(0,r.Z)(this,"handleFieldChange",((e,t)=>{const{queries:s,onChange:r}=this.props,i=s[e];return function(s){const n={...i,[t]:s};r(e,n)}}))}componentWillUnmount(){window.clearTimeout(this.blurTimeout)}getFirstQueryError(e){const{errors:t}=this.props;if(t)return t.find((t=>t&&t[e]))}renderSearchBar(e,t){const{organization:s,selection:r,widgetType:i}=this.props;return i===y.l9.RELEASE?(0,S.tZ)(x.D,{organization:s,widgetQuery:e,onClose:e=>{this.handleFieldChange(t,"conditions")(e)},pageFilters:r}):(0,S.tZ)(F,{searchSource:"widget_builder",organization:s,projectIds:r.projects,query:e.conditions,fields:[],onClose:e=>{this.handleFieldChange(t,"conditions")(e)},useFormWrapper:!1,maxQueryLength:m.dI})}render(){var e;const{organization:t,errors:s,queries:r,canAddSearchConditions:i,handleAddSearchConditions:n,handleDeleteQuery:o,displayType:d,fieldOptions:p,onChange:m,widgetType:x=y.l9.DISCOVER}=this.props,w=["table","world_map","big_number"].includes(d),O=r[0],F=(0,f.ri)(O.fields)?O.fields.map((e=>(0,b.HM)({field:e}))):[...O.columns,...O.aggregates].map((e=>(0,b.HM)({field:e})));return(0,S.BX)(_,{children:[r.map(((e,t)=>(0,S.tZ)(u.Z,{label:0===t?(0,h.t)("Query"):null,inline:!1,style:{paddingBottom:"8px"},flexibleControlStateSize:!0,stacked:!0,error:null==s?void 0:s[t].conditions,children:(0,S.BX)(E,{children:[this.renderSearchBar(e,t),!w&&(0,S.tZ)(C,{type:"text",name:"name",required:!0,value:e.name,placeholder:(0,h.t)("Legend Alias"),onChange:e=>this.handleFieldChange(t,"name")(e.target.value)}),r.length>1&&(0,S.tZ)(l.ZP,{size:"zero",borderless:!0,onClick:e=>{e.preventDefault(),o(t)},icon:(0,S.tZ)(g.Fz,{}),title:(0,h.t)("Remove query"),"aria-label":(0,h.t)("Remove query")})]})},t))),i&&(0,S.tZ)(l.ZP,{size:"sm",icon:(0,S.tZ)(g.N_,{isCircled:!0}),onClick:e=>{e.preventDefault(),n()},children:(0,h.t)("Add Query")}),(0,S.tZ)(Z.Z,{widgetType:x,displayType:d,fieldOptions:p,errors:this.getFirstQueryError("fields"),fields:F,organization:t,onChange:e=>{const{aggregates:t,columns:s}=(0,b.KZ)(e),i=e.map((e=>(0,b.sN)(e)));r.forEach(((r,n)=>{const o=a()(r);if(o.fields=i,o.aggregates=t,o.columns=s,(0,f.ri)(r.orderby)){const s=r.orderby.startsWith("-"),i=r.orderby.replace("-",""),n=(0,f.ri)(r.fields)?r.fields:[...r.columns,...r.aggregates];t.includes(i)||""===r.orderby||(n.length===e.length?o.orderby=`${s?"-":""}${t[n.indexOf(i)]}`:o.orderby="")}m(n,o)}))}}),["table","top_n"].includes(d)&&(0,S.tZ)(u.Z,{label:(0,h.t)("Sort by"),inline:!1,flexibleControlStateSize:!0,stacked:!0,error:null===(e=this.getFirstQueryError("orderby"))||void 0===e?void 0:e.orderby,style:{marginBottom:(0,v.Z)(1)},children:(0,S.tZ)(c.Z,{value:r[0].orderby,name:"orderby",options:j({widgetType:x,columns:r[0].columns,aggregates:r[0].aggregates}),onChange:e=>this.handleFieldChange(0,"orderby")(e.value)})})]})}}O.displayName="WidgetQueriesForm";const _=(0,i.Z)("div",{target:"e10b8jq53"})({name:"bjn8wh",styles:"position:relative"}),E=(0,i.Z)("div",{target:"e10b8jq52"})("display:flex;align-items:center;>*+*{margin-left:",(0,v.Z)(1),";}"),F=(0,i.Z)(d.Z,{target:"e10b8jq51"})({name:"1ff36h2",styles:"flex-grow:1"}),C=(0,i.Z)(p.Z,{target:"e10b8jq50"})({name:"1f6lq61",styles:"width:33%"}),T=O},"./app/components/dashboards/widgetQueryFields.tsx":(e,t,s)=>{s.d(t,{Z:()=>w});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),n=s("./app/components/button.tsx"),o=s("./app/components/forms/field/index.tsx"),a=s("./app/icons/index.tsx"),l=s("./app/locale.tsx"),d=s("./app/styles/space.tsx"),u=s("./app/utils/discover/fields.tsx"),c=s("./app/views/dashboardsV2/types.tsx"),p=s("./app/views/eventsV2/table/columnEditCollection.tsx"),m=s("./app/views/eventsV2/table/queryField.tsx"),g=s("./app/views/eventsV2/table/types.tsx"),h=s("./app/views/eventsV2/utils.tsx"),v=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function f(e){let{widgetType:t,displayType:s,errors:r,fields:p,fieldOptions:f,organization:w,onChange:Z,style:S}=e;const j=t===c.l9.RELEASE,O="big_number"===s,_=e=>{if(t===c.l9.RELEASE){if(s===c.FO.TABLE)return[g.L.FUNCTION,g.L.TAG,g.L.NUMERIC_METRICS].includes(e.value.kind);if(s===c.FO.TOP_N)return e.value.kind===g.L.TAG}if(!O&&e.value.kind===g.L.FUNCTION){const t=(0,u._4)(e.value.meta.name,void 0);if(t)return(0,u.HW)(t)}return[g.L.FUNCTION,g.L.NUMERIC_METRICS].includes(e.value.kind)},E=e=>[g.L.FUNCTION,g.L.NUMERIC_METRICS].includes(e.value.kind),F=e=>t=>{if(O)return!0;if(e.kind!==g.L.FUNCTION)return!0;if(j||t.value.kind===g.L.METRICS)return!0;const s=e.function[0],r=(0,u._4)(s,t.value.meta.name);return r?(0,u.HW)(r):t.value.kind!==g.L.FUNCTION&&t.value.kind!==g.L.EQUATION&&(0,u.HW)(t.value.meta.dataType)},C=["world_map","big_number"].includes(s)&&1===p.length||["line","area","stacked_area","bar"].includes(s)&&3===p.length,T=p.length>1;if("table"===s)return(0,v.tZ)(o.Z,{"data-test-id":"columns",label:(0,l.t)("Columns"),inline:!1,style:{padding:`${(0,d.Z)(1)} 0`,...null!=S?S:{}},error:null==r?void 0:r.fields,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,v.tZ)(b,{columns:p,onChange:function(e){Z(e)},fieldOptions:f,organization:w,filterPrimaryOptions:j?_:void 0,source:t})});if("top_n"===s){const e=p[p.length-1],s=p.slice(0,p.length-1);return(0,v.BX)(i.Fragment,{children:[(0,v.tZ)(o.Z,{"data-test-id":"columns",label:(0,l.t)("Columns"),inline:!1,style:{padding:`${(0,d.Z)(1)} 0`,...null!=S?S:{}},error:null==r?void 0:r.fields,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,v.tZ)(b,{columns:s,onChange:function(e){const t=[...e,p[p.length-1]];Z(t)},fieldOptions:f,organization:w,filterPrimaryOptions:j?_:void 0,source:t})}),(0,v.tZ)(o.Z,{"data-test-id":"y-axis",label:(0,l.t)("Y-Axis"),inline:!1,style:{padding:`${(0,d.Z)(2)} 0 24px 0`,...null!=S?S:{}},flexibleControlStateSize:!0,error:null==r?void 0:r.fields,required:!0,stacked:!0,children:(0,v.tZ)(y,{children:(0,v.tZ)(m.q,{fieldValue:e,fieldOptions:j?f:(0,h.R0)({organization:w}),onChange:e=>function(e){const t=[...p];t[p.length-1]=e,Z(t)}(e),filterPrimaryOptions:j?E:_,filterAggregateParameters:F(e)})},`${e}:0`)})]})}return(0,v.BX)(o.Z,{"data-test-id":"y-axis",label:(0,l.t)("Y-Axis"),inline:!1,style:{padding:`${(0,d.Z)(2)} 0 24px 0`,...null!=S?S:{}},flexibleControlStateSize:!0,error:null==r?void 0:r.fields,required:!0,stacked:!0,children:[p.map(((e,t)=>(0,v.BX)(y,{children:[(0,v.tZ)(m.q,{fieldValue:e,fieldOptions:f,onChange:e=>function(e,t){const s=[...p];s[t]=e,Z(s)}(e,t),filterPrimaryOptions:_,filterAggregateParameters:F(e),otherColumns:p}),(T||"equation"===e.kind)&&(0,v.tZ)(n.ZP,{size:"zero",borderless:!0,onClick:e=>function(e,t){e.preventDefault();const s=[...p];s.splice(t,1),Z(s)}(e,t),icon:(0,v.tZ)(a.Fz,{}),title:(0,l.t)("Remove this Y-Axis"),"aria-label":(0,l.t)("Remove this Y-Axis")})]},`${e}:${t}`))),!C&&(0,v.BX)(x,{children:[(0,v.tZ)(n.ZP,{size:"sm",icon:(0,v.tZ)(a.N_,{isCircled:!0}),onClick:function(e){e.preventDefault();const t=[...p,{kind:g.L.FIELD,field:""}];Z(t)},children:(0,l.t)("Add Overlay")}),!j&&(0,v.tZ)(n.ZP,{size:"sm","aria-label":(0,l.t)("Add an Equation"),onClick:function(e){e.preventDefault();const t=[...p,{kind:g.L.EQUATION,field:""}];Z(t)},icon:(0,v.tZ)(a.N_,{isCircled:!0}),children:(0,l.t)("Add an Equation")})]})]})}f.displayName="WidgetQueryFields";const b=(0,r.Z)(p.Z,{target:"e2l1oc32"})("margin-top:",(0,d.Z)(1),";"),y=(0,r.Z)("div",{target:"e2l1oc31"})("display:flex;align-items:center;justify-content:space-between;margin-bottom:",(0,d.Z)(1),";>*+*{margin-left:",(0,d.Z)(1),";}"),x=(0,r.Z)("div",{target:"e2l1oc30"})("grid-column:2/3;& button{margin-right:",(0,d.Z)(1),";}"),w=f},"./app/components/loadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1dnwgq10"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/components/modals/widgetViewerModal/utils.tsx":(e,t,s)=>{let r;function i(e){return e.match(/\/widget\/[0-9]+\/$/)}s.d(t,{R:()=>r,X:()=>i}),function(e){e.SORT="sort",e.QUERY="query",e.LEGEND="legend",e.PAGE="page",e.CURSOR="cursor",e.WIDTH="width",e.START="viewerStart",e.END="viewerEnd"}(r||(r={}))},"./app/utils/dashboards/issueFieldRenderers.tsx":(e,t,s)=>{s.d(t,{N:()=>w,O:()=>T});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),n=s("./app/components/assigneeSelector.tsx"),o=s("./app/components/count.tsx"),a=s("./app/components/links/link.tsx"),l=s("./app/components/organizations/timeRangeSelector/utils.tsx"),d=s("./app/components/tooltip.tsx"),u=s("./app/constants/index.tsx"),c=s("./app/locale.tsx"),p=s("./app/stores/memberListStore.tsx"),m=s("./app/styles/space.tsx"),g=s("./app/utils/discover/eventView.tsx"),h=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),v=s("./app/utils/discover/styles.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const b={issue:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;const r=e["issue.id"];if(!r)return(0,f.tZ)(v.W2,{children:(0,f.tZ)(v.PV,{shortId:`${e.issue}`})});const i={pathname:`/organizations/${s.slug}/issues/${r}/`};return(0,f.tZ)(v.W2,{children:(0,f.tZ)(v.Jo,{to:i,"aria-label":r,children:(0,f.tZ)(v.PV,{shortId:`${e.issue}`})})})}},assignee:{sortField:null,renderFunc:e=>{const t=p.Z.getAll();return(0,f.tZ)(F,{children:(0,f.tZ)(n.Z,{id:e.id,memberList:t,noDropdown:!0})})}},lifetimeEvents:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"lifetimeEvents")}},lifetimeUsers:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"lifetimeUsers")}},events:{sortField:"freq",renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"events")}},users:{sortField:"user",renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"users")}},lifetimeCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"lifetimeEvents")}},lifetimeUserCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"lifetimeUsers")}},count:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"events")}},userCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return y(e,s,"users")}},links:{sortField:null,renderFunc:e=>{let{links:t}=e;return(0,f.tZ)(C,{dangerouslySetInnerHTML:{__html:t}})}}},y=(e,t,s)=>{const{start:r,end:n,period:a}=e,p=!!/user/i.exec(s.toLowerCase()),m=e[s],g=e[p?"users":"events"],h=e[p?"lifetimeUsers":"lifetimeEvents"],b=e[p?"filteredUsers":"filteredEvents"],y=x(e,t),w=x(e,t,!0),Z=r&&n?"time range":(0,l.TI)(a||u.GY).toLowerCase();return(0,f.tZ)(v.W2,{children:(0,f.tZ)(d.Z,{isHoverable:!0,skipWrapper:!0,overlayStyle:{padding:0},title:(0,f.BX)("div",{children:[b?(0,f.BX)(i.Fragment,{children:[(0,f.BX)(j,{to:w,children:[(0,c.t)("Matching search filters"),(0,f.tZ)(_,{value:b})]}),(0,f.tZ)(E,{})]}):null,(0,f.BX)(j,{to:y,children:[(0,c.t)(`Total in ${Z}`),(0,f.tZ)(_,{value:g})]}),(0,f.tZ)(E,{}),(0,f.BX)(S,{children:[(0,c.t)("Since issue began"),(0,f.tZ)(_,{value:h})]})]}),children:(0,f.tZ)("span",{children:["events","users"].includes(s)&&b?(0,f.BX)(i.Fragment,{children:[(0,f.tZ)(o.Z,{value:b}),(0,f.tZ)(O,{value:m})]}):(0,f.tZ)(o.Z,{value:m})})})})};y.displayName="issuesCountRenderer";const x=(e,t,s)=>{const r={projects:[Number(e.projectId)]};return g.ZP.fromSavedQuery({...r,id:void 0,start:e.start,end:e.end,range:e.period,name:e.title,fields:["title","release","environment","user","timestamp"],orderby:"-timestamp",query:`issue.id:${e.id}${s?e.discoverSearchQuery:""}`,version:2}).getResultsViewUrlTarget(t.slug)};function w(e){if(b.hasOwnProperty(e))return b[e].sortField;switch(e){case h.Sh.LAST_SEEN:return"date";case h.Sh.FIRST_SEEN:return"new";default:return null}}const Z={name:"s5gdgx",styles:"width:100%;justify-content:space-between;display:flex;padding:6px 10px"},S=(0,r.Z)("div",{target:"e1va53iy6"})(Z,";"),j=(0,r.Z)(a.Z,{target:"e1va53iy5"})(Z,";color:",(e=>e.theme.gray400),";&:hover{color:",(e=>e.theme.gray400),";background:",(e=>e.theme.hover),";}"),O=(0,r.Z)(o.Z,{target:"e1va53iy4"})(":before{content:'/';padding-left:",(0,m.Z)(.25),";padding-right:2px;}"),_=(0,r.Z)((e=>{let{value:t,...s}=e;return(0,f.tZ)("div",{...s,children:(0,f.tZ)(o.Z,{value:t})})}),{target:"e1va53iy3"})("text-align:right;font-weight:bold;font-variant-numeric:tabular-nums;padding-left:",(0,m.Z)(2),";color:",(e=>e.theme.subText),";"),E=(0,r.Z)("div",{target:"e1va53iy2"})("height:1px;overflow:hidden;background-color:",(e=>e.theme.innerBorder),";"),F=(0,r.Z)("div",{target:"e1va53iy1"})({name:"1sl6pdq",styles:"display:flex;justify-content:left;margin-left:18px;height:24px;:hover{cursor:default;}"}),C=(0,r.Z)("span",{target:"e1va53iy0"})({name:"1bmnxg7",styles:"white-space:nowrap"});function T(e){return b.hasOwnProperty(e)?b[e].renderFunc:null}},"./app/utils/getPeriod.tsx":(e,t,s)=>{s.d(t,{X:()=>a}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/moment/moment.js"),i=s.n(r),n=s("./app/constants/index.tsx"),o=s("./app/utils/dates.tsx");function a(e){let{period:t,start:s,end:r}=e,{shouldDoublePeriod:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||s||r||(t=n.GY),t){if(!a)return{statsPeriod:t};const[,e,s]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${s}`}}if(!s||!r)throw new Error("start and end required");const l=(0,o.v5)(s),d=(0,o.v5)(r);if(a){const e=i()(r).diff(i()(s)),t=i()(s).subtract(e);return{start:(0,o.v5)(t),end:d}}return{start:l,end:d}}},"./app/views/dashboardsV2/datasetConfig/base.tsx":(e,t,s)=>{s.d(t,{N:()=>p,v:()=>c}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/trimStart.js"),i=s.n(r),n=s("./app/utils/discover/fields.tsx"),o=s("./app/views/dashboardsV2/types.tsx"),a=s("./app/views/dashboardsV2/utils.tsx"),l=s("./app/views/dashboardsV2/datasetConfig/errorsAndTransactions.tsx"),d=s("./app/views/dashboardsV2/datasetConfig/issues.tsx"),u=s("./app/views/dashboardsV2/datasetConfig/releases.tsx");function c(e){switch(e){case o.l9.ISSUE:return d.f;case o.l9.RELEASE:return u.u$;case o.l9.DISCOVER:default:return l.g}}function p(e,t){const s=i()(e.orderby,"-"),r=e.orderby.startsWith("-")?"-":"";if(!t.includes(s)&&""!==e.orderby){var o;const i=e.aggregates.includes(s),l=(0,n.GO)(s),d=e.columns.includes(s),u=i||l||d,c=(0,n.GO)(null!==(o=e.aggregates[0])&&void 0!==o?o:"")?`equation[${(0,a.yd)(e.aggregates)-1}]`:t[0];e.orderby=u&&e.orderby||`${r}${c}`}return e}},"./app/views/dashboardsV2/datasetConfig/errorsAndTransactions.tsx":(e,t,s)=>{s.d(t,{g:()=>B}),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/lodash/trimStart.js"),i=s.n(r),n=s("./app/actionCreators/events.tsx"),o=s("./app/components/charts/utils.tsx"),a=s("./app/components/links/link.tsx"),l=s("./app/components/tooltip.tsx"),d=s("./app/locale.tsx"),u=s("./app/utils/discover/fieldRenderers.tsx"),c=s("./app/utils/discover/fields.tsx"),p=s("./app/utils/discover/genericDiscoverQuery.tsx"),m=s("./app/utils/discover/styles.tsx"),g=s("./app/utils/discover/types.tsx"),h=s("./app/utils/discover/urls.tsx"),v=s("./app/utils/events.tsx"),f=s("./app/utils/measurements/measurements.tsx"),b=s("./app/views/eventsV2/table/types.tsx"),y=s("./app/views/eventsV2/utils.tsx"),x=s("./app/views/performance/traceDetails/utils.tsx"),w=s("./app/views/dashboardsV2/types.tsx"),Z=s("./app/views/dashboardsV2/utils.tsx"),S=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),j=s("./app/components/events/searchBar.tsx"),O=s("./app/constants/index.tsx"),_=s("./app/types/index.tsx"),E=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),F=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function C(e){let{organization:t,pageFilters:s,onClose:r,widgetQuery:i}=e;const n=s.projects;return(0,F.tZ)(T,{searchSource:"widget_builder",organization:t,projectIds:n,query:i.conditions,fields:[],onClose:r,useFormWrapper:!1,maxQueryLength:O.dI,maxSearchItems:E.yM,maxMenuHeight:E.CD,savedSearchType:_.L4.EVENT})}C.displayName="EventsSearchBar";const T=(0,S.Z)(j.Z,{target:"e1pc9id60"})({name:"1ff36h2",styles:"flex-grow:1"});var R=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/sortByStep/index.tsx"),q=s("./app/views/dashboardsV2/widgetCard/widgetQueries.tsx");const B={defaultWidgetQuery:{name:"",fields:["count()"],columns:[],fieldAliases:[],aggregates:["count()"],conditions:"",orderby:"-count()"},enableEquations:!0,getCustomFieldRenderer:function(e,t,s){const r=!(null!=s&&s.features.includes("discover-frontend-use-events-endpoint"));return"id"===e?A:"trace"===e?L:(0,u.Js)(e,t,r)},SearchBar:C,filterSeriesSortOptions:function(e){return t=>t.value.kind===b.L.FUNCTION||t.value.kind===b.L.EQUATION||e.has(t.value.meta.name)||t.value.meta.name===R.E},filterYAxisAggregateParams:function(e,t){return s=>{if(t===w.FO.BIG_NUMBER)return!0;if(e.kind!==b.L.FUNCTION)return!0;const r=e.function[0],i=(0,c.Xh)(r,s.value.meta.name);return i?(0,c.HW)(i):s.value.kind!==b.L.FUNCTION&&s.value.kind!==b.L.EQUATION&&(0,c.HW)(s.value.meta.dataType)}},filterYAxisOptions:function(e){return t=>{if(e!==w.FO.BIG_NUMBER&&t.value.kind===b.L.FUNCTION){const e=(0,c.Xh)(t.value.meta.name,void 0);if(e)return(0,c.HW)(e)}return t.value.kind===b.L.FUNCTION}},getTableFieldOptions:D,getTimeseriesSortOptions:function(e,t,s){const r={};r[`field:${R.E}`]={label:"Custom Equation",value:{kind:b.L.EQUATION,meta:{name:R.E}}};let i=0;[...t.aggregates,...t.columns].filter((e=>!!e)).forEach((e=>{let t;const s=(0,c.bQ)(e);var n;(0,c.GO)(e)&&(t=`equation[${i}]`,i+=1,r[`equation:${t}`]={label:s,value:{kind:b.L.EQUATION,meta:{name:null!==(n=t)&&void 0!==n?n:e}}})}));const n=D(e,s);return{...r,...n}},getTableSortOptions:function(e,t){const{columns:s,aggregates:r}=t,i=[];let n=0;return[...r,...s].filter((e=>!!e)).forEach((e=>{var t;let s;const r=(0,c.bQ)(e);(0,c.GO)(e)&&(s=`equation[${n}]`,n+=1),i.push({label:r,value:null!==(t=s)&&void 0!==t?t:e})})),i},getGroupByFieldOptions:D,handleOrderByReset:s("./app/views/dashboardsV2/datasetConfig/base.tsx").N,supportedDisplayTypes:[w.FO.AREA,w.FO.BAR,w.FO.BIG_NUMBER,w.FO.LINE,w.FO.TABLE,w.FO.TOP_N,w.FO.WORLD_MAP],getTableRequest:(e,t,s,r,i,n,o)=>N(s.features.includes("discover-frontend-use-events-endpoint")?`/organizations/${s.slug}/events/`:`/organizations/${s.slug}/eventsv2/`,e,t,s,r,i,n,o),getSeriesRequest:function(e,t,s,r,o,a){const l=t.queries[s],{displayType:d,limit:u}=t,{environments:p,projects:m}=o,{start:h,end:v,period:f}=o.datetime,b=(0,Z.s)(d,{start:h,end:v,period:f}),y=r.features.includes("dashboards-mep");let x;var S;if(d===w.FO.TOP_N)x={organization:r,interval:b,start:h,end:v,project:m,environment:p,period:f,query:l.conditions,yAxis:l.aggregates[l.aggregates.length-1],includePrevious:!1,referrer:a,partial:!0,field:[...l.columns,...l.aggregates],queryExtras:(0,Z.Gl)(y),includeAllArgs:!0,topEvents:g.hY},l.orderby&&(x.orderby=l.orderby);else if(x={organization:r,interval:b,start:h,end:v,project:m,environment:p,period:f,query:l.conditions,yAxis:l.aggregates,orderby:l.orderby,includePrevious:!1,referrer:a,partial:!0,queryExtras:(0,Z.Gl)(y),includeAllArgs:!0},0!==(null===(S=l.columns)||void 0===S?void 0:S.length)){x.topEvents=null!=u?u:g.hY,x.field=[...l.columns,...l.aggregates];const e=i()(l.orderby,"-");if(!l.orderby||(0,c.uI)(e)||x.field.includes(e)||x.field.push(e),x.excludeOther=1!==l.aggregates.length||1!==t.queries.length,(0,c.GO)(i()(l.orderby,"-"))){const e=(0,Z.yd)(l.aggregates),t=l.orderby.startsWith("-")?"-":"";x.orderby=`${t}equation[${e}]`,x.field=[...l.columns,...l.aggregates,i()(l.orderby,"-")]}}return(0,n.lI)(e,x)},getWorldMapRequest:(e,t,s,r,i,n,o)=>N(`/organizations/${s.slug}/events-geo/`,e,t,s,r,i,n,o),transformSeries:function(e,t,s){let r=[];const i=t.name,n=s.features.includes("new-widget-builder-experience-design")||!1;if((0,o.Xe)(e)){let s=[];const o=t.aggregates.length>1&&t.columns.length;s=n&&o?(0,q.vD)(e,i):Object.keys(e).map((t=>{const s=i?`${i} : ${t}`:t,r=e[t];return[r.order||0,(0,q.FN)(r,s,t)]})),r=[...s.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]))]}else{const s=t.aggregates[0],n=i?`${i} : ${s}`:s,o=(0,q.FN)(e,n,s);r.push(o)}return r},transformTable:function(e,t,s){let r=e;if(s.features.includes("discover-frontend-use-events-endpoint")){var i;const{fields:t,...s}=null!==(i=e.meta)&&void 0!==i?i:{};r={...e,meta:{...t,...s}}}return r},filterTableOptions:function(e){return e.value.kind!==b.L.CUSTOM_MEASUREMENT},filterAggregateParams:function(e,t){return!(e.value.kind===b.L.CUSTOM_MEASUREMENT&&"function"===(null==t?void 0:t.kind)&&null!=t&&t.function&&!e.value.meta.functions.includes(t.function[0]))},getSeriesResultType:function(e,t){var s;const r=t.aggregates[0];var i;return(0,o.Xe)(e)?null===(i=e[Object.keys(e)[0]].meta)||void 0===i?void 0:i.fields[(0,c.LY)(r)]:null===(s=e.meta)||void 0===s?void 0:s.fields[(0,c.LY)(r)]}};function D(e,t,s){const r=(0,f.i)();return(0,y.R0)({organization:e,tagKeys:Object.values(null!=t?t:{}).map((e=>{let{key:t}=e;return t})),measurementKeys:Object.values(r).map((e=>{let{key:t}=e;return t})),spanOperationBreakdownKeys:c.$4,customMeasurements:e.features.includes("dashboards-mep")||e.features.includes("mep-rollout-flag")?Object.values(null!=s?s:{}).map((e=>{let{key:t,functions:s}=e;return{key:t,functions:s}})):void 0})}function A(e,t){let{eventView:s,organization:r}=t;const i=null==e?void 0:e.id;if(!s||"string"!=typeof i)return null;const n=(0,h.JE)(e),o=(0,h.eQ)({orgSlug:r.slug,eventSlug:n,eventView:s});return(0,F.tZ)(l.Z,{title:(0,d.t)("View Event"),children:(0,F.tZ)(a.Z,{"data-test-id":"view-event",to:o,children:(0,F.tZ)(m.W2,{children:(0,v.XQ)(i)})})})}function L(e,t){let{eventView:s,organization:r,location:i}=t;const n=null==e?void 0:e.trace;if(!s||"string"!=typeof n)return null;const o=s.normalizeDateSelection(i),u=(0,x.YA)(r,String(e.trace),o,{});return(0,F.tZ)(l.Z,{title:(0,d.t)("View Trace"),children:(0,F.tZ)(a.Z,{"data-test-id":"view-trace",to:u,children:(0,F.tZ)(m.W2,{children:(0,v.XQ)(n)})})})}function N(e,t,s,r,i,n,o,a){const l=r.features.includes("dashboards-mep"),d=(0,Z.tT)("",s,i),u={per_page:n,cursor:o,referrer:a,...(0,Z.Gl)(l)};return s.orderby&&(u.sort="string"==typeof s.orderby?[s.orderby]:s.orderby),(0,p.AA)(t,e,{...d.generateQueryStringObject(),...u})}A.displayName="renderEventIdAsLinkable",L.displayName="renderTraceAsLinkable"},"./app/views/dashboardsV2/datasetConfig/issues.tsx":(e,t,s)=>{s.d(t,{f:()=>v}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("./app/components/searchSyntax/parser.tsx"),i=s("./app/locale.tsx"),n=s("./app/stores/groupStore.tsx"),o=s("./app/utils/dashboards/issueFieldRenderers.tsx"),a=s("./app/utils/dates.tsx"),l=s("./app/views/issueList/utils.tsx"),d=s("./app/views/dashboardsV2/types.tsx"),u=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/issuesSearchBar.tsx"),c=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),p=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/utils.tsx");const m={name:"",fields:["issue","assignee","title"],columns:["issue","assignee","title"],fieldAliases:[],aggregates:[],conditions:"",orderby:l.qh.DATE},g=l.qh.DATE,h=["owners"],v={defaultWidgetQuery:m,enableEquations:!1,disableSortOptions:function(e){return{disableSort:!1,disableSortDirection:!0,disableSortReason:(0,i.t)("Issues dataset does not yet support descending order")}},getTableRequest:function(e,t,s,r,i,n){var o,l;const u=`/organizations/${s.slug}/issues/`,c={project:null!==(o=r.projects)&&void 0!==o?o:[],environment:null!==(l=r.environments)&&void 0!==l?l:[],query:t.conditions,sort:t.orderby||g,expand:h,limit:null!=i?i:d.$V,cursor:n};return r.datetime.period&&(c.statsPeriod=r.datetime.period),r.datetime.end&&(c.end=(0,a.v5)(r.datetime.end)),r.datetime.start&&(c.start=(0,a.v5)(r.datetime.start)),r.datetime.utc&&(c.utc=r.datetime.utc),e.requestPromise(u,{includeAllArgs:!0,method:"GET",data:{...c}})},getCustomFieldRenderer:o.O,SearchBar:u.i,getTableSortOptions:function(e,t){const s=[...p.St];return e.features.includes("issue-list-trend-sort")&&s.push(l.qh.TREND),s.map((e=>({label:(0,l._k)(e),value:e})))},getTableFieldOptions:e=>(0,p.SF)(),fieldHeaderMap:c.kh,supportedDisplayTypes:[d.FO.TABLE],transformTable:function(e,t,s,i){n.Z.add(e);const o=[];return e.forEach((e=>{let{id:s,shortId:n,title:d,lifetime:u,filtered:c,count:p,userCount:m,project:g,annotations:h,...v}=e;const f={};Object.keys(v).filter((e=>["number","string"].includes(typeof v[e]))).forEach((e=>{f[e]=v[e]}));const b={...f,events:p,users:m,id:s,"issue.id":s,issue:n,title:d,project:g.slug,links:null==h?void 0:h.join(", ")};u&&(b.lifetimeEvents=null==u?void 0:u.count,b.lifetimeUsers=null==u?void 0:u.userCount),c&&(b.filteredEvents=null==c?void 0:c.count,b.filteredUsers=null==c?void 0:c.userCount);const y=t.conditions,x=(0,r.UG)(y),w=null==x?void 0:x.filter((e=>!(e.type===r.WU.Filter&&l.QL.includes(e.key.text))));b.discoverSearchQuery=(0,r.D3)(w,!0),b.projectId=g.id;const{period:Z,start:S,end:j}=i.datetime||{};S&&j&&(b.start=(0,a.v5)(S),b.end=(0,a.v5)(j)),b.period=null!=Z?Z:"",o.push(b)})),{data:o}}}},"./app/views/dashboardsV2/datasetConfig/releases.tsx":(e,t,s)=>{s.d(t,{u$:()=>C}),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/lodash/omit.js"),i=s.n(r),n=s("../node_modules/lodash/trimStart.js"),o=s.n(n),a=s("./app/components/charts/utils.tsx"),l=s("./app/components/organizations/pageFilters/parse.tsx"),d=s("./app/utils.tsx");const u=(e,t)=>{let{field:s,orgSlug:r,cursor:i,environment:n,groupBy:o,includeSeries:u,includeTotals:c,interval:p,limit:m,orderBy:g,project:h,query:v,includeAllArgs:f=!1,statsPeriodStart:b,statsPeriodEnd:y,...x}=t;const{start:w,end:Z,statsPeriod:S}=(0,l.fK)(x,{allowEmptyPeriod:!0}),j=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:i,end:Z,environment:n,groupBy:null==o?void 0:o.filter((e=>!!e)),includeSeries:u,includeTotals:c,interval:p||(0,a.ZS)({start:w,end:Z,period:S}),query:v||void 0,per_page:m,project:h,orderBy:g,start:w,statsPeriod:S,statsPeriodStart:b,statsPeriodEnd:y}).filter((e=>{let[,t]=e;return(0,d.ri)(t)&&""!==t}))),O=`/organizations/${r}/metrics/data/`;return e.requestPromise(O,{includeAllArgs:f,query:j})},c=(e,t)=>{let{field:s,orgSlug:r,cursor:i,environment:n,groupBy:o,interval:u,project:c,orderBy:p,query:m,includeAllArgs:g=!1,statsPeriodStart:h,statsPeriodEnd:v,limit:f,...b}=t;const{start:y,end:x,statsPeriod:w}=(0,l.fK)(b,{allowEmptyPeriod:!0}),Z=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:i,end:x,environment:n,groupBy:null==o?void 0:o.filter((e=>!!e)),interval:u||(0,a.ZS)({start:y,end:x,period:w}),orderBy:p,per_page:f,query:m||void 0,project:c,start:y,statsPeriod:w,statsPeriodStart:h,statsPeriodEnd:v}).filter((e=>{let[,t]=e;return(0,d.ri)(t)&&""!==t})));return e.requestPromise(`/organizations/${r}/sessions/`,{includeAllArgs:g,query:Z})};var p=s("./app/locale.tsx"),m=s("./app/types/index.tsx"),g=s("./app/utils/dates.tsx"),h=s("./app/utils/discover/fieldRenderers.tsx"),v=s("./app/views/eventsV2/table/types.tsx"),f=s("./app/views/dashboardsV2/types.tsx"),b=s("./app/views/dashboardsV2/utils.tsx"),y=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/releaseSearchBar.tsx"),x=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),w=s("./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx");function Z(e,t,s){const r=Object.entries(t.by).map((e=>{let[t,s]=e;return`${s}`})).join(", ");return`${s?`${s} > `:""}${r?`${r} : ${(0,w.nD)(e)}`:(0,w.nD)(e)}`}var S=s("./app/utils/discover/fields.tsx");function j(e){const t={};for(const[s,r]of Object.entries(e))t[(0,w.nD)(s)]=r;return t}function O(e,t,s){const r={};return s.length?(void 0===e["session.status"]||s.forEach((s=>{const i=s.match(x.$4);i&&(e["session.status"]===i[1]?"session"===i[2]?r[s]=t["sum(session)"]:"user"===i[2]&&(r[s]=t["count_unique(user)"]):r[s]=0)})),r):r}var _=s("./app/views/dashboardsV2/datasetConfig/base.tsx");const E={name:"",fields:[`crash_free_rate(${m.r2.SESSION})`],columns:[],fieldAliases:[],aggregates:[`crash_free_rate(${m.r2.SESSION})`],conditions:"",orderby:`-crash_free_rate(${m.r2.SESSION})`},F=new Date("2022-07-12"),C={defaultWidgetQuery:E,enableEquations:!1,disableSortOptions:function(e){const{columns:t}=e;return t.includes("session.status")?{disableSort:!0,disableSortDirection:!0,disableSortReason:(0,p.t)("Sorting currently not supported with session.status")}:{disableSort:!1,disableSortDirection:!1}},getTableRequest:(e,t,s,r,i,n)=>B(0,1,e,t,s,r,void 0,i,n),getSeriesRequest:function(e,t,s,r,i){const n=t.queries[s],{displayType:o,limit:a}=t,{datetime:l}=i,{start:d,end:u,period:c}=l,p=(0,w.Vl)(n);return B(1,n.columns.length>0?1:0,e,n,r,i,(0,b.s)(o,{start:d,end:u,period:c},"5m",p?"low":void 0),a)},getTableSortOptions:function(e,t){const{columns:s,aggregates:r}=t,i=[];return[...r,...s].filter((e=>!!e)).filter((e=>!x.d2.includes(e))).filter((e=>!x.aE.includes(e))).forEach((e=>{i.push({label:e,value:e})})),i},getTimeseriesSortOptions:function(e,t){const s=new Set(t.columns),r=(0,x.e1)(Object.values(x.Jo),x.ve),i={};return Object.entries(r).forEach((e=>{let[t,r]=e;["count_healthy","count_errored"].includes(r.value.meta.name)||(r.value.kind!==v.L.FIELD||"release"===r.value.meta.name&&s.has(r.value.meta.name))&&(i[t]=r)})),i},filterTableOptions:T,filterAggregateParams:R,filterYAxisAggregateParams:(e,t)=>R,filterYAxisOptions:function(e){return e=>[v.L.FUNCTION,v.L.NUMERIC_METRICS].includes(e.value.kind)},getCustomFieldRenderer:(e,t)=>(0,h.Js)(e,t,!1),SearchBar:y.D,getTableFieldOptions:function(e){return(0,x.e1)(Object.values(x.Jo),x.ve)},getGroupByFieldOptions:e=>(0,x.e1)([],x.ve),handleColumnFieldChangeOverride:function(e){if(0===e.aggregates.length){const t=`crash_free_rate(${m.r2.SESSION})`;e.aggregates=[t],e.fields=e.fields?[...e.fields,t]:[t]}return e},handleOrderByReset:function(e,t){return e.columns.includes("session.status")&&(e.orderby=""),(0,_.N)(e,t)},filterSeriesSortOptions:function(e){return t=>!["count_healthy","count_errored"].includes(t.value.meta.name)&&(t.value.kind===v.L.FIELD?e.has(t.value.meta.name)&&"release"===t.value.meta.name:T(t))},supportedDisplayTypes:[f.FO.AREA,f.FO.BAR,f.FO.BIG_NUMBER,f.FO.LINE,f.FO.TABLE,f.FO.TOP_N],transformSeries:function(e,t){if(null===e)return[];const s=t.name,r=t.columns.includes("session.status"),{derivedStatusFields:i,injectedFields:n}=(0,w.gp)(t.aggregates,t.orderby,r),o=[];return e.groups.length?(e.groups.forEach((t=>{Object.keys(t.series).forEach((r=>{n.includes((0,w.nD)(r))||o.push({seriesName:Z(r,t,s),data:e.intervals.map(((e,s)=>{var i;return{name:e,value:null!==(i=t.series[r][s])&&void 0!==i?i:0}}))})})),i.length&&(0,d.ri)(t.by["session.status"])&&i.forEach((r=>{const i=r.match(x.$4);if(i){let n;t.by["session.status"]===i[1]&&("session"===i[2]?n="sum(session)":"user"===i[2]&&(n="count_unique(user)")),o.push({seriesName:Z(r,t,s),data:e.intervals.map(((e,s)=>{var r;return{name:e,value:n&&null!==(r=t.series[n][s])&&void 0!==r?r:0}}))})}}))})),o):[{seriesName:`(${(0,p.t)("no results")})`,data:e.intervals.map((e=>({name:e,value:0})))}]},transformTable:function(e,t){const s=t.columns.includes("session.status"),{derivedStatusFields:r,injectedFields:n}=(0,w.gp)(t.aggregates,t.orderby,s),o=e.groups.map(((e,t)=>({id:String(t),...j(e.by),...i()(j(e.totals),n),...O(e.by,e.totals,r)}))),a=o[0];return{meta:{...(l=i()(a,"id"),Object.keys(null!=l?l:{}).reduce(((e,t)=>(e[t]=x.ve.includes(t)?"string":(0,S.Px)(t),e)),{}))},data:o};var l}};function T(e){return[v.L.FUNCTION,v.L.FIELD,v.L.NUMERIC_METRICS].includes(e.value.kind)}function R(e){return e.value.kind===v.L.METRICS}function q(e){var t;return null!==(t=x.wg[e])&&void 0!==t?t:e}function B(e,t,s,r,i,n,a,l,d){const{environments:m,projects:h,datetime:v}=n,{start:f,end:b,period:y}=v;let Z=!1;if(f){let e;e="string"==typeof f?new Date(f):f,Z=e<F}else if(y){const e=(0,g.Ri)(y),t=new Date;Z=new Date((new Date).setDate(t.getDate()-e))<F}if(Z)return Promise.reject(new Error((0,p.t)("Releases data is only available from Jul 12. Please retry your query with a more recent date range.")));const S=r.columns.includes("session.status"),j=(0,w.Vl)(r),O=r.orderby.startsWith("-"),_=o()(r.orderby,"-"),E=x.d2.includes(_)||S||"release"===_,C=r.columns,{aggregates:T,injectedFields:R}=(0,w.gp)(r.aggregates,r.orderby,S);let B,D;return S?(B={field:T.filter((e=>!Object.values(x.Xg).includes(e))),orgSlug:i.slug,end:b,environment:m,groupBy:C,limit:void 0,orderBy:"",interval:a,project:h,query:r.conditions,start:f,statsPeriod:y,includeAllArgs:!0,cursor:d},D=c):(B={field:T.map(q),orgSlug:i.slug,end:b,environment:m,groupBy:C.map(q),limit:0===C.length?1:j?100:l,orderBy:E?"":O?`-${q(_)}`:q(_),interval:a,project:h,query:r.conditions,start:f,statsPeriod:y,includeAllArgs:!0,cursor:d,includeSeries:e,includeTotals:t},D=u,!_||E||T.includes(_)||C.includes(_)||(B.field=[...B.field,q(_)],R.includes(_)||R.push(_))),D(s,B)}},"./app/views/dashboardsV2/utils.tsx":(e,t,s)=>{s.d(t,{BD:()=>U,Cg:()=>V,DW:()=>L,EK:()=>K,Gl:()=>$,Gx:()=>Q,Lo:()=>H,Mf:()=>k,S$:()=>G,Tk:()=>P,Z5:()=>J,aq:()=>Y,fK:()=>X,hS:()=>M,lM:()=>ee,nk:()=>W,qk:()=>q,s:()=>N,tT:()=>B,y1:()=>A,yd:()=>z,z1:()=>I}),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js");var r=s("../node_modules/react-router/es/index.js"),i=s("../node_modules/lodash/cloneDeep.js"),n=s.n(i),o=s("../node_modules/lodash/isEmpty.js"),a=s.n(o),l=s("../node_modules/lodash/isEqual.js"),d=s.n(l),u=s("../node_modules/lodash/pick.js"),c=s.n(u),p=s("../node_modules/lodash/trimStart.js"),m=s.n(p),g=s("../node_modules/query-string/index.js"),h=s("./images/dashboard/widget-area.svg"),v=s("./images/dashboard/widget-bar.svg"),f=s("./images/dashboard/widget-big-number.svg"),b=s("./images/dashboard/widget-line-1.svg"),y=s("./images/dashboard/widget-table.svg"),x=s("./images/dashboard/widget-world-map.svg"),w=s("./app/components/arithmeticInput/parser.tsx"),Z=s("./app/components/charts/utils.tsx"),S=s("./app/components/organizations/pageFilters/parse.tsx"),j=s("./app/utils.tsx"),O=s("./app/utils/dates.tsx"),_=s("./app/utils/discover/eventView.tsx"),E=s("./app/utils/discover/fields.tsx"),F=s("./app/utils/discover/types.tsx"),C=s("./app/utils/measurements/measurements.tsx"),T=s("./app/utils/queryString.tsx"),R=s("./app/views/dashboardsV2/types.tsx");function q(e){return n()(e)}function B(e,t,s,r){const{start:i,end:n,period:o}=s.datetime,{projects:a,environments:l}=s,d=r!==R.FO.WORLD_MAP||t.columns.includes("geo.country_code")?[...t.columns,...t.aggregates]:["geo.country_code",...t.columns,...t.aggregates],u=r!==R.FO.WORLD_MAP||t.conditions.includes("has:geo.country_code")?t.conditions:`${t.conditions} has:geo.country_code`.trim(),{orderby:c}=t,p=c?`${c.startsWith("-")?"-":""}${(0,E.LY)(m()(c,"-"))}`:c;return _.ZP.fromSavedQuery({id:void 0,name:e,version:2,fields:d,query:u,orderby:p,projects:a,range:null!=o?o:void 0,start:i?(0,O.v5)(i):void 0,end:n?(0,O.v5)(n):void 0,environment:l})}function D(e){return"string"==typeof e?[e]:e}function A(e){if(e){const t=D(e.queryNames),s=D(e.queryConditions),r=D(e.queryFields),i=[];if(s&&t&&r&&"string"==typeof e.queryOrderby){const{columns:n,aggregates:o}=(0,E.n0)(r);s.forEach(((s,a)=>{i.push({name:t[a],conditions:s,fields:r,columns:n,aggregates:o,orderby:e.queryOrderby})}))}if(e.title&&e.displayType&&e.interval&&i.length>0)return{...c()(e,["title","displayType","interval"]),widgetType:R.l9.DISCOVER,queries:i}}}function L(e){switch(e){case R.FO.BAR:return v;case R.FO.AREA:case R.FO.TOP_N:return h;case R.FO.BIG_NUMBER:return f;case R.FO.TABLE:return y;case R.FO.WORLD_MAP:return x;case R.FO.LINE:default:return b}}function N(e,t,s,r){let i="bar"===e?"1d":s;i||(i="5m");const n=(0,O.YJ)(i),o=(0,Z.Nm)(t);if(r)return i=(0,Z.ZS)(t,r),o>Z.aC&&o<=Z.w3&&(i="1h"),"bar"===e?"1d":i;if(o/(60*n)>66){const e=(0,Z.ZS)(t,"high");if(n<(0,O.YJ)(e))return e}return i}function k(e){const t=new Set;return e.filter(E.GO).forEach((e=>{const s=(0,w.W9)((0,E.bQ)(e)).tc;s.fields.forEach((e=>{let{term:s}=e;return t.add(s)})),s.functions.forEach((e=>{let{term:s}=e;return t.add(s)}))})),Array.from(t)}function I(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const n=B(e.title,e.queries[r],t,e.displayType),o=n.getResultsViewUrlTarget(s.slug),a=n.getYAxisOptions().map((e=>{let{value:t}=e;return t}));switch(o.query.yAxis=[...new Set(e.queries[0].aggregates.filter((e=>a.includes(e))))].slice(0,3),e.displayType){case R.FO.WORLD_MAP:o.query.display=F.DC.WORLDMAP;break;case R.FO.BAR:o.query.display=F.DC.BAR;break;case R.FO.TOP_N:o.query.display=F.DC.TOP5;const t=e.queries[0].aggregates;o.query.yAxis=t[t.length-1],t.slice(0,-1).includes(t[t.length-1])&&(o.query.field=t.slice(0,-1))}const l=o.query.field,d=e.queries[0],u=(0,j.ri)(d.fields)?d.fields:[...d.columns,...d.aggregates],c=k(u);c.forEach((e=>{Array.isArray(l)&&!l.includes(e)&&l.unshift(e)})),i&&(o.query.fromMetric="true");const p=`${o.pathname}?${g.stringify({...o.query})}`;return p}function M(e,t,s){var r,i,n,o;const{start:a,end:l,utc:d,period:u}=t.datetime,c=a&&l?{start:(0,O.v5)(a),end:(0,O.v5)(l),utc:d}:{statsPeriod:u};return`/organizations/${s.slug}/issues/?${g.stringify({query:null===(r=e.queries)||void 0===r||null===(i=r[0])||void 0===i?void 0:i.conditions,sort:null===(n=e.queries)||void 0===n||null===(o=n[0])||void 0===o?void 0:o.orderby,...c,project:t.projects,environment:t.environments})}`}function V(e,t,s){const{start:r,end:i,utc:n,period:o}=t.datetime,a=r&&i?{start:(0,O.v5)(r),end:(0,O.v5)(i),utc:n}:{statsPeriod:o};return`/organizations/${s.slug}/releases/?${g.stringify({...a,project:t.projects,environment:t.environments})}`}function P(e,t){return"string"==typeof e?t.error=e:Object.keys(e).forEach((s=>{const r=e[s];"string"!=typeof r?Array.isArray(r)&&"string"==typeof r[0]?t[s]=r[0]:Array.isArray(r)&&"object"==typeof r[0]?r.map((e=>P(e,t))):P(r,t):t[s]=r})),t}function $(e){return e?{dataset:"metricsEnhanced"}:{}}function z(e){return e.filter(E.GO).length}function W(e){const t=Object.keys((0,C.i)());return(0,E.Xr)(e)&&!t.includes(e)}function U(e){return e.widgetType===R.l9.DISCOVER&&e.queries.some((e=>{let{aggregates:t,columns:s,fields:r}=e;return[...t.reduce(((e,t)=>{const s=(0,E.hW)(t);return s&&e.push(s),e}),[]),...s,...null!=r?r:[]].some((e=>W(e)))}))}function Q(e){return e.widgetType===R.l9.DISCOVER&&e.queries.some((e=>{let{aggregates:t,columns:s,fields:r}=e;return[...t.reduce(((e,t)=>{const s=(0,E.hW)(t);return s&&e.push(s),e}),[]),...s,...null!=r?r:[]].some((e=>"transaction"===e))}))}function H(e){return!(a()(e.projects)&&void 0===e.environment&&void 0===e.start&&void 0===e.end&&void 0===e.period)}function G(e,t){var s;const r={projects:new Set(e.projects),environment:new Set(e.environment),period:e.period,start:(0,S.gX)(e.start),end:(0,S.gX)(e.end),utc:e.utc};let i={...K(t)};var n,o;return i={...i,projects:new Set(i.projects),environment:new Set(i.environment)},null!==(s=t.query)&&void 0!==s&&s.release&&(r.release=new Set(null===(n=e.filters)||void 0===n?void 0:n.release),i.release=new Set(null===(o=t.query)||void 0===o?void 0:o.release)),!d()(r,i)}function X(e){return{datetime:{end:e.end||null,period:e.period||null,start:e.start||null,utc:null},environments:e.environment||[],projects:e.projects||[]}}function Y(e){return{project:e.projects,environment:e.environment,statsPeriod:e.period,start:(0,S.gX)(e.start),end:(0,S.gX)(e.end),utc:e.utc}}function J(e,t){r.browserHistory.replace({...t,query:Y(e)})}function K(e){var t;const{project:s,environment:r,statsPeriod:i,start:n,end:o,utc:a}=null!==(t=e.query)&&void 0!==t?t:{};return{projects:null==s?[]:"string"==typeof s?[Number(s)]:s.map(Number),environment:"string"==typeof r?[r]:null!=r?r:void 0,period:i,start:(0,j.ri)(n)?(0,S.gX)(n):void 0,end:(0,j.ri)(o)?(0,S.gX)(o):void 0,utc:(0,j.ri)(a)?"true"===a:void 0}}function ee(e){const t=new Set([R.qA.RELEASE]),s={};return t.forEach((t=>{var r,i;null!==(r=e.query)&&void 0!==r&&r[t]&&(s[t]=(0,T.qP)(null===(i=e.query)||void 0===i?void 0:i[t]))})),a()(s)?null:s}},"./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx":(e,t,s)=>{s.d(t,{F:()=>a});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/list/listItem.tsx"),n=s("./app/styles/space.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{title:t,description:s,required:r=!1,children:i}=e;return(0,o.BX)(l,{children:[(0,o.BX)(d,{children:[t,r&&(0,o.tZ)(p,{})]}),(0,o.tZ)(u,{children:s}),(0,o.tZ)(c,{children:i})]})}a.displayName="BuildStep";const l=(0,r.Z)(i.Z,{target:"ecpormx4"})({name:"vetbs0",styles:"display:grid"}),d=(0,r.Z)("h5",{target:"ecpormx3"})("margin-bottom:0;color:",(e=>e.theme.gray500),";"),u=(0,r.Z)("small",{target:"ecpormx2"})("color:",(e=>e.theme.gray300),";padding:",(0,n.Z)(.25)," ",(0,n.Z)(2)," ",(0,n.Z)(2)," 0;@media (max-width: ",(e=>e.theme.breakpoints.small),"){padding-top:",(0,n.Z)(1),";margin-left:-",(0,n.Z)(4),";}"),c=(0,r.Z)("div",{target:"ecpormx1"})("display:grid;@media (max-width: ",(e=>e.theme.breakpoints.small),"){margin-left:-",(0,n.Z)(4),";}"),p=(0,r.Z)("div",{target:"ecpormx0"})("background:",(e=>e.theme.red300),";opacity:0.6;width:5px;height:5px;border-radius:5px;margin-left:",(0,n.Z)(.5),";display:inline-block;vertical-align:super;")},"./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/issuesSearchBar.tsx":(e,t,s)=>{s.d(t,{i:()=>h});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),n=s("./app/actionCreators/tags.tsx"),o=s("./app/locale.tsx"),a=s("./app/types/index.tsx"),l=s("./app/utils/dates.tsx"),d=s("./app/utils/useApi.tsx"),u=s("./app/utils/withIssueTags.tsx"),c=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),p=s("./app/views/issueList/searchBar.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e){let{tags:t,onClose:s,widgetQuery:r,organization:u,pageFilters:p}=e;const g=(0,d.Z)();function h(e,t){const s=u.slug,r=p.projects.map((e=>e.toString())),i={start:(0,l.v5)(p.datetime.start),end:(0,l.v5)(p.datetime.end),statsPeriod:p.datetime.period};return(0,n.Fo)(g,s,e,t,r,i)}return(0,m.tZ)(i.ms,{children:e=>{let{css:i}=e;return(0,m.tZ)(v,{searchSource:"widget_builder",query:r.conditions||"",sort:"",onClose:s,excludeEnvironment:!0,supportedTags:t,placeholder:(0,o.t)("Search for issues, status, assigned, and more"),tagValueLoader:h,onSidebarToggle:()=>{},maxSearchItems:c.yM,savedSearchType:a.L4.ISSUE,dropdownClassName:i`
            max-height: ${c.CD}px;
            overflow-y: auto;
          `})}})}g.displayName="IssuesSearchBarContainer";const h=(0,u.Z)(g),v=(0,r.Z)(p.Z,{target:"ewve4jj0"})({name:"1hoyb5r",styles:"flex-grow:1;button:not([aria-label='Clear search']){display:none;}"})},"./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/releaseSearchBar.tsx":(e,t,s)=>{s.d(t,{D:()=>f});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),n=s("../node_modules/lodash/memoize.js"),o=s.n(n),a=s("./app/actionCreators/tags.tsx"),l=s("./app/components/smartSearchBar/index.tsx"),d=s("./app/constants/index.tsx"),u=s("./app/locale.tsx"),c=s("./app/types/index.tsx"),p=s("./app/utils/useApi.tsx"),m=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),g=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v=new RegExp(`^${d.c$}|\\${d.ir}`,"g");function f(e){let{organization:t,pageFilters:s,widgetQuery:r,onClose:n}=e;const l=t.slug,f=s.projects,y=(0,p.Z)();function x(e){return e.replace(v,"")}function w(e,t){if("session.status"===e.name)return Promise.resolve(g._I);const s=null==f?void 0:f.map(String);return(0,a.Fo)(y,l,e.key,t,s,void 0,!0).then((e=>e.map((e=>{let{value:t}=e;return t}))),(()=>{throw new Error("Unable to fetch tag values")}))}const Z=Object.values(g.Wt).reduce(((e,t)=>(e[t]={key:t,name:t},e)),{});return(0,h.tZ)(i.ms,{children:e=>{let{css:t}=e;return(0,h.tZ)(b,{onGetTagValues:o()(w,((e,t)=>{let{key:s}=e;return`${s}-${t}`})),supportedTags:Z,placeholder:(0,u.t)("Search for release version, session status, and more"),prepareQuery:x,dropdownClassName:t`
            max-height: ${null!==m.CD&&void 0!==m.CD?m.CD:300}px;
            overflow-y: auto;
          `,onClose:n,maxQueryLength:d.dI,maxSearchItems:m.yM,searchSource:"widget_builder",query:r.conditions,savedSearchType:c.L4.SESSION,hasRecentSearches:!0})}})}f.displayName="ReleaseSearchBar";const b=(0,r.Z)(l.Z,{target:"ei7lnmi0"})({name:"1ff36h2",styles:"flex-grow:1"})},"./app/views/dashboardsV2/widgetBuilder/buildSteps/sortByStep/index.tsx":(e,t,s)=>{s.d(t,{E:()=>_,j:()=>E});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/trimStart.js"),o=s.n(n),a=s("./app/components/forms/field/index.tsx"),l=s("./app/components/forms/selectControl.tsx"),d=s("./app/components/tooltip.tsx"),u=s("./app/locale.tsx"),c=s("./app/styles/space.tsx"),p=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),m=s("./app/views/dashboardsV2/types.tsx"),g=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),h=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx"),v=s("../node_modules/lodash/uniqBy.js"),f=s.n(v),b=s("./app/utils/discover/fields.tsx"),y=s("./app/utils/useOrganization.tsx"),x=s("./app/views/eventsV2/table/arithmeticInput.tsx"),w=s("./app/views/eventsV2/table/queryField.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function S(e){let{values:t,widgetType:s,onChange:r,disableSortReason:n,disableSort:a,disableSortDirection:c,widgetQuery:h,displayType:v}=e;const S=(0,p.v)(s),E=(0,y.Z)(),F=new Set(h.columns),[C,T]=(0,i.useState)(!1),[R,q]=(0,i.useState)({sortBy:`${b.qe}`,sortDirection:t.sortDirection});return(0,i.useEffect)((()=>{const e=(0,b.GO)(o()(t.sortBy,"-"));e&&q({sortBy:o()(t.sortBy,"-"),sortDirection:t.sortDirection}),T(e)}),[t.sortBy,t.sortDirection]),(0,Z.BX)(j,{children:[(0,Z.tZ)(d.Z,{title:n,disabled:!c||c&&a,children:(0,Z.tZ)(l.Z,{name:"sortDirection","aria-label":"Sort direction",menuPlacement:"auto",disabled:c,options:Object.keys(g.Qj).map((e=>({label:g.Qj[e],value:e}))),value:t.sortDirection,onChange:e=>{r({sortBy:t.sortBy,sortDirection:e.value})}})}),(0,Z.tZ)(d.Z,{title:n,disabled:!a||c&&a,children:v===m.FO.TABLE?(0,Z.tZ)(l.Z,{name:"sortBy","aria-label":"Sort by",menuPlacement:"auto",disabled:a,placeholder:`${(0,u.t)("Select a column")}…`,value:t.sortBy,options:f()(S.getTableSortOptions(E,h),(e=>{let{value:t}=e;return t})),onChange:e=>{r({sortBy:e.value,sortDirection:t.sortDirection})}}):(0,Z.tZ)(w.q,{disabled:a,fieldValue:C?(0,b.HM)({field:_}):(0,b.HM)({field:t.sortBy}),fieldOptions:S.getTimeseriesSortOptions(E,h),filterPrimaryOptions:S.filterSeriesSortOptions?S.filterSeriesSortOptions(F):void 0,filterAggregateParameters:S.filterAggregateParams,onChange:e=>{if(e.alias&&(0,b.uI)(e.alias))return void r({sortBy:e.alias,sortDirection:t.sortDirection});const s=(0,b.sN)(e),i=(0,b.GO)(s);T(i),r(i?R:{sortBy:s,sortDirection:t.sortDirection})}})}),C&&(0,Z.tZ)(O,{children:(0,Z.tZ)(x.Z,{name:"arithmetic",type:"text",required:!0,placeholder:(0,u.t)("Enter Equation"),value:(0,b.vp)(R.sortBy),onUpdate:e=>{const s={sortBy:`${b.qe}${e}`,sortDirection:t.sortDirection};r(s),q(s)},hideFieldOptions:!0})})]})}S.displayName="SortBySelectors";const j=(0,r.Z)("div",{target:"e1grfh1l1"})("display:grid;gap:",(0,c.Z)(1),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:200px 1fr;}"),O=(0,r.Z)("div",{target:"e1grfh1l0"})({name:"18iuzk9",styles:"grid-column:1/-1"}),_="custom-equation";function E(e){let{displayType:t,onSortByChange:s,queries:r,widgetType:n,error:l,limit:c,onLimitChange:v,tags:f}=e;const b=(0,p.v)(n);let y,x=!1,w=!1;b.disableSortOptions&&({disableSort:x,disableSortDirection:w,disableSortReason:y}=b.disableSortOptions(r[0]));const j=r[0].orderby,O=o()(j,"-"),_=(0,g.oA)(r.length,r[0].aggregates.length),E=[m.FO.LINE,m.FO.BAR,m.FO.AREA].includes(t);return(0,i.useEffect)((()=>{c&&c>_&&v(_)}),[c,_,v]),(0,Z.tZ)(h.F,{title:t===m.FO.TABLE?(0,u.t)("Sort by a column"):(0,u.t)("Sort by a y-axis"),description:t===m.FO.TABLE?(0,u.t)("Choose one of the columns you've created to sort by."):(0,u.t)("Choose one of the y-axis you've created to sort by."),children:(0,Z.tZ)(d.Z,{title:y,disabled:!(w&&x),children:(0,Z.BX)(a.Z,{inline:!1,error:l,flexibleControlStateSize:!0,stacked:!0,children:[[m.FO.AREA,m.FO.BAR,m.FO.LINE].includes(t)&&c&&(0,Z.tZ)(F,{disabled:w&&x,name:"resultsLimit",menuPlacement:"auto",options:[...Array(_).keys()].map((e=>{const t=e+1;return{label:(0,u.tn)("Limit to %s result","Limit to %s results",t),value:t}})),value:c,onChange:e=>{v(e.value)}}),(0,Z.tZ)(S,{displayType:t,widgetType:n,hasGroupBy:E&&!!r[0].columns.length,disableSortReason:y,disableSort:x,disableSortDirection:w,widgetQuery:r[0],values:{sortDirection:"-"===j[0]?g.Sr.HIGH_TO_LOW:g.Sr.LOW_TO_HIGH,sortBy:O},onChange:e=>{let{sortDirection:t,sortBy:r}=e;const i=t===g.Sr.HIGH_TO_LOW?`-${r}`:r;s(i)},tags:f})]})})})}E.displayName="SortByStep";const F=(0,r.Z)(l.Z,{target:"e14t0x3e0"})("margin-bottom:",(0,c.Z)(1),";")},"./app/views/dashboardsV2/widgetBuilder/issueWidget/utils.tsx":(e,t,s)=>{s.d(t,{SF:()=>o,St:()=>a,Wp:()=>l}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("./app/views/eventsV2/table/types.tsx"),i=s("./app/views/issueList/utils.tsx"),n=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx");function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.$L;const t=Object.keys(e).sort(),s={};return t.forEach((t=>{s[`field:${t}`]={label:t,value:{kind:r.L.FIELD,meta:{name:t,dataType:e[t]}}}})),s}const a=[i.qh.DATE,i.qh.NEW,i.qh.FREQ,i.qh.PRIORITY,i.qh.USER];function l(e){const t=[...a];return e&&t.push(i.qh.TREND),t.map((e=>({label:(0,i._k)(e),value:e})))}},"./app/views/dashboardsV2/widgetBuilder/utils.tsx":(e,t,s)=>{s.d(t,{CD:()=>_,Qj:()=>y,Sr:()=>b,V0:()=>F,Zi:()=>Z,_k:()=>h,eQ:()=>S,hV:()=>x,i0:()=>v,oA:()=>E,qg:()=>f,wc:()=>w,yM:()=>O}),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/web.url-search-params.js");var r=s("../node_modules/lodash/cloneDeep.js"),i=s.n(r),n=s("../node_modules/lodash/isEqual.js"),o=s.n(n),a=s("../node_modules/lodash/trimStart.js"),l=s.n(a),d=s("./app/components/dashboards/widgetQueriesForm.tsx"),u=s("./app/locale.tsx"),c=s("./app/utils/discover/fields.tsx"),p=s("./app/views/dashboardsV2/types.tsx"),m=(s("./app/views/eventsV2/table/types.tsx"),s("./app/views/eventsV2/utils.tsx"),s("./app/views/issueList/utils.tsx")),g=s("./app/views/dashboardsV2/utils.tsx");const h=5,v="new";let f,b;!function(e){e.EVENTS="events",e.ISSUES="issues",e.RELEASES="releases"}(f||(f={})),function(e){e.HIGH_TO_LOW="high_to_low",e.LOW_TO_HIGH="low_to_high"}(b||(b={}));const y={[b.HIGH_TO_LOW]:(0,u.t)("High to low"),[b.LOW_TO_HIGH]:(0,u.t)("Low to high")},x={[p.FO.AREA]:(0,u.t)("Area Chart"),[p.FO.BAR]:(0,u.t)("Bar Chart"),[p.FO.LINE]:(0,u.t)("Line Chart"),[p.FO.TABLE]:(0,u.t)("Table"),[p.FO.WORLD_MAP]:(0,u.t)("World Map"),[p.FO.BIG_NUMBER]:(0,u.t)("Big Number")};function w(e,t){return Object.keys(e).forEach((s=>{const r=e[s];"string"!=typeof r?Array.isArray(r)&&"string"==typeof r[0]?t[s]=r[0]:Array.isArray(r)&&"object"==typeof r[0]?t[s]=r.map((e=>w(e,{}))):t[s]=w(r,{}):t[s]=r})),t}function Z(e){let{displayType:t,queries:s,widgetType:r,widgetBuilderNewDesign:n=!1}=e;const a=F(t),u=[p.FO.TABLE,p.FO.TOP_N].includes(t);if(s=i()(s),[p.FO.TABLE,p.FO.WORLD_MAP,p.FO.BIG_NUMBER].includes(t)?s=s.slice(0,1):a&&(s=s.slice(0,3)),n&&(s=s.map((e=>{const{fields:i=[],columns:o}=e;if(e.fields=u?[...new Set([...i,...o])]:i.filter((e=>!o.includes(e))),F(t)&&!e.columns.filter((e=>!!e)).length)return e.orderby="",e;const a=r===p.l9.RELEASE?(0,c.hr)(s[0].orderby):s[0].orderby,h=l()(a,"-"),v=!(u&&(0,c.GO)(h)||!(0,c.GO)(h)&&!(0,c.uI)(h)&&![...e.columns,...e.aggregates].includes(h)||(0,c.uI)(h)&&(0,c.G5)(h)>(0,g.yd)([...e.columns,...e.aggregates])-1)&&l()(a,"-")||(r===p.l9.ISSUE?m.qh.DATE:(0,d._4)({widgetType:null!=r?r:p.l9.DISCOVER,widgetBuilderNewDesign:n,columns:s[0].columns,aggregates:s[0].aggregates})[0].value),f=!e.orderby||r!==p.l9.ISSUE&&a.startsWith("-");return e.orderby=f?`-${String(v)}`:String(v),e}))),u)return s;if(s=s.map((e=>{let s=e.aggregates;return(a||t===p.FO.WORLD_MAP)&&(s=s.filter((e=>(0,c.HW)((0,c.Px)(e))))),a&&s.length&&s.length>3&&(s=s.slice(0,3)),{...e,fields:s.length?s:["count()"],columns:n&&e.columns?e.columns:[],aggregates:s.length?s:["count()"]}})),a){const e=[...s[0].aggregates];e:for(const t of s){if(e.length>=3)break;if(!o()(e,t.aggregates))for(const s of t.aggregates){if(e.length>=3)break e;e.includes(s)||e.push(s)}}s=s.map((t=>({...t,columns:n&&t.columns?t.columns:[],aggregates:e,fields:e})))}return[p.FO.WORLD_MAP,p.FO.BIG_NUMBER].includes(t)&&(s=s.map((e=>({...e,fields:e.aggregates.slice(0,1),aggregates:e.aggregates.slice(0,1),orderby:"",columns:[]})))),s}function S(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=new URLSearchParams(e),s=Object.fromEntries(t.entries());if(!Object.keys(s).length)return;const r=s.columns?j(s.columns):[],i=s.aggregates?j(s.aggregates):[],n=[...r,...i];return{...s,fields:n,columns:r,aggregates:i}}function j(e){return e.split(/,(?![^(]*\))/g)}const O=5,_=250;function E(e,t){return 0===e||0===t?h:Math.floor(10/(e*t))}function F(e){return[p.FO.LINE,p.FO.AREA,p.FO.BAR].includes(e)}},"./app/views/dashboardsV2/widgetCard/chart.tsx":(e,t,s)=>{s.d(t,{R:()=>D,Z:()=>L});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/omit.js"),u=s.n(d),c=s("./app/components/charts/areaChart.tsx"),p=s("./app/components/charts/barChart.tsx"),m=s("./app/components/charts/chartZoom.tsx"),g=s("./app/components/charts/errorPanel.tsx"),h=s("./app/components/charts/lineChart.tsx"),v=s("./app/components/charts/simpleTableChart.tsx"),f=s("./app/components/charts/transitionChart.tsx"),b=s("./app/components/charts/transparentLoadingMask.tsx"),y=s("./app/components/charts/utils.tsx"),x=s("./app/components/charts/worldMapChart.tsx"),w=s("./app/components/loadingIndicator.tsx"),Z=s("./app/components/placeholder.tsx"),S=s("./app/components/tooltip.tsx"),j=s("./app/icons/index.tsx"),O=s("./app/styles/space.tsx"),_=s("./app/utils/discover/charts.tsx"),E=s("./app/utils/discover/fieldRenderers.tsx"),F=s("./app/utils/discover/fields.tsx"),C=s("./app/utils/getDynamicText.tsx"),T=s("./app/views/dashboardsV2/utils.tsx"),R=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),q=s("./app/views/dashboardsV2/types.tsx"),B=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const D=60;class A extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{containerHeight:0})}shouldComponentUpdate(e,t){var s,r;if(this.props.widget.displayType===q.FO.BIG_NUMBER&&e.widget.displayType===q.FO.BIG_NUMBER&&(this.props.windowWidth!==e.windowWidth||!l()(null===(s=this.props.widget)||void 0===s?void 0:s.layout,null===(r=e.widget)||void 0===r?void 0:r.layout)))return!0;const i={...u()(this.props,["windowWidth"]),widget:{...this.props.widget,title:""}};return e={...u()(e,["windowWidth"]),widget:{...e.widget,title:""}},!l()(i,e)||!l()(this.state,t)}tableResultComponent(e){let{loading:t,errorMessage:s,tableResults:r}=e;const{location:i,widget:n,organization:o,selection:a}=this.props;if(s)return(0,B.tZ)(z,{children:(0,B.tZ)(j.FC,{color:"gray500",size:"lg"})});if(void 0===r)return(0,B.tZ)(I,{});const l=(0,R.v)(n.widgetType);return r.map(((e,s)=>{var d,u,c,p,m;const g=null!==(d=null===(u=n.queries[s])||void 0===u||null===(c=u.fields)||void 0===c?void 0:c.map(F.hr))&&void 0!==d?d:[],h=null!==(p=null===(m=n.queries[s])||void 0===m?void 0:m.fieldAliases)&&void 0!==p?p:[],v=(0,T.tT)(n.title,n.queries[0],a,n.displayType);return(0,B.tZ)($,{eventView:v,fieldAliases:h,location:i,fields:g,title:r.length>1?e.title:"",loading:t,loader:(0,B.tZ)(I,{}),metadata:e.meta,data:e.data,organization:o,stickyHeaders:!0,getCustomFieldRenderer:l.getCustomFieldRenderer},`table:${e.title}`)}))}bigNumberComponent(e){let{loading:t,errorMessage:s,tableResults:r}=e;if(s)return(0,B.tZ)(z,{children:(0,B.tZ)(j.FC,{color:"gray500",size:"lg"})});if(void 0===r||t)return(0,B.tZ)(V,{children:"—"});const{containerHeight:i}=this.state,{location:n,organization:o,widget:a,isMobile:l,expandNumbers:d}=this.props,u=!o.features.includes("discover-frontend-use-events-endpoint")&&a.widgetType!==q.l9.RELEASE;return r.map((e=>{var t,s;const r={...e.meta},c=Object.keys(r)[0],p=!!d&&"integer"===r[c];if(p&&(r[c]="string"),!c||null===(t=e.data)||void 0===t||!t.length)return(0,B.tZ)(V,{children:"—"},`big_number:${e.title}`);const m=e.data[0],g=(0,E.fK)(c,r,u),h=null===(s=r.units)||void 0===s?void 0:s[c],v=g(p?{[c]:m[c].toLocaleString()}:m,{location:n,organization:o,unit:h}),f=!(a.id||a.tempId);if(!o.features.includes("dashboard-grid-layout")||f||l)return(0,B.tZ)(V,{children:v},`big_number:${e.title}`);const b=d?`max(min(8vw, 90px), ${(0,O.Z)(4)})`:i-parseInt((0,O.Z)(1),10)-parseInt((0,O.Z)(3),10);return(0,B.tZ)(V,{style:{fontSize:b,...d?{padding:`${(0,O.Z)(1)} ${(0,O.Z)(3)} 0 ${(0,O.Z)(3)}`}:{}},children:(0,B.tZ)(S.Z,{title:v,showOnlyOnOverflow:!0,children:v})},`big_number:${e.title}`)}))}chartComponent(e){const{organization:t,widget:s}=this.props,r=t.features.includes("new-widget-builder-experience-design")&&s.queries[0].columns.length>0;switch(s.displayType){case"bar":return(0,B.tZ)(p.v,{...e,stacked:r});case"area":case"top_n":return(0,B.tZ)(c.T,{stacked:!0,...e});case"world_map":return(0,B.tZ)(x.y,{...e});default:return(0,B.tZ)(h.w,{...e})}}render(){var e,t,s;const{theme:r,tableResults:i,timeseriesResults:n,errorMessage:o,loading:a,widget:l,organization:d,onZoom:u,legendOptions:c,expandNumbers:p,showSlider:g,noPadding:h,chartZoomOptions:v,timeseriesResultsType:b}=this.props;if("table"===l.displayType)return(0,C.Z)({value:(0,B.BX)(f.Z,{loading:a,reloading:a,children:[(0,B.tZ)(k,{loading:a}),this.tableResultComponent({tableResults:i,loading:a,errorMessage:o})]}),fixed:(0,B.tZ)(Z.Z,{height:"200px",testId:"skeleton-ui"})});if("big_number"===l.displayType)return(0,B.BX)(f.Z,{loading:a,reloading:a,children:[(0,B.tZ)(k,{loading:a}),(0,B.tZ)(M,{ref:e=>{if(null!==e&&!p){const{height:t}=e.getBoundingClientRect();t!==this.state.containerHeight&&this.setState({containerHeight:t})}},children:this.bigNumberComponent({tableResults:i,loading:a,errorMessage:o})})]});if(o)return(0,B.tZ)(z,{children:(0,B.tZ)(j.FC,{color:"gray500",size:"lg"})});const{location:x,router:w,selection:S,onLegendSelectChanged:O}=this.props,{start:E,end:T,period:R,utc:q}=S.datetime,A=Boolean(d.features.includes("dashboard-grid-layout")&&(l.id||l.tempId));if("world_map"===l.displayType){const{data:e,title:t}=(0,y.JT)(i),s=[{seriesName:t,data:e}];return(0,B.BX)(f.Z,{loading:a,reloading:a,children:[(0,B.tZ)(k,{loading:a}),(0,B.tZ)(P,{autoHeightResize:A,children:(0,C.Z)({value:this.chartComponent({series:s,autoHeightResize:A}),fixed:(0,B.tZ)(Z.Z,{height:"200px",testId:"skeleton-ui"})})})]})}const L={left:0,top:0,selected:(0,y.RI)(x),formatter:e=>{const t=(0,F.hW)(e);if(null!==t){const s=(0,F.b8)(t);null!==s&&(e=s.toUpperCase())}return(0,F.by)(e)&&(e=(0,F.bQ)(e)),e},...c},N=null!==(e=null===(t=l.queries[0])||void 0===t||null===(s=t.aggregates)||void 0===s?void 0:s[0])&&void 0!==e?e:"count()",I=(0,F.GO)(N)?(0,F.vp)(N):N,V={autoHeightResize:A,grid:{left:0,right:4,top:"40px",bottom:g?D:0},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(e,t)=>b?(0,_.CX)(e,b):(0,_.CX)(e,(0,F.Px)(t))},yAxis:{axisLabel:{color:r.chartLabel,formatter:e=>b?(0,_.x1)(e,b):(0,_.gu)(e,(0,F.Px)(I))}}};return(0,B.tZ)(m.Z,{router:w,period:R,start:E,end:T,utc:q,showSlider:g,chartZoomOptions:v,children:e=>{var t,s,i,l;if(o)return(0,B.tZ)(z,{children:(0,B.tZ)(j.FC,{color:"gray500",size:"lg"})});const d=new RegExp("(?:.* : Other$)|^Other$"),c=null==n?void 0:n.some((e=>{let{seriesName:t}=e;return t&&t.match(d)})),p=n?r.charts.getColorPalette(n.length-(c?3:2)):[];c&&(p[p.length]=r.chartOther);const m=n?n.map(((e,t)=>{let s="";return void 0!==e.seriesName&&(s=(0,F.GO)(e.seriesName)?(0,F.vp)(e.seriesName):e.seriesName),{...e,seriesName:s,color:p[t]}})):[],g=null===(t=m[0])||void 0===t||null===(s=t.data[0])||void 0===s?void 0:s.name,v=null===(i=m[0])||void 0===i||null===(l=i.data[m[0].data.length-1])||void 0===l?void 0:l.name;return(0,B.BX)(f.Z,{loading:a,reloading:a,children:[(0,B.tZ)(k,{loading:a}),(0,B.tZ)(P,{autoHeightResize:A,noPadding:h,children:(0,C.Z)({value:this.chartComponent({...e,...V,...u?{onDataZoom:(e,t)=>u({...e,seriesStart:g,seriesEnd:v},t)}:{},legend:L,series:m,onLegendSelectChanged:O}),fixed:(0,B.tZ)(Z.Z,{height:"200px",testId:"skeleton-ui"})})})]})}})}}A.displayName="WidgetCardChart";const L=(0,o.d)(A),N=(0,i.Z)((e=>(0,B.tZ)(b.Z,{...e,maskBackgroundColor:"transparent"})),{target:"eb7j3e6"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"}),k=e=>{let{loading:t}=e;return t?(0,B.tZ)(N,{visible:t,children:(0,B.tZ)(w.Z,{mini:!0})}):null};k.displayName="LoadingScreen";const I=(0,i.Z)((e=>{let{className:t}=e;return(0,B.tZ)(Z.Z,{height:"200px",className:t})}),{target:"eb7j3e5"})("background-color:",(e=>e.theme.surface200),";"),M=(0,i.Z)("div",{target:"eb7j3e4"})({name:"af8mp8",styles:"height:100%;width:100%;overflow:hidden"}),V=(0,i.Z)("div",{target:"eb7j3e3"})("line-height:1;display:inline-flex;flex:1;width:100%;min-height:0;font-size:32px;color:",(e=>e.theme.headingColor),";padding:",(0,O.Z)(1)," ",(0,O.Z)(3)," ",(0,O.Z)(3)," ",(0,O.Z)(3),";*{text-align:left!important;}"),P=(0,i.Z)("div",{target:"eb7j3e2"})((e=>e.autoHeightResize&&"height: 100%;")," padding:",(e=>e.noPadding?"0":`0 ${(0,O.Z)(3)} ${(0,O.Z)(3)}`),";"),$=(0,i.Z)(v.Z,{target:"eb7j3e1"})("margin-top:",(0,O.Z)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;"),z=(0,i.Z)(g.Z,{target:"eb7j3e0"})("padding:",(0,O.Z)(2),";")},"./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx":(e,t,s)=>{s.d(t,{HH:()=>l,KC:()=>u,XA:()=>a,k:()=>d}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),i=s("./app/utils/performance/contexts/utils.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[o,a,l]=(0,i.n)({name:"DashboardsMEPContext"}),d=l.Consumer;function u(e){let{children:t}=e;const[s,i]=(0,r.useState)(void 0);return(0,n.tZ)(o,{value:{isMetricsData:s,setIsMetricsData:i},children:t})}u.displayName="DashboardsMEPProvider"},"./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>g});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/cloneDeep.js"),o=s.n(n),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("./app/components/organizations/pageFilters/utils.tsx"),u=s("./app/locale.tsx"),c=s("./app/views/dashboardsV2/types.tsx");function p(e){let t="";return t=e===c.FO.TABLE?"api.dashboards.tablewidget":e===c.FO.BIG_NUMBER?"api.dashboards.bignumberwidget":e===c.FO.WORLD_MAP?"api.dashboards.worldmapwidget":`api.dashboards.widget.${e}-chart`,t}class m extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{loading:!0,queryFetchID:void 0,errorMessage:void 0,timeseriesResults:void 0,rawResults:void 0,tableResults:void 0,pageLinks:void 0,timeseriesResultsType:void 0}),(0,r.Z)(this,"_isMounted",!1)}componentDidMount(){this._isMounted=!0,this.props.loading||this.fetchData()}componentDidUpdate(e){var t;const{selection:s,widget:r,cursor:i,organization:n,config:o,customDidUpdateComparator:a}=this.props,[u,c]=e.widget.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e)),e.columns=e.columns.filter((e=>!!e)),e))).reduce(((e,t)=>{let[s,r]=e,{name:i,...n}=t;return s.push(i),r.push(n),[s,r]}),[[],[]]),[p,m]=r.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e&&"equation|"!==e)),e.columns=e.columns.filter((e=>!!e&&"equation|"!==e)),e))).reduce(((e,t)=>{let[s,r]=e,{name:i,...n}=t;return s.push(i),r.push(n),[s,r]}),[[],[]]);(a?!a(e,this.props):r.limit===e.widget.limit&&l()(r.displayType,e.widget.displayType)&&l()(r.interval,e.widget.interval)&&l()(m,c)&&l()(this.props.dashboardFilters,e.dashboardFilters)&&(0,d.WO)(s,e.selection)&&i===e.cursor)?this.state.loading||l()(u,p)||(null===(t=this.state.rawResults)||void 0===t?void 0:t.length)!==r.queries.length||this.setState((e=>{const t=r.queries.reduce(((t,s,r)=>t.concat(o.transformSeries(e.rawResults[r],s,n))),[]);return{...e,timeseriesResults:t}})):this.fetchData()}componentWillUnmount(){this._isMounted=!1}applyDashboardFilters(e){const{dashboardFilters:t}=this.props;let s="";if(t)for(const[e,r]of Object.entries(t))1===r.length?s+=`${e}:${r[0]} `:r.length>1&&(s+=`${e}:[${r.join(",")}] `);return e.queries.forEach((e=>{e.conditions=e.conditions+(""===s?"":` ${s}`)})),e}async fetchTableData(e){const{widget:t,limit:s,config:r,api:i,organization:n,selection:a,cursor:l,afterFetchTableData:d,onDataFetched:m}=this.props,g=this.applyDashboardFilters(o()(t)),h=await Promise.all(g.queries.map((e=>{let t=null!=s?s:c.$V,o=r.getTableRequest;if(g.displayType===c.FO.WORLD_MAP&&(t=void 0,o=r.getWorldMapRequest),!o)throw new Error((0,u.t)("This display type is not supported by the selected dataset."));return o(i,e,n,a,t,l,p(g.displayType))})));let v,f,b=[];h.forEach(((e,t)=>{var s,i,o,l;let[u,c,p]=e;f=null!==(s=null==d?void 0:d(u,p))&&void 0!==s?s:{};const m=r.transformTable(u,g.queries[0],n,a);m.title=null!==(i=null===(o=g.queries[t])||void 0===o?void 0:o.name)&&void 0!==i?i:"",b=[...b,m],v=null!==(l=(null==p?void 0:p.getResponseHeader("Link"))||(null==p?void 0:p.getResponseHeader("link")))&&void 0!==l?l:void 0})),this._isMounted&&this.state.queryFetchID===e&&(null==m||m({tableResults:b,pageLinks:v,...f}),this.setState({tableResults:b,pageLinks:v}))}async fetchSeriesData(e){var t,s;const{widget:r,config:i,api:n,organization:a,selection:l,afterFetchSeriesData:d,onDataFetched:u}=this.props,c=this.applyDashboardFilters(o()(r)),m=await Promise.all(c.queries.map(((e,t)=>i.getSeriesRequest(n,c,t,a,l,p(c.displayType))))),g=null!==(t=o()(this.state.rawResults))&&void 0!==t?t:[],h=[];m.forEach(((e,t)=>{let[s]=e;null==d||d(s),g[t]=s;const r=i.transformSeries(s,c.queries[t],a);r.forEach(((e,s)=>{h[t*r.length+s]=e}))}));const v=null===(s=i.getSeriesResultType)||void 0===s?void 0:s.call(i,m[0][0],c.queries[0]);this._isMounted&&this.state.queryFetchID===e&&(null==u||u({timeseriesResults:h}),this.setState({timeseriesResults:h,rawResults:g,timeseriesResultsType:v}))}async fetchData(){const{widget:e}=this.props,t=Symbol("queryFetchID");this.setState({loading:!0,tableResults:void 0,timeseriesResults:void 0,errorMessage:void 0,queryFetchID:t});try{[c.FO.TABLE,c.FO.BIG_NUMBER,c.FO.WORLD_MAP].includes(e.displayType)?await this.fetchTableData(t):await this.fetchSeriesData(t)}catch(e){var s;this._isMounted&&this.setState({errorMessage:(null==e||null===(s=e.responseJSON)||void 0===s?void 0:s.detail)||(null==e?void 0:e.message)||(0,u.t)("An unknown error occurred.")})}finally{this._isMounted&&this.setState({loading:!1})}}render(){const{children:e}=this.props,{loading:t,tableResults:s,timeseriesResults:r,errorMessage:i,pageLinks:n,timeseriesResultsType:o}=this.state;return e({loading:t,tableResults:s,timeseriesResults:r,errorMessage:i,pageLinks:n,timeseriesResultsType:o})}}m.displayName="GenericWidgetQueries";const g=m},"./app/views/dashboardsV2/widgetCard/issueWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>d}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),i=s("./app/stores/memberListStore.tsx"),n=s("./app/utils/getDynamicText.tsx"),o=s("./app/views/dashboardsV2/datasetConfig/issues.tsx"),a=s("./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=function(e){let{children:t,api:s,organization:d,selection:u,widget:c,cursor:p,limit:m,dashboardFilters:g,onDataFetched:h}=e;const[v,f]=(0,r.useState)(!1);(0,r.useEffect)((()=>{f(i.Z.isLoaded());const e=i.Z.listen((()=>{f(i.Z.isLoaded())}),void 0);return()=>e()}),[]);const b=o.f;return(0,n.Z)({value:(0,l.tZ)(a.Z,{config:b,api:s,organization:d,selection:u,widget:c,cursor:p,limit:m,dashboardFilters:g,onDataFetched:h,afterFetchTableData:(e,t)=>{var s;return{totalIssuesCount:null!==(s=null==t?void 0:t.getResponseHeader("X-Hits"))&&void 0!==s?s:void 0}},children:e=>{let{loading:s,...r}=e;return t({loading:s||!v,...r})}}),fixed:(0,l.tZ)("div",{})})}},"./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Vl:()=>_,ZP:()=>F,gp:()=>O,nD:()=>S});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/cloneDeep.js"),o=s.n(n),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/omit.js"),u=s.n(d),c=s("../node_modules/lodash/trimStart.js"),p=s.n(c),m=s("./app/actionCreators/indicator.tsx"),g=s("./app/components/organizations/pageFilters/utils.tsx"),h=s("./app/locale.tsx"),v=s("./app/utils/discover/fields.tsx"),f=s("./app/utils/discover/types.tsx"),b=s("./app/views/dashboardsV2/datasetConfig/releases.tsx"),y=s("./app/views/dashboardsV2/types.tsx"),x=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),w=s("./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function S(e){var t;return null!==(t=x.Mg[e])&&void 0!==t?t:e}function j(e){let t="";const s=[];t+="release:["+e[0].version,s.push(e[0].version);for(let r=1;r<e.length;r++)t+=","+e[r].version,s.push(e[r].version);return t+="]",e.length<10?{releaseQueryString:t,releasesUsed:s}:e.length>10&&t.length>1500?j(e.slice(0,-10)):{releaseQueryString:t,releasesUsed:s}}function O(e,t,s){const r=e.map(v.hr),i=r.filter((e=>Object.values(x.Xg).includes(e))),n=[],o=p()(t,"-"),a=x.d2.includes(o)||s||"release"===o;return!o||a||e.includes(o)||n.includes(o)||n.push(o),s?(i.forEach((e=>{const t=e.match(x.$4);t&&("user"!==t[2]||r.includes("count_unique(user)")||(n.push("count_unique(user)"),r.push("count_unique(user)")),"session"!==t[2]||r.includes("sum(session)")||(n.push("sum(session)"),r.push("sum(session)")))})),{aggregates:r,derivedStatusFields:i,injectedFields:n}):{aggregates:r,derivedStatusFields:i,injectedFields:n}}function _(e){const t=!e.columns.includes("session.status"),s=p()(e.orderby,"-");return t&&"release"===s}class E extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{loading:!0,errorMessage:void 0,releases:void 0}),(0,r.Z)(this,"config",b.u$),(0,r.Z)(this,"_isMounted",!1),(0,r.Z)(this,"fetchReleases",(async()=>{this.setState({loading:!0,errorMessage:void 0});const{selection:e,api:t,organization:s}=this.props,{environments:r,projects:i}=e;try{const e=await t.requestPromise(`/organizations/${s.slug}/releases/`,{method:"GET",data:{sort:"date",project:i,per_page:50,environment:r}});if(!this._isMounted)return;this.setState({releases:e,loading:!1})}catch(e){if(!this._isMounted)return;const t=e.responseJSON?e.responseJSON.error:(0,h.t)("Error sorting by releases");this.setState({errorMessage:t,loading:!1}),(0,m.Iw)(t)}})),(0,r.Z)(this,"customDidUpdateComparator",((e,t)=>{const{loading:s,limit:r,widget:i,cursor:n,organization:o,selection:a,dashboardFilters:d}=t,c=["queries","title","id","layout","tempId","widgetType"],p=["name","fields","aggregates","columns"];return!(r===e.limit&&o.slug===e.organization.slug&&l()(d,e.dashboardFilters)&&(0,g.WO)(a,e.selection)&&l()(u()(i,c),u()(e.widget,c))&&l()(i.queries.map((e=>u()(e,p))),e.widget.queries.map((e=>u()(e,p))))&&l()(i.queries.flatMap((e=>{var t;return null===(t=e.fields)||void 0===t?void 0:t.filter((e=>!!e))})),e.widget.queries.flatMap((e=>{var t;return null===(t=e.fields)||void 0===t?void 0:t.filter((e=>!!e))})))&&l()(i.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))))&&l()(i.queries.flatMap((e=>e.columns.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.columns.filter((e=>!!e)))))&&s===e.loading&&n===e.cursor)})),(0,r.Z)(this,"transformWidget",(e=>{const{releases:t}=this.state,s=o()(e),r=_(s.queries[0]),i=s.queries[0].orderby.startsWith("-"),n=s.queries[0].columns.includes("session.status");let a="";const l=[];if(r&&(t&&1===t.length&&(a+=`release:${t[0].version}`,l.push(t[0].version)),t&&t.length>1)){const{releaseQueryString:e,releasesUsed:s}=j(t);a+=e,l.push(...s),i||l.reverse()}return n||s.queries.forEach((e=>{e.conditions=e.conditions+(""===a?"":` ${a}`)})),s})),(0,r.Z)(this,"afterFetchData",(e=>{const{widget:t}=this.props,{releases:s}=this.state,r=t.queries[0].orderby.startsWith("-"),i=[];if(_(t.queries[0])&&(s&&1===s.length&&i.push(s[0].version),s&&s.length>1)){const{releasesUsed:e}=j(s);i.push(...e),r||i.reverse()}i.length&&(e.groups.sort((function(e,t){const s=e.by.release,r=t.by.release;return i.indexOf(s)-i.indexOf(r)})),e.groups=e.groups.slice(0,this.limit))}))}componentDidMount(){this._isMounted=!0,_(this.props.widget.queries[0])&&this.fetchReleases()}componentWillUnmount(){this._isMounted=!1}get limit(){const{limit:e}=this.props;switch(this.props.widget.displayType){case y.FO.TOP_N:return f.hY;case y.FO.TABLE:return null!=e?e:y.$V;case y.FO.BIG_NUMBER:return 1;default:return null!=e?e:20}}render(){const{api:e,children:t,organization:s,selection:r,widget:i,cursor:n,dashboardFilters:o,onDataFetched:a}=this.props,l=b.u$;return(0,Z.tZ)(w.Z,{config:l,api:e,organization:s,selection:r,widget:this.transformWidget(i),dashboardFilters:o,cursor:n,limit:this.limit,onDataFetched:a,loading:_(i.queries[0])?!this.state.releases:void 0,customDidUpdateComparator:this.customDidUpdateComparator,afterFetchTableData:this.afterFetchData,afterFetchSeriesData:this.afterFetchData,children:e=>{var s;let{errorMessage:r,...i}=e;return t({errorMessage:null!==(s=this.state.errorMessage)&&void 0!==s?s:r,...i})}})}}E.displayName="ReleaseWidgetQueries";const F=E},"./app/views/dashboardsV2/widgetCard/widgetCardChartContainer.tsx":(e,t,s)=>{s.d(t,{b:()=>_,Z:()=>E});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/react/index.js"),n=s("../node_modules/react-router/es/index.js"),o=s("./app/components/charts/transparentLoadingMask.tsx"),a=s("./app/components/loadingIndicator.tsx"),l=s("./app/views/dashboardsV2/types.tsx"),d=s("./app/views/dashboardsV2/widgetCard/chart.tsx"),u=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./app/components/charts/errorPanel.tsx")),c=s("./app/components/charts/simpleTableChart.tsx"),p=s("./app/components/placeholder.tsx"),m=s("./app/icons/index.tsx"),g=s("./app/styles/space.tsx"),h=s("./app/utils.tsx"),v=s("./app/views/dashboardsV2/utils.tsx"),f=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),b=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function x(e){var t;let{organization:s,selection:r,widget:i,errorMessage:n,loading:o,transformedResults:a,location:d}=e;const c=(0,f.v)(l.l9.ISSUE);if(n)return(0,y.tZ)(u.Z,{children:(0,y.tZ)(m.FC,{color:"gray500",size:"lg"})});if(o)return(0,y.tZ)(w,{height:"200px"});const p=i.queries[0],g=(0,h.ri)(p.fields)?p.fields:[...p.columns,...p.aggregates],x=null!==(t=p.fieldAliases)&&void 0!==t?t:[],S=(0,v.tT)(i.title,i.queries[0],r,i.displayType);return(0,y.tZ)(Z,{location:d,title:"",eventView:S,fields:g,fieldAliases:x,loading:o,metadata:b.$L,data:a,organization:s,getCustomFieldRenderer:c.getCustomFieldRenderer,fieldHeaderMap:c.fieldHeaderMap,stickyHeaders:!0})}x.displayName="IssueWidgetCard";const w=(0,r.Z)(p.Z,{target:"e11eoa721"})("background-color:",(e=>e.theme.surface200),";"),Z=(0,r.Z)(c.Z,{target:"e11eoa720"})("margin-top:",(0,g.Z)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;");var S=s("./app/views/dashboardsV2/widgetCard/issueWidgetQueries.tsx"),j=s("./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx"),O=s("./app/views/dashboardsV2/widgetCard/widgetQueries.tsx");function _(e){let{location:t,router:s,api:r,organization:n,selection:o,widget:a,dashboardFilters:u,isMobile:c,renderErrorMessage:p,tableItemLimit:m,windowWidth:g,onZoom:h,onLegendSelectChanged:v,legendOptions:f,expandNumbers:b,onDataFetched:w,showSlider:Z,noPadding:_,chartZoomOptions:E}=e;return a.widgetType===l.l9.ISSUE?(0,y.tZ)(S.Z,{api:r,organization:n,widget:a,selection:o,limit:m,onDataFetched:w,dashboardFilters:u,children:e=>{var s;let{tableResults:r,errorMessage:l,loading:d}=e;return(0,y.BX)(i.Fragment,{children:["function"==typeof p?p(l):null,(0,y.tZ)(C,{loading:d}),(0,y.tZ)(x,{transformedResults:null!==(s=null==r?void 0:r[0].data)&&void 0!==s?s:[],loading:d,errorMessage:l,widget:a,organization:n,location:t,selection:o})]})}}):a.widgetType===l.l9.RELEASE?(0,y.tZ)(j.ZP,{api:r,organization:n,widget:a,selection:o,limit:null!==(F=a.limit)&&void 0!==F?F:m,onDataFetched:w,dashboardFilters:u,children:e=>{let{tableResults:r,timeseriesResults:l,errorMessage:u,loading:m}=e;return(0,y.BX)(i.Fragment,{children:["function"==typeof p?p(u):null,(0,y.tZ)(d.Z,{timeseriesResults:l,tableResults:r,errorMessage:u,loading:m,location:t,widget:a,selection:o,router:s,organization:n,isMobile:c,windowWidth:g,expandNumbers:b,onZoom:h,showSlider:Z,noPadding:_,chartZoomOptions:E})]})}}):(0,y.tZ)(O.ZP,{api:r,organization:n,widget:a,selection:o,limit:m,onDataFetched:w,dashboardFilters:u,children:e=>{let{tableResults:r,timeseriesResults:l,errorMessage:u,loading:m,timeseriesResultsType:x}=e;return(0,y.BX)(i.Fragment,{children:["function"==typeof p?p(u):null,(0,y.tZ)(d.Z,{timeseriesResults:l,tableResults:r,errorMessage:u,loading:m,location:t,widget:a,selection:o,router:s,organization:n,isMobile:c,windowWidth:g,onZoom:h,onLegendSelectChanged:v,legendOptions:f,expandNumbers:b,showSlider:Z,noPadding:_,chartZoomOptions:E,timeseriesResultsType:x})]})}});var F}_.displayName="WidgetCardChartContainer";const E=(0,n.withRouter)(_),F=(0,r.Z)((e=>(0,y.tZ)(o.Z,{...e,maskBackgroundColor:"transparent"})),{target:"e14ay5ol0"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"}),C=e=>{let{loading:t}=e;return t?(0,y.tZ)(F,{visible:t,children:(0,y.tZ)(a.Z,{mini:!0})}):null};C.displayName="LoadingScreen"},"./app/views/dashboardsV2/widgetCard/widgetQueries.tsx":(e,t,s)=>{s.d(t,{FN:()=>p,ZP:()=>h,vD:()=>m}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/react/index.js"),i=s("../node_modules/lodash/omit.js"),n=s.n(i),o=(s("./app/components/charts/utils.tsx"),s("./app/utils/discover/fieldRenderers.tsx")),a=s("./app/utils/discover/fields.tsx"),l=s("./app/views/dashboardsV2/datasetConfig/errorsAndTransactions.tsx"),d=s("./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx"),u=s("./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx"),c=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e,t,s){var r,i,n,l,d,u;const c=null===(r=e.meta)||void 0===r||null===(i=r.units)||void 0===i?void 0:i[(0,a.LY)(s)],p=null!==(n=c&&(null!==(l=o.a_[c])&&void 0!==l?l:o.en[c]))&&void 0!==n?n:1;return{seriesName:t,data:null!==(d=null==e||null===(u=e.data)||void 0===u?void 0:u.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*p}})))&&void 0!==d?d:[]}}function m(e,t){const s=[];return Object.keys(e).forEach((r=>{Object.keys(n()(e[r],"order")).forEach((i=>{const n=`${r} : ${i}`,o=t?`${t} > ${n}`:n,a=e[r][i];s.push([e[r].order||0,p(a,o,n)])}))})),s}function g(e){let{api:t,children:s,organization:i,selection:n,widget:o,dashboardFilters:a,cursor:p,limit:m,onDataFetched:g}=e;const h=l.g,v=(0,r.useContext)(d.HH);let f;v&&(f=v.setIsMetricsData);const b=[],y=[];return(0,c.tZ)(u.Z,{config:h,api:t,organization:i,selection:n,widget:o,cursor:p,limit:m,dashboardFilters:a,onDataFetched:g,afterFetchSeriesData:e=>{var t;e.data?void 0!==(e=e).isMetricsData&&b.push(e.isMetricsData):Object.keys(e).forEach((t=>{const s=e[t];void 0!==s.isMetricsData&&b.push(s.isMetricsData)})),null===(t=f)||void 0===t||t(!b.includes(!1))},afterFetchTableData:e=>{var t,s;void 0!==(null===(t=e.meta)||void 0===t?void 0:t.isMetricsData)&&y.push(e.meta.isMetricsData),null===(s=f)||void 0===s||s(!y.includes(!1))},children:s})}g.displayName="WidgetQueries";const h=g}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_loadingPanel_tsx-app_components_modals_widgetViewerModal_utils_tsx-app_-39afc0.49196c14b57cbf0fb163c78b9837263a.js.map