"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_account_accountNotificationFineTuning_tsx"],{"./app/data/forms/accountNotificationSettings.tsx":(t,e,i)=>{i.r(e),i.d(e,{fields:()=>o,route:()=>s});var n=i("./app/locale.tsx");const s="/settings/account/notifications/",o={subscribeByDefault:{name:"subscribeByDefault",type:"boolean",label:(0,n.t)("Send Me Alerts"),help:(0,n.t)("Enable this to receive notifications for Alerts sent to your teams. You will always receive alerts configured to be sent directly to you.")},workflowNotifications:{name:"workflowNotifications",type:"radio",label:(0,n.t)("Send Me Workflow Notifications"),choices:[[0,(0,n.t)("Always")],[1,(0,n.t)("Only On Issues I Subscribe To")],[2,(0,n.t)("Never")]],help:(0,n.t)("E.g. changes in issue assignment, resolution status, and comments.")},weeklyReports:{name:"weeklyReports",type:"boolean",label:(0,n.t)("Send Me Weekly Reports"),help:(0,n.t)("Reports contain a summary of what's happened within your organization."),disabled:!0},deployNotifications:{name:"deployNotifications",type:"radio",label:(0,n.t)("Send Me Deploy Notifications"),choices:[[2,(0,n.t)("Always")],[3,(0,n.t)("Only On Deploys With My Commits")],[4,(0,n.t)("Never")]],help:(0,n.t)("Deploy emails include release, environment and commit overviews.")},personalActivityNotifications:{name:"personalActivityNotifications",type:"boolean",label:(0,n.t)("Notify Me About My Own Activity"),help:(0,n.t)("Enable this to receive notifications about your own actions on Sentry.")},selfAssignOnResolve:{name:"selfAssignOnResolve",type:"boolean",label:(0,n.t)("Claim Unassigned Issues I've Resolved"),help:(0,n.t)("You'll receive notifications about any changes that happen afterwards.")}}},"./app/views/asyncView.tsx":(t,e,i)=>{i.d(e,{Z:()=>a});var n=i("./app/components/asyncComponent.tsx"),s=i("./app/components/sentryDocumentTitle.tsx"),o=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends n.Z{getTitle(){return""}render(){return(0,o.tZ)(s.Z,{title:this.getTitle(),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/account/accountNotificationFineTuning.tsx":(t,e,i)=>{i.r(e),i.d(e,{default:()=>Y});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/react/index.js")),o=i("./app/components/forms/form.tsx"),a=i("./app/components/forms/jsonForm.tsx"),r=i("./app/components/forms/selectField.tsx"),l=i("./app/components/pagination.tsx"),c=i("./app/components/panels/index.tsx"),p=i("./app/data/forms/accountNotificationSettings.tsx"),u=i("./app/locale.tsx"),d=i("./app/utils/withOrganizations.tsx"),m=i("./app/views/asyncView.tsx");const f={alerts:{title:"Issue Alert Notifications",description:(0,u.t)("Notifications from Alert Rules that your team has setup. Youâ€™ll always receive notifications from Alerts configured to be sent directly to you."),type:"select",options:[{value:"-1",label:(0,u.t)("Default")},{value:"1",label:(0,u.t)("On")},{value:"0",label:(0,u.t)("Off")}],defaultValue:"-1",defaultFieldName:"subscribeByDefault"},workflow:{title:"Workflow Notifications",description:(0,u.t)("Control workflow notifications, e.g. changes in issue assignment, resolution status, and comments."),type:"select",options:[{value:"-1",label:(0,u.t)("Default")},{value:"0",label:(0,u.t)("Always")},{value:"1",label:(0,u.t)("Only on issues I subscribe to")},{value:"2",label:(0,u.t)("Never")}],defaultValue:"-1",defaultFieldName:"workflowNotifications"},activeRelease:{title:"Issues in My Releases",description:(0,u.t)("Get a notification when an issue happens shortly after your release."),type:"select",defaultValue:"0",options:[{value:"1",label:(0,u.t)("On")},{value:"0",label:(0,u.t)("Off")}],defaultFieldName:"activeReleaseNotifications"},deploy:{title:(0,u.t)("Deploy Notifications"),description:(0,u.t)("Control deploy notifications that include release, environment, and commit overviews."),type:"select",options:[{value:"-1",label:(0,u.t)("Default")},{value:"2",label:(0,u.t)("Always")},{value:"3",label:(0,u.t)("Only on deploys with my commits")},{value:"4",label:(0,u.t)("Never")}],defaultValue:"-1",defaultFieldName:"deployNotifications"},reports:{title:(0,u.t)("Weekly Reports"),description:(0,u.t)("Reports contain a summary of what's happened within the organization."),type:"select",defaultValue:"1",options:[{value:"1",label:(0,u.t)("On")},{value:"0",label:(0,u.t)("Off")}],defaultFieldName:"weeklyReports"},approval:{title:(0,u.t)("Approvals"),description:(0,u.t)("Notifications from teammates that require review or approval."),type:"select"},quota:{title:(0,u.t)("Quota Notifications"),description:(0,u.t)("Control the notifications you receive for error, transaction, and attachment quota limits."),type:"select"},email:{title:(0,u.t)("Email Routing"),description:(0,u.t)("On a per project basis, route emails to an alternative email address."),type:"select"}};var h=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),g=i("./app/components/asyncComponent.tsx"),y=i("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),v=i("./app/views/settings/account/notifications/constants.tsx"),b=i("./app/views/settings/account/notifications/fields2.tsx"),Z=i("./app/views/settings/account/notifications/utils.tsx"),w=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class S extends s.Component{render(){const{notificationType:t,notificationSettings:e,onChange:i,onSubmitSuccess:n,organizations:s}=this.props;return(0,w.tZ)(o.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:(0,Z.tl)(t,e,s),onSubmitSuccess:n,children:(0,w.tZ)(a.Z,{title:(0,u.t)("Organizations"),fields:s.map((n=>(0,Z.gw)(t,e,n,i)))})})}}S.displayName="NotificationSettingsByOrganization";const j=(0,d.Z)(S);var x=i("./app/utils.tsx"),T=i("./app/views/settings/components/defaultSearchBar.tsx"),N=i("./app/views/settings/components/emptyMessage.tsx");class k extends g.Z{constructor(){super(...arguments),(0,h.Z)(this,"getProjectCount",(()=>{var t;const{notificationType:e,notificationSettings:i}=this.props;return Object.values((null===(t=i[e])||void 0===t?void 0:t.project)||{}).length})),(0,h.Z)(this,"getGroupedProjects",(()=>{const{projects:t}=this.state;return Object.fromEntries(Object.values((0,Z.uI)((0,x.Mx)(t))).map((t=>{let{organization:e,projects:i}=t;return[`${e.name} Projects`,i]})))}))}getDefaultState(){return{...super.getDefaultState(),projects:[]}}getEndpoints(){return[["projects","/projects/"]]}renderBody(){const{notificationType:t,notificationSettings:e,onChange:i,onSubmitSuccess:n}=this.props,{projects:r,projectsPageLinks:c}=this.state,p=this.getProjectCount()>=v.Zb,d=r.length>=v.sg;return(0,w.BX)(s.Fragment,{children:[p&&this.renderSearchInput({stateKey:"projects",url:"/projects/",placeholder:(0,u.t)("Search Projects"),children:t=>{let{defaultSearchBar:e}=t;return(0,w.tZ)(P,{children:e})}}),(0,w.tZ)(o.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:(0,Z.tl)(t,e,r),onSubmitSuccess:n,children:0===r.length?(0,w.tZ)(N.Z,{children:(0,u.t)("No projects found")}):Object.entries(this.getGroupedProjects()).map((n=>{let[s,o]=n;return(0,w.tZ)(a.Z,{collapsible:!0,title:s,fields:o.map((n=>(0,Z.gw)(t,e,n,i)))},s)}))}),p&&d&&(0,w.tZ)(l.Z,{pageLinks:c,...this.props})]})}}const O=k,P=(0,n.Z)(T._,{target:"e1ab1zjl0"})({name:"1ekhw56",styles:"*{width:100%;}"});var D=i("./app/components/alert.tsx");function B(t){let{organizations:e}=t;return(0,w.BX)(_,{type:"warning",showIcon:!0,children:[(0,u.t)("You've selected Slack as your delivery method, but do not have a linked account for the following organizations. You'll receive email notifications instead until you type \"/sentry link\" into your Slack workspace to link your account. If slash commands are not working, please re-install the Slack integration."),(0,w.tZ)("ul",{children:e.map((t=>(0,w.tZ)("li",{children:t.slug},t.id)))})]})}B.displayName="UnlinkedAlert";const _=(0,n.Z)(D.Z,{target:"e1w8osu50"})({name:"12jd8yt",styles:"margin:20px 0px"}),z=B;var F=i("./app/views/settings/components/settingsPageHeader.tsx"),A=i("./app/views/settings/components/text/textBlock.tsx");const I={quota:["quotaErrors","quotaTransactions","quotaAttachments","quotaWarnings"]},E=t=>t in I?null:{type:t};class C extends g.Z{constructor(){super(...arguments),(0,h.Z)(this,"getStateToPutForProvider",(t=>{const{notificationType:e}=this.props,{notificationSettings:i}=this.state,n=(0,Z.E2)(e,i,t);return this.setState({notificationSettings:(0,Z.r_)(i,n)}),n})),(0,h.Z)(this,"getStateToPutForDependentSetting",((t,e)=>{const i=t[e],{notificationSettings:n}=this.state,s={[e]:{user:{me:v.rn.reduce(((t,e)=>(t[e]=i,t)),{})}}};return this.setState({notificationSettings:(0,Z.r_)(n,s)}),s})),(0,h.Z)(this,"getStateToPutForDefault",(t=>{const{notificationType:e}=this.props,{notificationSettings:i}=this.state,n=(0,Z.zD)(e,i,t,(0,Z.Vy)(e,i));return this.setState({notificationSettings:(0,Z.r_)(i,n)}),n})),(0,h.Z)(this,"getStateToPutForParent",((t,e)=>{const{notificationType:i}=this.props,{notificationSettings:n}=this.state,s=(0,Z.O0)(i,n,t,e);return this.setState({notificationSettings:(0,Z.r_)(n,s)}),s})),(0,h.Z)(this,"getUnlinkedOrgs",(()=>{const{organizations:t}=this.props,{identities:e,organizationIntegrations:i}=this.state,n=Object.fromEntries(i.map((t=>[t.organizationId,t.externalId]))),s=Object.fromEntries(e.map((t=>{var e;return[null==t||null===(e=t.identityProvider)||void 0===e?void 0:e.externalId,t]})));return t.filter((t=>{const e=n[t.id];return null==s[e]}))}))}getDefaultState(){return{...super.getDefaultState(),notificationSettings:{},identities:[],organizationIntegrations:[]}}getEndpoints(){const{notificationType:t}=this.props;return[["notificationSettings","/users/me/notification-settings/",{query:E(t)}],["identities","/users/me/identities/",{query:{provider:"slack"}}],["organizationIntegrations","/users/me/organization-integrations/",{query:{provider:"slack"}}]]}componentDidMount(){(0,y.Z)("notification_settings.tuning_page_viewed",{organization:null,notification_type:this.props.notificationType})}trackTuningUpdated(t){(0,y.Z)("notification_settings.updated_tuning_setting",{organization:null,notification_type:this.props.notificationType,tuning_field_type:t})}getInitialData(){const{notificationType:t}=this.props,{notificationSettings:e}=this.state,i=(0,Z.iy)(t,e)?["email"]:(0,Z.xy)(t,e),n=I[t]||[],s=Object.fromEntries(n.map((t=>[t,(0,Z.hx)(t,e)])));return{[t]:(0,Z.hx)(t,e),provider:i,...s}}getFields(){const{notificationType:t}=this.props,{notificationSettings:e}=this.state,i=(0,Z.yB)(t)?(0,u.t)("This is the default for all projects."):(0,u.t)("This is the default for all organizations."),n=Object.assign({},b.u[t],{help:i,getData:t=>this.getStateToPutForDefault(t)});(0,Z.Vi)(t,e)&&(n.confirm={never:v.Y5});const s=[n];return(0,Z.iy)(t,e)||s.push(Object.assign({help:(0,u.t)("Where personal notifications will be sent."),getData:t=>this.getStateToPutForProvider(t)},b.u.provider)),"quota"!==t||(0,Z.iy)(t,e)||s.push(...b.i.map((t=>({...t,type:"select",getData:e=>this.getStateToPutForDependentSetting(e,t.name)})))),s}renderBody(){const{notificationType:t}=this.props,{notificationSettings:e}=this.state,i=(0,Z.xy)(t,e).includes("slack"),n=this.getUnlinkedOrgs(),{title:r,description:l}=f[t];return(0,w.BX)(s.Fragment,{children:[(0,w.tZ)(F.Z,{title:r}),l&&(0,w.tZ)(A.Z,{children:l}),i&&n.length>0&&(0,w.tZ)(z,{organizations:n}),(0,w.tZ)(o.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:this.getInitialData(),onSubmitSuccess:()=>this.trackTuningUpdated("general"),children:(0,w.tZ)(a.Z,{title:(0,Z.yB)(t)?(0,u.t)("All Projects"):(0,u.t)("All Organizations"),fields:this.getFields()})}),!(0,Z.iy)(t,e)&&((0,Z.yB)(t)?(0,w.tZ)(O,{notificationType:t,notificationSettings:e,onChange:this.getStateToPutForParent,onSubmitSuccess:()=>this.trackTuningUpdated("project")}):(0,w.tZ)(j,{notificationType:t,notificationSettings:e,onChange:this.getStateToPutForParent,onSubmitSuccess:()=>this.trackTuningUpdated("organization")}))]})}}const R=(0,d.Z)(C),V=(0,n.Z)(c.N,{target:"euheq541"})("font-size:1rem;&:not(:last-child){border-bottom:1px solid ",(t=>t.theme.innerBorder),";}"),q=t=>{let{projects:e,field:i}=t;const n=(0,Z.uI)(e),{title:o,description:a,...l}=i,p=Object.values(n).map((t=>({name:t.organization.name,projects:t.projects.map((t=>({...l,name:t.id,label:t.slug})))})));return(0,w.tZ)(s.Fragment,{children:p.map((t=>{let{name:e,projects:i}=t;return(0,w.BX)("div",{children:[(0,w.tZ)(c.V9,{children:e}),i.map((t=>(0,w.tZ)(V,{children:(0,w.tZ)(r.Z,{defaultValue:t.defaultValue,name:t.name,options:t.options,label:t.label})},t.name)))]},e)}))})};q.displayName="AccountNotificationsByProject";const M=t=>{let{organizations:e,field:i}=t;const{title:n,description:o,...a}=i,l=e.map((t=>({...a,name:t.id,label:t.slug})));return(0,w.tZ)(s.Fragment,{children:l.map((t=>(0,w.tZ)(V,{children:(0,w.tZ)(r.Z,{defaultValue:t.defaultValue,name:t.name,options:t.options,label:t.label})},t.name)))})};M.displayName="AccountNotificationsByOrganization";const U=(0,d.Z)(M);class X extends m.Z{getEndpoints(){const{fineTuneType:t}=this.props.params,e=[["notifications","/users/me/notifications/"],["fineTuneData",`/users/me/notifications/${t}/`]];return(0,Z.yB)(t)&&e.push(["projects","/projects/"]),e.push(["emails","/users/me/emails/"]),"email"===t&&e.push(["emails","/users/me/emails/"]),e}get emailChoices(){var t,e,i;return null!==(t=null===(e=this.state.emails)||void 0===e||null===(i=e.filter((t=>{let{isVerified:e}=t;return e})))||void 0===i?void 0:i.sort(((t,e)=>t.isPrimary?-1:e.isPrimary?1:t.email<e.email?-1:1)))&&void 0!==t?t:[]}renderBody(){const{params:t}=this.props,{fineTuneType:e}=t;if(["alerts","deploy","workflow","activeRelease","approval","quota"].includes(e))return(0,w.tZ)(R,{notificationType:e});const{notifications:i,projects:n,fineTuneData:s,projectsPageLinks:r}=this.state,d=(0,Z.yB)(e),m=f[e],{title:h,description:g}=m,[y,v]=d?this.getEndpoints()[2]:[],b=!(null==n||!n.length);return"email"===e&&(m.options=this.emailChoices.map((t=>{let{email:e}=t;return{value:e,label:e}}))),i&&s?(0,w.BX)("div",{children:[(0,w.tZ)(F.Z,{title:h}),g&&(0,w.tZ)(A.Z,{children:g}),m&&m.defaultFieldName&&"weeklyReports"!==m.defaultFieldName&&(0,w.tZ)(o.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notifications/",initialData:i,children:(0,w.tZ)(a.Z,{title:`Default ${h}`,fields:[p.fields[m.defaultFieldName]]})}),(0,w.tZ)(c.s_,{children:(0,w.BX)(c.N,{children:[(0,w.BX)(c.V9,{hasButtons:d,children:[(0,w.tZ)(W,{children:d?(0,u.t)("Projects"):(0,u.t)("Organizations")}),(0,w.tZ)("div",{children:d&&this.renderSearchInput({placeholder:(0,u.t)("Search Projects"),url:v,stateKey:y})})]}),(0,w.BX)(o.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:`/users/me/notifications/${e}/`,initialData:s,children:[d&&b&&(0,w.tZ)(q,{projects:n,field:m}),d&&!b&&(0,w.tZ)(N.Z,{children:(0,u.t)("No projects found")}),!d&&(0,w.tZ)(U,{field:m})]})]})}),n&&(0,w.tZ)(l.Z,{pageLinks:r,...this.props})]}):null}}const W=(0,n.Z)("div",{target:"euheq540"})({name:"82a6rk",styles:"flex:1"}),Y=X},"./app/views/settings/components/defaultSearchBar.tsx":(t,e,i)=>{i.d(e,{_:()=>o});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=i("./app/styles/space.tsx");const o=(0,n.Z)("div",{target:"e1pq3sjx0"})("display:flex;grid-template-columns:1fr max-content;gap:",(0,s.Z)(1.5),";margin-top:",(0,s.Z)(4),";margin-bottom:",(0,s.Z)(1.5),";position:relative;")}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_accountNotificationFineTuning_tsx.47057bfea846ec5385f2c40ef84caa4c.js.map