"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_versionHoverCard_tsx"],{"./app/actionCreators/release.tsx":(e,t,s)=>{s.d(t,{VE:()=>c,aQ:()=>h,dF:()=>p,o7:()=>d});var o=s("../node_modules/@sentry/hub/esm/exports.js"),r=s("./app/actionCreators/indicator.tsx"),i=s("./app/actions/releaseActions.tsx"),a=s("./app/locale.tsx"),n=s("./app/stores/releaseStore.tsx"),l=s("./app/types/index.tsx");function d(e,t){const{orgSlug:s,projectSlug:r,releaseVersion:a}=t,l=`/projects/${s}/${r}/releases/${encodeURIComponent(a)}/`;return n.Z.state.releaseLoading[(0,n.p)(r,a)]=!0,i.Z.loadRelease(s,r,a),e.requestPromise(l,{method:"GET"}).then((e=>{i.Z.loadReleaseSuccess(r,a,e)})).catch((e=>{404!==e.status?(i.Z.loadReleaseError(r,a,e),o.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getRelease-action-creator"]),o.Tb(e)}))):i.Z.loadReleaseSuccess(r,a,null)}))}function p(e,t){const{orgSlug:s,projectSlug:r,releaseVersion:a}=t,l=`/organizations/${s}/releases/${encodeURIComponent(a)}/deploys/`;return n.Z.state.deploysLoading[(0,n.p)(r,a)]=!0,i.Z.loadDeploys(s,r,a),e.requestPromise(l,{method:"GET"}).then((e=>{i.Z.loadDeploysSuccess(r,a,e)})).catch((e=>{404!==e.status?(i.Z.loadDeploysError(r,a,e),o.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getReleaseDeploys-action-creator"]),o.Tb(e)}))):i.Z.loadDeploysSuccess(r,a,null)}))}function c(e,t){const{orgSlug:s,projectSlug:o,releaseVersion:n}=t;return i.Z.loadRelease(s,o,n),(0,r.E3)((0,a.t)("Archiving Release…")),e.requestPromise(`/organizations/${s}/releases/`,{method:"POST",data:{status:l.dE.Archived,projects:[],version:n}}).then((e=>{i.Z.loadReleaseSuccess(o,n,e),(0,r.S9)((0,a.t)("Release was successfully archived."))})).catch((e=>{var t,s;throw i.Z.loadReleaseError(o,n,e),(0,r.Iw)(null!==(t=null===(s=e.responseJSON)||void 0===s?void 0:s.detail)&&void 0!==t?t:(0,a.t)("Release could not be be archived.")),e}))}function h(e,t){const{orgSlug:s,projectSlug:o,releaseVersion:n}=t;return i.Z.loadRelease(s,o,n),(0,r.E3)((0,a.t)("Restoring Release…")),e.requestPromise(`/organizations/${s}/releases/`,{method:"POST",data:{status:l.dE.Active,projects:[],version:n}}).then((e=>{i.Z.loadReleaseSuccess(o,n,e),(0,r.S9)((0,a.t)("Release was successfully restored."))})).catch((e=>{var t,s;throw i.Z.loadReleaseError(o,n,e),(0,r.Iw)(null!==(t=null===(s=e.responseJSON)||void 0===s?void 0:s.detail)&&void 0!==t?t:(0,a.t)("Release could not be be restored.")),e}))}},"./app/actions/releaseActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});const o=(0,s("../node_modules/reflux/src/index.js").createActions)(["loadRelease","loadReleaseError","loadReleaseSuccess","loadDeploys","loadDeploysError","loadDeploysSuccess"])},"./app/actions/repositoryActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});const o=(0,s("../node_modules/reflux/src/index.js").createActions)(["resetRepositories","loadRepositories","loadRepositoriesError","loadRepositoriesSuccess"])},"./app/components/avatar/avatarList.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/react/index.js"),a=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),n=s("./app/components/avatar/userAvatar.tsx"),l=s("./app/components/tooltip.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class p extends i.Component{render(){const{className:e,users:t,avatarSize:s,maxVisibleAvatars:o,renderTooltip:r,typeMembers:i,tooltipOptions:a}=this.props,n=t.slice(0,o),p=t.length-n.length;return a.position||(a.position="top"),(0,d.BX)(c,{className:e,children:[!!p&&(0,d.tZ)(l.Z,{title:`${p} other ${i}`,children:(0,d.BX)(g,{size:s,"data-test-id":"avatarList-collapsedusers",children:[p<99&&(0,d.tZ)(m,{children:"+"}),p]})}),n.map((e=>(0,d.tZ)(u,{user:e,size:s,renderTooltip:r,tooltipOptions:a,hasTooltip:!0},`${e.id}-${e.email}`)))]})}}p.displayName="AvatarList",(0,o.Z)(p,"defaultProps",{avatarSize:28,maxVisibleAvatars:5,typeMembers:"users",tooltipOptions:{}});const c=(0,r.Z)("div",{target:"e7y2scs3"})({name:"4hray5",styles:"display:flex;flex-direction:row-reverse"}),h=e=>(0,a.iv)("border-radius:50%;border:2px solid ",e.theme.background,";margin-left:-8px;cursor:default;&:hover{z-index:1;}",""),u=(0,r.Z)(n.Z,{target:"e7y2scs2"})("overflow:hidden;",h,";"),g=(0,r.Z)("div",{target:"e7y2scs1"})("display:flex;align-items:center;justify-content:center;position:relative;text-align:center;font-weight:600;background-color:",(e=>e.theme.gray200),";color:",(e=>e.theme.gray300),";font-size:",(e=>Math.floor(e.size/2.3)),"px;width:",(e=>e.size),"px;height:",(e=>e.size),"px;",h,";"),m=(0,r.Z)("span",{target:"e7y2scs0"})({name:"1enq4bv",styles:"font-size:10px;margin-left:1px;margin-right:-1px"})},"./app/components/versionHoverCard.tsx":(e,t,s)=>{s.d(t,{Z:()=>A});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("./app/components/avatar/avatarList.tsx"),n=s("./app/components/button.tsx"),l=s("./app/components/clipboard.tsx"),d=s("./app/components/hovercard.tsx"),p=s("./app/components/avatar/userAvatar.tsx"),c=s("./app/components/timeSince.tsx"),h=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m={id:"",name:"",username:"??",email:"",avatarUrl:"",avatar:{avatarUuid:"",avatarType:"letter_avatar"},ip_address:""};function v(e){let{commit:t,className:s}=e;const o=null==t?void 0:t.author;return(0,g.BX)("div",{className:s,children:[(0,g.tZ)("h6",{children:"Last commit"}),(0,g.BX)(Z,{children:[(0,g.tZ)(p.Z,{user:o||m}),(0,g.BX)("div",{children:[(0,g.tZ)(x,{children:function(e){if(!e)return(0,h.t)("No message provided");const t=e.split(/\n/)[0];if(t.length>100){let e=t.substr(0,90);const s=e.split(/ /);return s.length>1&&(s.pop(),e=s.join(" ")),`${e}…`}return t}(t.message)}),(0,g.BX)(b,{children:[(0,g.tZ)("strong",{children:(null==o?void 0:o.name)||(0,h.t)("Unknown Author")})," ",(0,g.tZ)(c.Z,{date:t.dateCreated})]})]})]})]})}v.displayName="LastCommit";const y=v,Z=(0,r.Z)("div",{target:"e1dtiphv2"})("display:grid;grid-template-columns:max-content minmax(0, 1fr);gap:",(0,u.Z)(1),";margin-top:",(0,u.Z)(1),";"),x=(0,r.Z)("div",{target:"e1dtiphv1"})((e=>e.theme.overflowEllipsis)," margin-bottom:",(0,u.Z)(.5),";"),b=(0,r.Z)("div",{target:"e1dtiphv0"})("font-size:",(e=>e.theme.fontSizeSmall),";color:",(e=>e.theme.subText),";");var S=s("./app/components/loadingError.tsx"),f=s("./app/components/loadingIndicator.tsx");const j=(0,r.Z)("span",{target:"eut5h770"})("font-weight:700;color:",(e=>e.theme.white),";text-align:center;white-space:nowrap;border-radius:0.25em;",(e=>e.theme.overflowEllipsis),";display:inline-block;vertical-align:text-bottom;line-height:1;background:",(e=>e.theme.gray200),";padding:3px;max-width:86px;font-size:",(e=>e.theme.fontSizeSmall),";");var R=s("./app/components/version.tsx"),w=s("./app/icons/index.tsx"),E=s("./app/utils.tsx"),L=s("./app/utils/withApi.tsx"),z=s("./app/actionCreators/release.tsx"),_=s("./app/stores/releaseStore.tsx"),C=s("./app/utils/getDisplayName.tsx");var $=s("./app/utils/withRepositories.tsx");class N extends i.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",{visible:!1})}toggleHovercard(){this.setState({visible:!0})}getRepoLink(){const{organization:e}=this.props,t=e.slug;return{header:null,body:(0,g.BX)(B,{children:[(0,g.tZ)("h5",{children:(0,h.t)("Releases are better with commit data!")}),(0,g.tZ)("p",{children:(0,h.t)("Connect a repository to see commit info, files changed, and authors involved in future releases.")}),(0,g.tZ)(n.ZP,{href:`/organizations/${t}/repos/`,priority:"primary",children:(0,h.t)("Connect a repository")})]})}}getBody(){const{releaseVersion:e,release:t,deploys:s}=this.props;if(void 0===t||!(0,E.ri)(s))return{header:null,body:null};const{lastCommit:o}=t,r=s.reduce((function(e,t){const{dateFinished:s,environment:o}=t;return e.hasOwnProperty(o)||(e[o]=s),e}),{});let i=Object.keys(r);return Object.keys(r).length>3&&(i=Object.keys(r).slice(0,3)),{header:(0,g.BX)(k,{children:[(0,h.t)("Release"),(0,g.BX)(T,{children:[(0,g.tZ)(X,{version:e,truncate:!0,anchor:!1}),(0,g.tZ)(l.Z,{value:e,children:(0,g.tZ)(V,{children:(0,g.tZ)(w.vU,{size:"xs"})})})]})]}),body:(0,g.BX)("div",{children:[(0,g.BX)("div",{className:"row",children:[(0,g.BX)("div",{className:"col-xs-4",children:[(0,g.tZ)("h6",{children:(0,h.t)("New Issues")}),(0,g.tZ)(O,{children:t.newGroups})]}),(0,g.BX)("div",{className:"col-xs-8",children:[(0,g.BX)("h6",{style:{textAlign:"right"},children:[t.commitCount," ",1!==t.commitCount?(0,h.t)("commits "):(0,h.t)("commit ")," ",(0,h.t)("by ")," ",t.authors.length," ",1!==t.authors.length?(0,h.t)("authors"):(0,h.t)("author")," "]}),(0,g.tZ)(a.Z,{users:t.authors,avatarSize:25,tooltipOptions:{container:"body"},typeMembers:"authors"})]})]}),o&&(0,g.tZ)(P,{commit:o}),s.length>0&&(0,g.BX)("div",{children:[(0,g.tZ)(d.iz,{children:(0,g.tZ)("h6",{children:(0,h.t)("Deploys")})}),i.map(((e,t)=>{const s=r[e];return(0,g.BX)(U,{children:[(0,g.tZ)(D,{children:e}),s&&(0,g.tZ)(M,{date:s})]},t)}))]})]})}}render(){var e;const{deploysLoading:t,deploysError:s,release:o,releaseLoading:r,releaseError:i,repositories:a,repositoriesLoading:n,repositoriesError:l}=this.props;let p=null,c=null;const h=!!(t||r||n),u=null!==(e=null!=s?s:i)&&void 0!==e?e:l,m=a&&a.length>0;if(h)c=(0,g.tZ)(f.Z,{mini:!0});else if(u)c=(0,g.tZ)(S.Z,{});else{const e=m&&o?this.getBody():this.getRepoLink();p=e.header,c=e.body}return(0,g.tZ)(d.uI,{...this.props,header:p,body:c,children:this.props.children})}}N.displayName="VersionHoverCard";const A=(0,L.Z)(function(e){class t extends i.Component{constructor(e,t){super(e,t),(0,o.Z)(this,"unsubscribe",_.Z.listen((()=>this.onStoreUpdate()),void 0));const{projectSlug:s,releaseVersion:r}=this.props,i=_.Z.get(s,r);this.state={...i}}componentDidMount(){this.fetchRelease(),this.fetchDeploys()}componentWillUnmount(){this.unsubscribe()}fetchRelease(){const{api:e,organization:t,projectSlug:s,releaseVersion:o}=this.props,r=_.Z.get(s,o),i=t.slug;(!r.release&&!r.releaseLoading||r.releaseError)&&(0,z.o7)(e,{orgSlug:i,projectSlug:s,releaseVersion:o})}fetchDeploys(){const{api:e,organization:t,projectSlug:s,releaseVersion:o}=this.props,r=_.Z.get(s,o),i=t.slug;(!r.deploys&&!r.deploysLoading||r.deploysError)&&(0,z.dF)(e,{orgSlug:i,projectSlug:s,releaseVersion:o})}onStoreUpdate(){const{projectSlug:e,releaseVersion:t}=this.props,s=_.Z.get(e,t);this.setState({...s})}render(){return(0,g.tZ)(e,{...this.props,...this.state})}}return t.displayName="WithRelease",(0,o.Z)(t,"displayName",`withRelease(${(0,C.Z)(e)})`),t}((0,$.Z)(N))),B=(0,r.Z)("div",{target:"ejgji4u9"})("padding:",(0,u.Z)(2),";text-align:center;"),D=(0,r.Z)(j,{target:"ejgji4u8"})({name:"1uxsuq0",styles:"width:86px"}),M=(0,r.Z)(c.Z,{target:"ejgji4u7"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeSmall),";"),k=(0,r.Z)("div",{target:"ejgji4u6"})({name:"bcffy2",styles:"display:flex;align-items:center;justify-content:space-between"}),T=(0,r.Z)("div",{target:"ejgji4u5"})({name:"8nnmo9",styles:"display:flex;flex:1;align-items:center;justify-content:flex-end"}),X=(0,r.Z)(R.Z,{target:"ejgji4u4"})("margin-right:",(0,u.Z)(.5),";max-width:190px;"),V=(0,r.Z)("span",{target:"ejgji4u3"})({name:"1p3qk0r",styles:"&:hover{cursor:pointer;}"}),O=(0,r.Z)("div",{target:"ejgji4u2"})("color:",(e=>e.theme.headingColor),";font-size:",(e=>e.theme.headerFontSize),";"),P=(0,r.Z)(y,{target:"ejgji4u1"})("margin-top:",(0,u.Z)(2),";"),U=(0,r.Z)("div",{target:"ejgji4u0"})("display:grid;grid-template-columns:max-content minmax(0, 1fr);gap:",(0,u.Z)(1),";justify-items:start;align-items:center;")},"./app/stores/releaseStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>d,p:()=>n}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/reflux/src/index.js"),r=s("./app/actions/organizationActions.tsx"),i=s("./app/actions/releaseActions.tsx"),a=s("./app/utils/makeSafeRefluxStore.ts");const n=(e,t)=>`${e}${t}`,l={state:{orgSlug:void 0,release:new Map,releaseLoading:new Map,releaseError:new Map,deploys:new Map,deploysLoading:new Map,deploysError:new Map},listenables:i.Z,unsubscribeListeners:[],init(){this.unsubscribeListeners.push(this.listenTo(r.Z.update,this.updateOrganization)),this.reset()},reset(){this.state={orgSlug:void 0,release:new Map,releaseLoading:new Map,releaseError:new Map,deploys:new Map,deploysLoading:new Map,deploysError:new Map},this.trigger(this.state)},updateOrganization(e){this.reset(),this.state.orgSlug=e.slug,this.trigger(this.state)},loadRelease(e,t,s){this.orgSlug&&this.orgSlug===e||(this.reset(),this.orgSlug=e);const o=n(t,s),{releaseLoading:r,releaseError:i,...a}=this.state;this.state={...a,releaseLoading:{...r,[o]:!0},releaseError:{...i,[o]:void 0}},this.trigger(this.state)},loadReleaseError(e,t,s){const o=n(e,t),{releaseLoading:r,releaseError:i,...a}=this.state;this.state={...a,releaseLoading:{...r,[o]:!1},releaseError:{...i,[o]:s}},this.trigger(this.state)},loadReleaseSuccess(e,t,s){const o=n(e,t),{release:r,releaseLoading:i,releaseError:a,...l}=this.state;this.state={...l,release:{...r,[o]:s},releaseLoading:{...i,[o]:!1},releaseError:{...a,[o]:void 0}},this.trigger(this.state)},loadDeploys(e,t,s){this.orgSlug&&this.orgSlug===e||(this.reset(),this.orgSlug=e);const o=n(t,s),{deploysLoading:r,deploysError:i,...a}=this.state;this.state={...a,deploysLoading:{...r,[o]:!0},deploysError:{...i,[o]:void 0}},this.trigger(this.state)},loadDeploysError(e,t,s){const o=n(e,t),{deploysLoading:r,deploysError:i,...a}=this.state;this.state={...a,deploysLoading:{...r,[o]:!1},deploysError:{...i,[o]:s}},this.trigger(this.state)},loadDeploysSuccess(e,t,s){const o=n(e,t),{deploys:r,deploysLoading:i,deploysError:a,...l}=this.state;this.state={...l,deploys:{...r,[o]:s},deploysLoading:{...i,[o]:!1},deploysError:{...a,[o]:void 0}},this.trigger(this.state)},get(e,t){const s=n(e,t);return{release:this.state.release[s],releaseLoading:this.state.releaseLoading[s],releaseError:this.state.releaseError[s],deploys:this.state.deploys[s],deploysLoading:this.state.deploysLoading[s],deploysError:this.state.deploysError[s]}}},d=(0,o.createStore)((0,a.Y)(l))},"./app/utils/withRepositories.tsx":(e,t,s)=>{s.d(t,{Z:()=>g});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/react/index.js"),i=s("../node_modules/@sentry/hub/esm/exports.js"),a=s("./app/actions/repositoryActions.tsx"),n=s("../node_modules/reflux/src/index.js"),l=s("./app/utils/makeSafeRefluxStore.ts");const d={listenables:a.Z,state:{orgSlug:void 0,repositories:void 0,repositoriesLoading:void 0,repositoriesError:void 0},init(){this.resetRepositories()},resetRepositories(){this.state={orgSlug:void 0,repositories:void 0,repositoriesLoading:void 0,repositoriesError:void 0},this.trigger(this.state)},loadRepositories(e){this.state={orgSlug:e,repositories:e===this.state.orgSlug?this.state.repositories:void 0,repositoriesLoading:!0,repositoriesError:void 0},this.trigger(this.state)},loadRepositoriesError(e){this.state={...this.state,repositories:void 0,repositoriesLoading:!1,repositoriesError:e},this.trigger(this.state)},loadRepositoriesSuccess(e){this.state={...this.state,repositories:e,repositoriesLoading:!1,repositoriesError:void 0},this.trigger(this.state)},get(){return{...this.state}}},p=(0,n.createStore)((0,l.Y)(d));var c=s("./app/utils/getDisplayName.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u={repositories:void 0,repositoriesLoading:void 0,repositoriesError:void 0},g=function(e){class t extends r.Component{constructor(e,t){super(e,t),(0,o.Z)(this,"unsubscribe",p.listen((()=>this.onStoreUpdate()),void 0));const{organization:s}=this.props,r=s.slug,i=p.get();i.orgSlug!==r&&a.Z.resetRepositories(),this.state=i.orgSlug===r?{...u,...i}:{...u}}componentDidMount(){this.fetchRepositories()}componentWillUnmount(){this.unsubscribe()}fetchRepositories(){const{api:e,organization:t}=this.props,s=t.slug,o=p.get();(!o.repositories&&!o.repositoriesLoading||o.repositoriesError)&&function(e,t){const{orgSlug:s}=t,o=`/organizations/${s}/repos/`;p.state.repositoriesLoading=!0,a.Z.loadRepositories(s),e.requestPromise(o,{method:"GET"}).then((e=>{a.Z.loadRepositoriesSuccess(e)})).catch((e=>{a.Z.loadRepositoriesError(e),i.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getRepositories-action-creator"]),i.Tb(e)}))}))}(e,{orgSlug:s})}onStoreUpdate(){const e=p.get();this.setState({...e})}render(){return(0,h.tZ)(e,{...this.props,...this.state})}}return t.displayName="WithRepositories",(0,o.Z)(t,"displayName",`withRepositories(${(0,c.Z)(e)})`),t}}}]);
//# sourceMappingURL=../sourcemaps/app_components_versionHoverCard_tsx.f594727c76cad071c0f157e05f890afb.js.map