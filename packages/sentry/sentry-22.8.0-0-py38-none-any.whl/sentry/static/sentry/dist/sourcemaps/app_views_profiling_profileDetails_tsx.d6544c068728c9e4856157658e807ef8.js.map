{"version":3,"file":"chunks/app_views_profiling_profileDetails_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/gridEditable/sortLink.tsx","webpack:///./app/utils/profiling/tableRenderer.tsx","webpack:///./app/utils/profiling/units/units.ts","webpack:///./app/utils/useEffectAfterFirstRender.ts","webpack:///./app/views/profiling/profileDetails.tsx"],"sourcesContent":["import styled from '@emotion/styled';\nimport {LocationDescriptorObject} from 'history';\nimport omit from 'lodash/omit';\n\nimport Link from 'sentry/components/links/link';\nimport {IconArrow} from 'sentry/icons';\n\nexport type Alignments = 'left' | 'right' | undefined;\nexport type Directions = 'desc' | 'asc' | undefined;\n\ntype Props = {\n  align: Alignments;\n  canSort: boolean;\n  direction: Directions;\n  generateSortLink: () => LocationDescriptorObject | undefined;\n\n  title: React.ReactNode;\n  onClick?: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n};\n\nfunction SortLink({align, title, canSort, generateSortLink, onClick, direction}: Props) {\n  const target = generateSortLink();\n\n  if (!target || !canSort) {\n    return <StyledNonLink align={align}>{title}</StyledNonLink>;\n  }\n\n  const arrow = !direction ? null : (\n    <StyledIconArrow size=\"xs\" direction={direction === 'desc' ? 'down' : 'up'} />\n  );\n\n  return (\n    <StyledLink align={align} to={target} onClick={onClick}>\n      {title} {arrow}\n    </StyledLink>\n  );\n}\n\ntype LinkProps = React.ComponentPropsWithoutRef<typeof Link>;\ntype StyledLinkProps = LinkProps & {align: Alignments};\n\nconst StyledLink = styled((props: StyledLinkProps) => {\n  const forwardProps = omit(props, ['align']);\n  return <Link {...forwardProps} />;\n})`\n  display: block;\n  width: 100%;\n  white-space: nowrap;\n  color: inherit;\n\n  &:hover,\n  &:active,\n  &:focus,\n  &:visited {\n    color: inherit;\n  }\n\n  ${(p: StyledLinkProps) => (p.align ? `text-align: ${p.align};` : '')}\n`;\n\nconst StyledNonLink = styled('div')<{align: Alignments}>`\n  display: block;\n  width: 100%;\n  white-space: nowrap;\n  ${(p: {align: Alignments}) => (p.align ? `text-align: ${p.align};` : '')}\n`;\n\nconst StyledIconArrow = styled(IconArrow)`\n  vertical-align: top;\n`;\n\nexport default SortLink;\n","import {LocationDescriptorObject} from 'history';\n\nimport {GridColumnOrder} from 'sentry/components/gridEditable';\nimport SortLink from 'sentry/components/gridEditable/sortLink';\n\ntype Sort<K> = {\n  column: K;\n  direction: 'asc' | 'desc';\n};\n\ninterface TableHeadProps<K> {\n  currentSort?: Sort<K>;\n  generateSortLink?: (column: K) => () => LocationDescriptorObject | undefined;\n  rightAlignedColumns?: Set<K>;\n  sortableColumns?: Set<K>;\n}\n\nexport function renderTableHead<K>({\n  currentSort,\n  generateSortLink,\n  rightAlignedColumns,\n  sortableColumns,\n}: TableHeadProps<K>) {\n  return (column: GridColumnOrder<K>, _columnIndex: number) => {\n    return (\n      <SortLink\n        align={rightAlignedColumns?.has(column.key) ? 'right' : 'left'}\n        title={column.name}\n        direction={\n          currentSort?.column === column.key ? currentSort?.direction : undefined\n        }\n        canSort={sortableColumns?.has(column.key) || false}\n        generateSortLink={generateSortLink?.(column.key) ?? (() => undefined)}\n      />\n    );\n  };\n}\n","export function relativeChange(final: number, initial: number): number {\n  return (final - initial) / initial;\n}\n\ntype Unit = 'nanoseconds' | 'microseconds' | 'milliseconds' | 'seconds';\n\nconst durationMappings: Record<Unit, number> = {\n  nanoseconds: 1e-9,\n  microseconds: 1e-6,\n  milliseconds: 1e-3,\n  seconds: 1,\n};\n\nconst format = (v: number, abbrev: string, precision: number) => {\n  return v.toFixed(precision) + abbrev;\n};\n\nexport function makeFormatter(from: Unit | string): (value: number) => string {\n  const multiplier = durationMappings[from];\n\n  if (multiplier === undefined) {\n    throw new Error(`Cannot format from unit ${from}, duration mapping is not defined`);\n  }\n\n  return (value: number) => {\n    const duration = value * multiplier;\n\n    if (duration >= 1) {\n      return format(duration, 's', 2);\n    }\n    if (duration / 1e-3 >= 1) {\n      return format(duration / 1e-3, 'ms', 2);\n    }\n    if (duration / 1e-6 >= 1) {\n      return format(duration / 1e-6, 'Î¼s', 2);\n    }\n    return format(duration / 1e-9, 'ns', 2);\n  };\n}\n\nfunction pad(n: number, slots: number) {\n  return Math.floor(n).toString().padStart(slots, '0');\n}\n\nexport function makeTimelineFormatter(from: Unit | string) {\n  const multiplier = durationMappings[from];\n\n  if (multiplier === undefined) {\n    throw new Error(`Cannot format from unit ${from}, duration mapping is not defined`);\n  }\n\n  return (value: number) => {\n    const s = value * multiplier;\n    const m = s / 60;\n    const ms = s * 1e3;\n\n    return `${pad(m, 2)}:${pad(s % 60, 2)}.${pad(ms % 1e3, 3)}`;\n  };\n}\n","import {useEffect, useRef} from 'react';\n\nconst useEffectAfterFirstRender = (\n  cb: React.EffectCallback,\n  deps: React.DependencyList\n): void => {\n  const firstRender = useRef<boolean>(true);\n\n  useEffect(() => {\n    if (firstRender.current) {\n      firstRender.current = false;\n      return;\n    }\n\n    cb();\n    // Dependencies are explicitly managed and the deps warning is enabled for the custom hook.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n};\n\nexport {useEffectAfterFirstRender};\n","import {Fragment, useCallback, useEffect, useMemo, useState} from 'react';\nimport {browserHistory, Link} from 'react-router';\nimport styled from '@emotion/styled';\nimport Fuse from 'fuse.js';\nimport * as qs from 'query-string';\n\nimport GridEditable, {\n  COL_WIDTH_UNDEFINED,\n  GridColumnOrder,\n} from 'sentry/components/gridEditable';\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport Pagination from 'sentry/components/pagination';\nimport SearchBar from 'sentry/components/searchBar';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport trackAdvancedAnalyticsEvent from 'sentry/utils/analytics/trackAdvancedAnalyticsEvent';\nimport {Container, NumberContainer} from 'sentry/utils/discover/styles';\nimport {CallTreeNode} from 'sentry/utils/profiling/callTreeNode';\nimport {Profile} from 'sentry/utils/profiling/profile/profile';\nimport {generateProfileFlamechartRouteWithQuery} from 'sentry/utils/profiling/routes';\nimport {renderTableHead} from 'sentry/utils/profiling/tableRenderer';\nimport {makeFormatter} from 'sentry/utils/profiling/units/units';\nimport {decodeScalar} from 'sentry/utils/queryString';\nimport {useEffectAfterFirstRender} from 'sentry/utils/useEffectAfterFirstRender';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport useOrganization from 'sentry/utils/useOrganization';\nimport {useParams} from 'sentry/utils/useParams';\n\nimport {useProfileGroup} from './profileGroupProvider';\n\nfunction collectTopProfileFrames(profile: Profile) {\n  const nodes: CallTreeNode[] = [];\n\n  profile.forEach(\n    node => {\n      if (node.selfWeight > 0) {\n        nodes.push(node);\n      }\n    },\n    () => {}\n  );\n\n  return (\n    nodes\n      .sort((a, b) => b.selfWeight - a.selfWeight)\n      // take only the slowest nodes from each thread because the rest\n      // aren't useful to display\n      .slice(0, 500)\n      .map(node => ({\n        symbol: node.frame.name,\n        image: node.frame.image,\n        thread: profile.threadId,\n        type: node.frame.is_application ? 'application' : 'system',\n        'self weight': node.selfWeight,\n        'total weight': node.totalWeight,\n      }))\n  );\n}\n\nconst RESULTS_PER_PAGE = 50;\n\nfunction ProfileDetails() {\n  const location = useLocation();\n  const [state] = useProfileGroup();\n  const organization = useOrganization();\n\n  useEffect(() => {\n    trackAdvancedAnalyticsEvent('profiling_views.profile_summary', {\n      organization,\n    });\n  }, [organization]);\n\n  const cursor = useMemo<number>(() => {\n    const cursorQuery = decodeScalar(location.query.cursor, '');\n    return parseInt(cursorQuery, 10) || 0;\n  }, [location.query.cursor]);\n\n  const query = useMemo<string>(() => decodeScalar(location.query.query, ''), [location]);\n\n  const allFunctions: TableDataRow[] = useMemo(() => {\n    return state.type === 'resolved'\n      ? state.data.profiles\n          .flatMap(collectTopProfileFrames)\n          // Self weight desc sort\n          .sort((a, b) => b['self weight'] - a['self weight'])\n      : [];\n  }, [state]);\n\n  const searchIndex = useMemo(() => {\n    return new Fuse(allFunctions, {\n      keys: ['symbol'],\n      threshold: 0.3,\n    });\n  }, [allFunctions]);\n\n  const search = useCallback(\n    (queryString: string) => {\n      if (!queryString) {\n        return allFunctions;\n      }\n      return searchIndex\n        .search(queryString)\n        .map(result => result.item)\n        .sort((a, b) => b['self weight'] - a['self weight']);\n    },\n    [searchIndex, allFunctions]\n  );\n\n  const [slowestFunctions, setSlowestFunctions] = useState<TableDataRow[]>(() => {\n    return search(query);\n  });\n\n  useEffectAfterFirstRender(() => {\n    setSlowestFunctions(search(query));\n  }, [allFunctions, query, search]);\n\n  const pageLinks = useMemo(() => {\n    const prevResults = cursor >= RESULTS_PER_PAGE ? 'true' : 'false';\n    const prevCursor = cursor >= RESULTS_PER_PAGE ? cursor - RESULTS_PER_PAGE : 0;\n    const prevQuery = {...location.query, cursor: prevCursor};\n    const prevHref = `${location.pathname}${qs.stringify(prevQuery)}`;\n    const prev = `<${prevHref}>; rel=\"previous\"; results=\"${prevResults}\"; cursor=\"${prevCursor}\"`;\n\n    const nextResults =\n      cursor + RESULTS_PER_PAGE < slowestFunctions.length ? 'true' : 'false';\n    const nextCursor =\n      cursor + RESULTS_PER_PAGE < slowestFunctions.length ? cursor + RESULTS_PER_PAGE : 0;\n    const nextQuery = {...location.query, cursor: nextCursor};\n    const nextHref = `${location.pathname}${qs.stringify(nextQuery)}`;\n    const next = `<${nextHref}>; rel=\"next\"; results=\"${nextResults}\"; cursor=\"${nextCursor}\"`;\n\n    return `${prev},${next}`;\n  }, [cursor, location, slowestFunctions]);\n\n  const handleSearch = useCallback(\n    searchString => {\n      browserHistory.replace({\n        ...location,\n        query: {\n          ...location.query,\n          query: searchString,\n          cursor: undefined,\n        },\n      });\n\n      setSlowestFunctions(search(searchString));\n    },\n    [location, search]\n  );\n\n  return (\n    <Fragment>\n      <SentryDocumentTitle\n        title={t('Profiling \\u2014 Details')}\n        orgSlug={organization.slug}\n      >\n        <Layout.Body>\n          <Layout.Main fullWidth>\n            <ActionBar>\n              <SearchBar\n                defaultQuery=\"\"\n                query={query}\n                placeholder={t('Search for frames')}\n                onChange={handleSearch}\n              />\n            </ActionBar>\n            <GridEditable\n              title={t('Slowest Functions')}\n              isLoading={state.type === 'loading'}\n              error={state.type === 'errored'}\n              data={slowestFunctions.slice(cursor, cursor + RESULTS_PER_PAGE)}\n              columnOrder={COLUMN_ORDER.map(key => COLUMNS[key])}\n              columnSortBy={[]}\n              grid={{\n                renderHeadCell: renderTableHead({\n                  rightAlignedColumns: RIGHT_ALIGNED_COLUMNS,\n                }),\n                renderBodyCell: renderFunctionCell,\n              }}\n              location={location}\n            />\n            <Pagination pageLinks={pageLinks} />\n          </Layout.Main>\n        </Layout.Body>\n      </SentryDocumentTitle>\n    </Fragment>\n  );\n}\n\nconst RIGHT_ALIGNED_COLUMNS = new Set<TableColumnKey>(['self weight', 'total weight']);\n\nconst ActionBar = styled('div')`\n  display: grid;\n  gap: ${space(2)};\n  grid-template-columns: auto;\n  margin-bottom: ${space(2)};\n`;\n\nfunction renderFunctionCell(\n  column: TableColumn,\n  dataRow: TableDataRow,\n  rowIndex: number,\n  columnIndex: number\n) {\n  return (\n    <ProfilingFunctionsTableCell\n      column={column}\n      dataRow={dataRow}\n      rowIndex={rowIndex}\n      columnIndex={columnIndex}\n    />\n  );\n}\n\ninterface ProfilingFunctionsTableCellProps {\n  column: TableColumn;\n  columnIndex: number;\n  dataRow: TableDataRow;\n  rowIndex: number;\n}\n\nconst formatter = makeFormatter('nanoseconds');\nfunction ProfilingFunctionsTableCell({\n  column,\n  dataRow,\n}: ProfilingFunctionsTableCellProps) {\n  const value = dataRow[column.key];\n  const {orgId, projectId, eventId} = useParams();\n\n  switch (column.key) {\n    case 'self weight':\n      return <NumberContainer>{formatter(value)}</NumberContainer>;\n    case 'total weight':\n      return <NumberContainer>{formatter(value)}</NumberContainer>;\n    case 'image':\n      return <Container>{value ?? 'Unknown'}</Container>;\n    case 'thread': {\n      return (\n        <Container>\n          <Link\n            to={generateProfileFlamechartRouteWithQuery({\n              orgSlug: orgId,\n              projectSlug: projectId,\n              profileId: eventId,\n              query: {tid: dataRow.thread},\n            })}\n          >\n            {value}\n          </Link>\n        </Container>\n      );\n    }\n    default:\n      return <Container>{value}</Container>;\n  }\n}\n\ntype TableColumnKey =\n  | 'symbol'\n  | 'image'\n  | 'self weight'\n  | 'total weight'\n  | 'thread'\n  | 'type';\ntype TableDataRow = Record<TableColumnKey, any>;\n\ntype TableColumn = GridColumnOrder<TableColumnKey>;\n\nconst COLUMN_ORDER: TableColumnKey[] = [\n  'symbol',\n  'image',\n  'thread',\n  'type',\n  'self weight',\n  'total weight',\n];\n\n// TODO: looks like these column names change depending on the platform?\nconst COLUMNS: Record<TableColumnKey, TableColumn> = {\n  symbol: {\n    key: 'symbol',\n    name: t('Symbol'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  image: {\n    key: 'image',\n    name: t('Binary'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  thread: {\n    key: 'thread',\n    name: t('Thread'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  type: {\n    key: 'type',\n    name: t('Type'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  'self weight': {\n    key: 'self weight',\n    name: t('Self Weight'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  'total weight': {\n    key: 'total weight',\n    name: t('Total Weight'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n};\n\nexport default ProfileDetails;\n"],"names":["SortLink","align","title","canSort","generateSortLink","onClick","direction","target","StyledNonLink","arrow","StyledIconArrow","size","StyledLink","to","props","forwardProps","omit","p","IconArrow","renderTableHead","currentSort","rightAlignedColumns","sortableColumns","column","_columnIndex","has","key","name","undefined","durationMappings","nanoseconds","microseconds","milliseconds","seconds","format","v","abbrev","precision","toFixed","makeFormatter","from","multiplier","Error","value","duration","pad","n","slots","Math","floor","toString","padStart","makeTimelineFormatter","s","ms","useEffectAfterFirstRender","cb","deps","firstRender","useRef","useEffect","current","collectTopProfileFrames","profile","nodes","forEach","node","selfWeight","push","sort","a","b","slice","map","symbol","frame","image","thread","threadId","type","is_application","totalWeight","RESULTS_PER_PAGE","ProfileDetails","location","useLocation","state","useProfileGroup","organization","useOrganization","trackAdvancedAnalyticsEvent","cursor","useMemo","cursorQuery","decodeScalar","query","parseInt","allFunctions","data","profiles","flatMap","searchIndex","Fuse","keys","threshold","search","useCallback","queryString","result","item","slowestFunctions","setSlowestFunctions","useState","pageLinks","prevResults","prevCursor","prevQuery","prev","pathname","qs","nextResults","length","nextCursor","nextQuery","handleSearch","searchString","browserHistory","Fragment","t","orgSlug","slug","fullWidth","ActionBar","defaultQuery","placeholder","onChange","isLoading","error","columnOrder","COLUMN_ORDER","COLUMNS","columnSortBy","grid","renderHeadCell","RIGHT_ALIGNED_COLUMNS","renderBodyCell","renderFunctionCell","Set","space","dataRow","rowIndex","columnIndex","ProfilingFunctionsTableCell","formatter","orgId","projectId","eventId","useParams","Link","generateProfileFlamechartRouteWithQuery","projectSlug","profileId","tid","width","COL_WIDTH_UNDEFINED"],"sourceRoot":""}