{"version":3,"file":"chunks/app_views_settings_projectPerformance_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/utils/routeTitle.tsx","webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/project/permissionAlert.tsx","webpack:///./app/views/settings/projectPerformance/projectPerformance.tsx","webpack:///./app/views/settings/projectPerformance/index.tsx"],"sourcesContent":["function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import Access from 'sentry/components/acl/access';\nimport Alert from 'sentry/components/alert';\nimport {t} from 'sentry/locale';\n\ntype Props = React.ComponentPropsWithoutRef<typeof Alert> &\n  Pick<React.ComponentProps<typeof Access>, 'access'>;\n\nconst PermissionAlert = ({access = ['project:write'], ...props}: Props) => (\n  <Access access={access}>\n    {({hasAccess}) =>\n      !hasAccess && (\n        <Alert type=\"warning\" {...props}>\n          {t(\n            'These settings can only be edited by users with the organization owner, manager, or admin role.'\n          )}\n        </Alert>\n      )\n    }\n  </Access>\n);\n\nexport default PermissionAlert;\n","import {Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport Access from 'sentry/components/acl/access';\nimport Button from 'sentry/components/button';\nimport Form from 'sentry/components/forms/form';\nimport JsonForm from 'sentry/components/forms/jsonForm';\nimport {Field} from 'sentry/components/forms/type';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport {PanelItem} from 'sentry/components/panels';\nimport {t, tct} from 'sentry/locale';\nimport {Organization, Project, Scope} from 'sentry/types';\nimport {trackAnalyticsEvent} from 'sentry/utils/analytics';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport AsyncView from 'sentry/views/asyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport PermissionAlert from 'sentry/views/settings/project/permissionAlert';\n\ntype Props = RouteComponentProps<{orgId: string; projectId: string}, {}> & {\n  organization: Organization;\n  project: Project;\n};\n\ntype ProjectThreshold = {\n  metric: string;\n  threshold: string;\n  editedBy?: string;\n  id?: string;\n};\n\ntype State = AsyncView['state'] & {\n  threshold: ProjectThreshold;\n};\n\nclass ProjectPerformance extends AsyncView<Props, State> {\n  getTitle() {\n    const {projectId} = this.props.params;\n\n    return routeTitleGen(t('Performance'), projectId, false);\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {params} = this.props;\n    const {orgId, projectId} = params;\n\n    const endpoints: ReturnType<AsyncView['getEndpoints']> = [\n      ['threshold', `/projects/${orgId}/${projectId}/transaction-threshold/configure/`],\n    ];\n\n    return endpoints;\n  }\n\n  handleDelete = () => {\n    const {orgId, projectId} = this.props.params;\n    const {organization} = this.props;\n\n    this.setState({\n      loading: true,\n    });\n\n    this.api.request(`/projects/${orgId}/${projectId}/transaction-threshold/configure/`, {\n      method: 'DELETE',\n      success: () => {\n        trackAnalyticsEvent({\n          eventKey: 'performance_views.project_transaction_threshold.clear',\n          eventName: 'Project Transaction Threshold: Cleared',\n          organization_id: organization.id,\n        });\n      },\n      complete: () => this.fetchData(),\n    });\n  };\n\n  getEmptyMessage() {\n    return t('There is no threshold set for this project.');\n  }\n\n  renderLoading() {\n    return (\n      <LoadingIndicatorContainer>\n        <LoadingIndicator />\n      </LoadingIndicatorContainer>\n    );\n  }\n\n  get formFields(): Field[] {\n    const fields: Field[] = [\n      {\n        name: 'metric',\n        type: 'select',\n        label: t('Calculation Method'),\n        options: [\n          {value: 'duration', label: t('Transaction Duration')},\n          {value: 'lcp', label: t('Largest Contentful Paint')},\n        ],\n        help: tct(\n          'This determines which duration is used to set your thresholds. By default, we use transaction duration which measures the entire length of the transaction. You can also set this to use a [link:Web Vital].',\n          {\n            link: (\n              <ExternalLink href=\"https://docs.sentry.io/product/performance/web-vitals/\" />\n            ),\n          }\n        ),\n      },\n      {\n        name: 'threshold',\n        type: 'string',\n        label: t('Response Time Threshold (ms)'),\n        placeholder: t('300'),\n        help: tct(\n          'Define what a satisfactory response time is based on the calculation method above. This will affect how your [link1:Apdex] and [link2:User Misery] thresholds are calculated. For example, misery will be 4x your satisfactory response time.',\n          {\n            link1: (\n              <ExternalLink href=\"https://docs.sentry.io/performance-monitoring/performance/metrics/#apdex\" />\n            ),\n            link2: (\n              <ExternalLink href=\"https://docs.sentry.io/product/performance/metrics/#user-misery\" />\n            ),\n          }\n        ),\n      },\n    ];\n    return fields;\n  }\n\n  get initialData() {\n    const {threshold} = this.state;\n\n    return {\n      threshold: threshold.threshold,\n      metric: threshold.metric,\n    };\n  }\n\n  renderBody() {\n    const {organization, project} = this.props;\n    const endpoint = `/projects/${organization.slug}/${project.slug}/transaction-threshold/configure/`;\n    const requiredScopes: Scope[] = ['project:write'];\n\n    return (\n      <Fragment>\n        <SettingsPageHeader title={t('Performance')} />\n        <PermissionAlert access={requiredScopes} />\n        <Form\n          saveOnBlur\n          allowUndo\n          initialData={this.initialData}\n          apiMethod=\"POST\"\n          apiEndpoint={endpoint}\n          onSubmitSuccess={resp => {\n            const initial = this.initialData;\n            const changedThreshold = initial.metric === resp.metric;\n            trackAnalyticsEvent({\n              eventKey: 'performance_views.project_transaction_threshold.change',\n              eventName: 'Project Transaction Threshold: Changed',\n              organization_id: organization.id,\n              from: changedThreshold ? initial.threshold : initial.metric,\n              to: changedThreshold ? resp.threshold : resp.metric,\n              key: changedThreshold ? 'threshold' : 'metric',\n            });\n            this.setState({threshold: resp});\n          }}\n        >\n          <Access access={requiredScopes}>\n            {({hasAccess}) => (\n              <JsonForm\n                title={t('General')}\n                fields={this.formFields}\n                disabled={!hasAccess}\n                renderFooter={() => (\n                  <Actions>\n                    <Button type=\"button\" onClick={() => this.handleDelete()}>\n                      {t('Reset All')}\n                    </Button>\n                  </Actions>\n                )}\n              />\n            )}\n          </Access>\n        </Form>\n      </Fragment>\n    );\n  }\n}\n\nconst Actions = styled(PanelItem)`\n  justify-content: flex-end;\n`;\n\nconst LoadingIndicatorContainer = styled('div')`\n  margin: 18px 18px 0;\n`;\n\nexport default ProjectPerformance;\n","import {RouteComponentProps} from 'react-router';\n\nimport Feature from 'sentry/components/acl/feature';\nimport {Organization, Project} from 'sentry/types';\n\nimport ProjectPerformance from './projectPerformance';\n\ntype Props = RouteComponentProps<{orgId: string; projectId: string}, {}> & {\n  organization: Organization;\n  project: Project;\n};\n\nfunction ProjectPerformanceContainer(props: Props) {\n  return (\n    <Feature features={['performance-view']}>\n      <ProjectPerformance {...props} />\n    </Feature>\n  );\n}\n\nexport default ProjectPerformanceContainer;\n"],"names":["routeName","orgSlug","withSentry","projectSlug","tmplBase","tmpl","AsyncView","AsyncComponent","getTitle","render","title","this","renderComponent","PermissionAlert","access","props","hasAccess","type","t","ProjectPerformance","orgId","projectId","params","organization","setState","loading","api","request","method","success","trackAnalyticsEvent","eventKey","eventName","organization_id","id","complete","fetchData","routeTitleGen","getEndpoints","getEmptyMessage","renderLoading","LoadingIndicatorContainer","formFields","name","label","options","value","help","tct","link","href","placeholder","link1","link2","initialData","threshold","state","metric","renderBody","project","endpoint","slug","requiredScopes","Fragment","saveOnBlur","allowUndo","apiMethod","apiEndpoint","onSubmitSuccess","resp","initial","changedThreshold","from","to","key","fields","disabled","renderFooter","Actions","onClick","handleDelete","PanelItem","ProjectPerformanceContainer","features"],"sourceRoot":""}