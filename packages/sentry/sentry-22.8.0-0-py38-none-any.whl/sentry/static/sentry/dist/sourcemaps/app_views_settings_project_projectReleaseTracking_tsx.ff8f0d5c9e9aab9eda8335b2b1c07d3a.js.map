{"version":3,"file":"chunks/app_views_settings_project_projectReleaseTracking_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"wlBAcA,MAAMA,EAAkB,IAAsC,IAArC,QAACC,EAAD,eAAUC,GAA2B,EAC5D,OAAuB,IAAnBD,EAAQE,OACH,MAIP,QAAC,KAAD,YACE,QAAC,KAAD,WAAcC,EAAAA,EAAAA,GAAE,4BAEhB,QAAC,IAAD,WACE,QAACC,EAAD,UACGJ,EAAQK,KAAIC,IACX,QAACC,EAAD,CAEEC,QAAS,IAAMP,EAAeK,GAC9BG,UAAY,qBAAoBH,EAAOI,KAHzC,UAKE,QAACC,EAAD,YACE,QAACC,EAAD,CAAkBC,SAAUP,EAAOI,MACnC,QAAC,IAAD,UAAeJ,EAAOQ,WAAaR,EAAOS,WANvCT,EAAOI,cAbpBX,EAAAA,YAAAA,kBA6BN,MAAMK,GAAU,OAAO,MAAP,qBAAH,yBAEAY,EAAAA,EAAAA,GAAM,GAFN,2BAOPT,GAAoB,OAAO,SAAP,qBAAH,WACXS,EAAAA,EAAAA,GAAM,GADK,6CAIRC,GAAKA,EAAEC,MAAMC,eAJL,wIAWJF,GAAKA,EAAEC,MAAME,cAXT,6CAmBjBT,GAAQ,OAAO,MAAP,qBAAH,kFAMLC,GAAmB,OAAOS,EAAAA,GAAP,qBAAH,iBACJL,EAAAA,EAAAA,GAAM,GADF,KAItB,I,6CC/DA,MAAMM,EAAa,IAMN,IANO,aAClBC,EADkB,QAElBC,EAFkB,WAGlBC,EAHkB,gBAIlBC,EAAkB,SAJA,eAKlBzB,EAAiB,UACN,EACX,MAUM0B,EAAuBrB,KAC3BsB,EAAAA,EAAAA,IAAc,CACZC,UAAWL,EAAQM,KACnBC,MAAOR,EAAaO,KACpBjB,SAAUP,EAAOwB,OAGnBJ,EAAgBpB,IAGlB,OAAKmB,EAAWvB,QAWd,yBACGuB,EACEO,QAAOf,GAAKA,EAAEgB,UACd5B,KAAI6B,IACH,QAAC,IAAD,CACEA,KAAMA,EACNX,aAAcA,EACdC,QAASA,EAETE,gBAAiBC,GADZO,EAAKxB,OAKhB,QAAC,EAAD,CACEV,QAASyB,EAAWO,QAAOf,IAAMA,EAAEgB,UAAYhB,EAAEkB,WACjDlC,eA9CsBK,KAC1B8B,EAAAA,EAAAA,IAAa,CACXP,UAAWL,EAAQM,KACnBC,MAAOR,EAAaO,KACpBjB,SAAUP,EAAOwB,OAGnB7B,EAAeK,UAeb,QAAC,KAAD,WACE,QAAC,KAAD,WACGH,EAAAA,EAAAA,GAAE,4EA/BPmB,EAAAA,YAAAA,aA2DN,W,wDC/DA,QAZA,SACEe,EACAC,GAGQ,IAFRC,IAEQ,yDADRC,EACQ,uCACR,MAAMC,EAAY,GAAEJ,OAAeC,IAC7BI,EAAOF,EAAe,GAAEC,OAAcD,IAAgBC,EAE5D,OAAOF,EAAc,GAAEG,aAAkBA,I,kZCQ3C,MAAMC,EAAe,CACnBC,SAAS,EACT5C,QAAS,GACT6C,MAAO,KACPC,UAAW,MAGPC,EAAqC,CACzC/C,QAAS,KACTgD,MAAO,IAAIL,GACXM,SAAU,IAAIC,IACdC,qBAAsB,GAEtBC,QAKE,OAHAC,KAAKrD,QAAU,KACfqD,KAAKL,MAAQ,IAAIL,GACjBU,KAAKJ,SAAW,IAAIC,IACbG,KAAKL,OAGdM,kBACE,OAAOD,KAAKE,YAGdA,WACE,MAAOvD,QAASwD,KAAaR,GAASK,KAAKL,MAE3C,MAAO,IACFA,EACHhD,QAASqD,KAAKrD,QAAUyD,MAAMC,KAAKL,KAAKrD,QAAQ2D,UAAY,KAIhEC,OACEP,KAAKD,QACLC,KAAKF,qBAAqBU,KACxBR,KAAKS,SAASC,EAAAA,EAAAA,SAAwBV,KAAKW,aAE7CX,KAAKF,qBAAqBU,KACxBR,KAAKS,SAASC,EAAAA,EAAAA,gBAA+BV,KAAKY,oBAEpDZ,KAAKF,qBAAqBU,KACxBR,KAAKS,SAASC,EAAAA,EAAAA,cAA6BV,KAAKa,kBAElDb,KAAKF,qBAAqBU,KAAKR,KAAKS,SAASC,EAAAA,EAAAA,OAAsBV,KAAKc,WACxEd,KAAKF,qBAAqBU,KACxBR,KAAKS,SAASC,EAAAA,EAAAA,cAA6BV,KAAKe,kBAElDf,KAAKF,qBAAqBU,KACxBR,KAAKS,SAASC,EAAAA,EAAAA,YAA2BV,KAAKgB,iBAIlDC,eACEjB,KAAKkB,QAAQlB,KAAKE,aAGpBS,aAA0D,IAA/C,aAACQ,GAA8C,uDAAJ,GAChDA,IACFnB,KAAKL,MAAMJ,SAAU,EACrBS,KAAKL,MAAMH,MAAQ,KACnBQ,KAAKrD,QAAU,MAGjBqD,KAAKiB,gBAGPL,kBAAkB/B,EAAD,GAAoD,IAAnC,UAACY,GAAkC,EACnEO,KAAKrD,QAAU,IAAIkD,IAAIhB,EAAK7B,KAAIC,GAAU,CAACA,EAAOI,GAAIJ,MACtD+C,KAAKL,MAAMF,UAAYA,GAAa,KACpCO,KAAKL,MAAMJ,SAAU,EACrBS,KAAKiB,gBAGPJ,gBAAgBO,GACdpB,KAAKrD,QAAU,KACfqD,KAAKL,MAAMJ,SAAU,EACrBS,KAAKL,MAAMH,MAAQ4B,EACnBpB,KAAKiB,gBAGPH,SAASzD,EAAYgE,GACnB,IAAKrB,KAAKrD,QACR,OAGF,MAAMM,EAAS+C,KAAKrD,QAAQ2E,IAAIjE,GAChC,IAAKJ,EACH,OAEF,MAAMsE,EAAY,IACbtE,KACAoE,GAGLrB,KAAKrD,QAAQ6E,IAAInE,EAAIkE,GACrBvB,KAAKJ,SAAS4B,IAAInE,EAAIJ,GACtB+C,KAAKiB,gBAGPF,gBAAgB1D,EAAYoE,GAC1BzB,KAAKJ,SAAS8B,OAAOrE,IAGvB2D,cAAc3D,EAAYoE,EAA6BL,GACrD,MAAMO,EAAa3B,KAAKJ,SAAS0B,IAAIjE,GAChCsE,GAAe3B,KAAKrD,UAIzBqD,KAAKrD,QAAQ6E,IAAInE,EAAIsE,GACrB3B,KAAKJ,SAAS8B,OAAOrE,GACrB2C,KAAKL,MAAMH,MAAQ4B,EACnBpB,KAAKiB,kBAKT,GADoBW,EAAAA,EAAAA,cAAYC,EAAAA,EAAAA,GAAoBnC,I,4OC3CpD,QApEA,SACEoC,GAEA,MAAMC,UAAoBC,EAAAA,UAA6D,uDAE7E,CAACrF,QAAS,GAAI4C,SAAS,KAFsD,0BAwCvE0C,EAAAA,QAAoB,IAA+B,IAA9B,QAACtF,EAAD,QAAU4C,GAAoB,EAG/DS,KAAKkC,SAAS,CAACvF,QAAAA,EAAS4C,QAAAA,WACvB4C,IAxCHC,oBACEpC,KAAKqC,eAGPC,mBAAmBC,EAAWC,EAAYC,GACxC,MAAM,aAACvE,EAAD,QAAeC,GAAW6B,KAAK0C,MAG/BC,EAAUJ,EAAUrE,eAAgBuE,MAAAA,OAA1B,EAA0BA,EAAavE,cACjD0E,EAAcL,EAAUpE,UAAWsE,MAAAA,OAArB,EAAqBA,EAAatE,SAQtD,KAAK0E,EAAAA,EAAAA,IAAQD,MAAiBC,EAAAA,EAAAA,IAAQF,GACpC,OAGF,MAAMG,EAAYH,EAAQlE,OAASP,EAAaO,KAC1CsE,EAAgBH,EAAYnE,QAASN,MAAAA,OAArB,EAAqBA,EAASM,MAGhDqE,GAAaC,GAIjB/C,KAAKqC,eAGPW,uBACEhD,KAAKiD,cASPZ,eACE,MAAM,aAACnE,EAAD,QAAeC,GAAW6B,KAAK0C,MAEhCvE,GAAYD,IAIjBmE,EAAAA,EAAAA,IAAa,CAAC7D,UAAWL,EAAQM,KAAMC,MAAOR,EAAaO,OAG7DyE,SACE,OACE,QAACpB,EAAD,IAAuB9B,KAAK0C,MAA+B/F,QAASqD,KAAKL,SAI/E,OA9DMoC,EADN,kCACMA,EADN,cAEwB,gBAAcoB,EAAAA,EAAAA,GAAerB,QA6D9CsB,EAAAA,EAAAA,IAAiBC,EAAAA,EAAAA,GAAYtB,M,sPCnFvB,MAAMuB,UAGXC,EAAAA,EACRC,WACE,MAAO,GAGTN,SACE,OACE,QAAC,IAAD,CAAqBO,MAAOzD,KAAKwD,WAAjC,SACGxD,KAAK0D,qBAXOJ,EAAAA,YAAAA,a,klCCerB,MAgBMK,EAAkB,CACtBC,MAjBwB,aAkBxBC,WAjB0B,oBAoB5B,MAAMC,UAA+BR,EAAAA,EAAwB,wEAoBnC,KACtB,MAAM,MAAC5E,EAAD,UAAQF,GAAawB,KAAK0C,MAAMqB,OACtC/D,KAAKgE,IAAIC,QAAS,aAAYvF,KAASF,oBAA6B,CAClE0F,OAAQ,OACRrF,KAAM,CAACV,QAASK,GAChB2F,QAAStF,IACPmB,KAAKkC,SAAS,CACZrD,KAAM,CACJ+E,MAAO/E,EAAK+E,MACZC,WAAYhF,EAAKgF,eAGrBO,EAAAA,EAAAA,KACEtH,EAAAA,EAAAA,GACE,gGAIN0C,MAAO,MACL6E,EAAAA,EAAAA,KAAgBvH,EAAAA,EAAAA,GAAE,8DAtCxB0G,WACE,MAAM,UAAChF,GAAawB,KAAK0C,MAAMqB,OAC/B,OAAOO,EAAAA,EAAAA,IAAcxH,EAAAA,EAAAA,GAAE,YAAa0B,GAAW,GAGjD+F,eACE,MAAM,MAAC7F,EAAD,UAAQF,GAAawB,KAAK0C,MAAMqB,OAGtC,MAAO,CACL,CACE,OACC,aAAYrF,KAASF,oBACtB,GACA,CAACgG,WAAYpD,GAAOA,GAAsB,MAAfA,EAAIqD,UA6BrCC,+BACE,MAAM,WAACb,GAAc7D,KAAKL,MAAMd,MAAQ8E,EACxC,MACE,QACAE,EADA,iGAYJc,aACE,MAAM,aAACzG,EAAD,QAAeC,EAAf,QAAwBxB,GAAWqD,KAAK0C,MACxCkC,EAAW1G,EAAa2G,OAAOC,SAAS,iBAE9C,GAAInI,EAAQ4C,QACV,OAAO,QAAC,IAAD,IAGT,MAAMnB,EAAazB,EAAQA,QAAQgC,QAChCf,GAAyB,qBAAXA,EAAEmH,MAA+BnH,EAAEoH,mBAGpD,IAAI,MAACpB,EAAD,WAAQC,GAAc7D,KAAKL,MAAMd,MAAQ8E,EAK7C,OAHAC,GAAQqB,EAAAA,EAAAA,GAAe,CAACC,MAAOtB,EAAOuB,MAAO,cAC7CtB,GAAaoB,EAAAA,EAAAA,GAAe,CAACC,MAAOrB,EAAYsB,MAAO,qBAGrD,0BACE,QAAC,IAAD,CAAoB1B,OAAO3G,EAAAA,EAAAA,GAAE,uBAC3B8H,IACA,QAAC,IAAD,CAAOG,KAAK,UAAZ,UACGjI,EAAAA,EAAAA,GACC,yGAIN,uBACGA,EAAAA,EAAAA,GACC,4GAIJ,QAAC,KAAD,YACE,QAAC,KAAD,WAAcA,EAAAA,EAAAA,GAAE,2BAChB,QAAC,IAAD,CAAWsI,aAAW,EAAtB,WACE,uBACGC,EAAAA,EAAAA,IACC,8IACA,CACEC,MACE,QAAC,IAAD,CAAcC,KAAK,0EAAnB,sBAIFC,SAAS,0CAIf,uBACG1I,EAAAA,EAAAA,GACC,mKAGJ,uBACGA,EAAAA,EAAAA,GACC,qIAMR,QAAC,KAAD,YACE,QAAC,KAAD,WAAcA,EAAAA,EAAAA,GAAE,mBAChB,QAAC,IAAD,YACE,QAAC,IAAD,CACE2I,OAAO3I,EAAAA,EAAAA,GAAE,SACT4I,MAAM5I,EAAAA,EAAAA,GAAE,8DAFV,UAIE,QAAC,KAAD,UAAgB8G,OAElB,QAAC,IAAD,CACE6B,OAAO3I,EAAAA,EAAAA,GAAE,oBACT4I,MAAM5I,EAAAA,EAAAA,GACJ,qIAHJ,UAME,yBACE,QAAC,IAAD,CACE6I,UAAWf,EACXgB,SAAS,SACTC,UAAW7F,KAAK8F,sBAChBC,SAASjJ,EAAAA,EAAAA,GACP,gGALJ,UAQE,QAAC,KAAD,CAAQiI,KAAK,SAASa,SAAS,SAASD,UAAWf,EAAnD,UACG9H,EAAAA,EAAAA,GAAE,mCAQf,QAAC,KAAD,YACE,QAAC,KAAD,WAAcA,EAAAA,EAAAA,GAAE,cAChB,QAAC,IAAD,CAAWsI,aAAW,EAAtB,WACE,uBACGtI,EAAAA,EAAAA,GACC,4GAIJ,QAAC,IAAD,WACE,wBAAM+G,OAGR,uBACG/G,EAAAA,EAAAA,GACC,kGAIHmI,EAAAA,EAAAA,GAAe,CACdC,OACE,QAAC,IAAD,WACE,wBAAMlF,KAAK0E,mCAGfS,OACE,wBACI,gIAUZ,QAAC,IAAD,CACEjH,aAAcA,EACdC,QAASA,EACTC,WAAYA,KAGd,QAAC,KAAD,YACE,QAAC,KAAD,WAActB,EAAAA,EAAAA,GAAE,UAChB,QAAC,IAAD,CAAWsI,aAAW,EAAtB,WACE,uBACGtI,EAAAA,EAAAA,GACC,gGAIJ,uBACGuI,EAAAA,EAAAA,IAAI,8DAA+D,CAClEC,MAAM,QAAC,IAAD,CAAcC,KAAK,4DAUzC,SAAeS,EAAAA,EAAAA,GAAYlC","sources":["webpack:///./app/components/inactivePlugins.tsx","webpack:///./app/components/pluginList.tsx","webpack:///./app/utils/routeTitle.tsx","webpack:///./app/stores/pluginsStore.tsx","webpack:///./app/utils/withPlugins.tsx","webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/project/projectReleaseTracking.tsx"],"sourcesContent":["import styled from '@emotion/styled';\n\nimport {Panel, PanelBody, PanelHeader} from 'sentry/components/panels';\nimport TextOverflow from 'sentry/components/textOverflow';\nimport {t} from 'sentry/locale';\nimport PluginIcon from 'sentry/plugins/components/pluginIcon';\nimport space from 'sentry/styles/space';\nimport {Plugin} from 'sentry/types';\n\ntype Props = {\n  onEnablePlugin: (plugin: Plugin) => void;\n  plugins: Plugin[];\n};\n\nconst InactivePlugins = ({plugins, onEnablePlugin}: Props) => {\n  if (plugins.length === 0) {\n    return null;\n  }\n\n  return (\n    <Panel>\n      <PanelHeader>{t('Inactive Integrations')}</PanelHeader>\n\n      <PanelBody>\n        <Plugins>\n          {plugins.map(plugin => (\n            <IntegrationButton\n              key={plugin.id}\n              onClick={() => onEnablePlugin(plugin)}\n              className={`ref-plugin-enable-${plugin.id}`}\n            >\n              <Label>\n                <StyledPluginIcon pluginId={plugin.id} />\n                <TextOverflow>{plugin.shortName || plugin.name}</TextOverflow>\n              </Label>\n            </IntegrationButton>\n          ))}\n        </Plugins>\n      </PanelBody>\n    </Panel>\n  );\n};\n\nconst Plugins = styled('div')`\n  display: flex;\n  padding: ${space(1)};\n  flex: 1;\n  flex-wrap: wrap;\n`;\n\nconst IntegrationButton = styled('button')`\n  margin: ${space(1)};\n  width: 175px;\n  text-align: center;\n  font-size: ${p => p.theme.fontSizeSmall};\n  color: #889ab0;\n  letter-spacing: 0.1px;\n  font-weight: 600;\n  text-transform: uppercase;\n  border: 1px solid #eee;\n  background: inherit;\n  border-radius: ${p => p.theme.borderRadius};\n  padding: 10px;\n\n  &:hover {\n    border-color: #ccc;\n  }\n`;\n\nconst Label = styled('div')`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledPluginIcon = styled(PluginIcon)`\n  margin-right: ${space(1)};\n`;\n\nexport default InactivePlugins;\n","import {disablePlugin, enablePlugin} from 'sentry/actionCreators/plugins';\nimport InactivePlugins from 'sentry/components/inactivePlugins';\nimport PluginConfig from 'sentry/components/pluginConfig';\nimport {t} from 'sentry/locale';\nimport {Organization, Plugin, Project} from 'sentry/types';\n\nimport {Panel, PanelItem} from './panels';\n\ntype Props = {\n  organization: Organization;\n  pluginList: Plugin[];\n  project: Project;\n  onDisablePlugin?: (plugin: Plugin) => void;\n  onEnablePlugin?: (plugin: Plugin) => void;\n};\n\nconst PluginList = ({\n  organization,\n  project,\n  pluginList,\n  onDisablePlugin = () => {},\n  onEnablePlugin = () => {},\n}: Props) => {\n  const handleEnablePlugin = (plugin: Plugin) => {\n    enablePlugin({\n      projectId: project.slug,\n      orgId: organization.slug,\n      pluginId: plugin.slug,\n    });\n\n    onEnablePlugin(plugin);\n  };\n\n  const handleDisablePlugin = (plugin: Plugin) => {\n    disablePlugin({\n      projectId: project.slug,\n      orgId: organization.slug,\n      pluginId: plugin.slug,\n    });\n\n    onDisablePlugin(plugin);\n  };\n\n  if (!pluginList.length) {\n    return (\n      <Panel>\n        <PanelItem>\n          {t(\"Oops! Looks like there aren't any available integrations installed.\")}\n        </PanelItem>\n      </Panel>\n    );\n  }\n\n  return (\n    <div>\n      {pluginList\n        .filter(p => p.enabled)\n        .map(data => (\n          <PluginConfig\n            data={data}\n            organization={organization}\n            project={project}\n            key={data.id}\n            onDisablePlugin={handleDisablePlugin}\n          />\n        ))}\n\n      <InactivePlugins\n        plugins={pluginList.filter(p => !p.enabled && !p.isHidden)}\n        onEnablePlugin={handleEnablePlugin}\n      />\n    </div>\n  );\n};\n\nexport default PluginList;\n","function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import {createStore, StoreDefinition} from 'reflux';\n\nimport PluginActions from 'sentry/actions/pluginActions';\nimport {Plugin} from 'sentry/types';\nimport {makeSafeRefluxStore} from 'sentry/utils/makeSafeRefluxStore';\n\ninterface PluginStoreDefinition extends StoreDefinition {\n  plugins: Map<string, Plugin> | null;\n  state: {\n    error: Error | null;\n    loading: boolean;\n    pageLinks: string | null;\n    plugins: Plugin[];\n  };\n  updating: Map<string, Plugin>;\n}\n\nconst defaultState = {\n  loading: true,\n  plugins: [],\n  error: null,\n  pageLinks: null,\n};\n\nconst storeConfig: PluginStoreDefinition = {\n  plugins: null,\n  state: {...defaultState},\n  updating: new Map(),\n  unsubscribeListeners: [],\n\n  reset() {\n    // reset our state\n    this.plugins = null;\n    this.state = {...defaultState};\n    this.updating = new Map();\n    return this.state;\n  },\n\n  getInitialState() {\n    return this.getState();\n  },\n\n  getState() {\n    const {plugins: _plugins, ...state} = this.state;\n\n    return {\n      ...state,\n      plugins: this.plugins ? Array.from(this.plugins.values()) : [],\n    };\n  },\n\n  init() {\n    this.reset();\n    this.unsubscribeListeners.push(\n      this.listenTo(PluginActions.fetchAll, this.onFetchAll)\n    );\n    this.unsubscribeListeners.push(\n      this.listenTo(PluginActions.fetchAllSuccess, this.onFetchAllSuccess)\n    );\n    this.unsubscribeListeners.push(\n      this.listenTo(PluginActions.fetchAllError, this.onFetchAllError)\n    );\n    this.unsubscribeListeners.push(this.listenTo(PluginActions.update, this.onUpdate));\n    this.unsubscribeListeners.push(\n      this.listenTo(PluginActions.updateSuccess, this.onUpdateSuccess)\n    );\n    this.unsubscribeListeners.push(\n      this.listenTo(PluginActions.updateError, this.onUpdateError)\n    );\n  },\n\n  triggerState() {\n    this.trigger(this.getState());\n  },\n\n  onFetchAll({resetLoading}: {resetLoading?: boolean} = {}) {\n    if (resetLoading) {\n      this.state.loading = true;\n      this.state.error = null;\n      this.plugins = null;\n    }\n\n    this.triggerState();\n  },\n\n  onFetchAllSuccess(data: Plugin[], {pageLinks}: {pageLinks?: string}) {\n    this.plugins = new Map(data.map(plugin => [plugin.id, plugin]));\n    this.state.pageLinks = pageLinks || null;\n    this.state.loading = false;\n    this.triggerState();\n  },\n\n  onFetchAllError(err) {\n    this.plugins = null;\n    this.state.loading = false;\n    this.state.error = err;\n    this.triggerState();\n  },\n\n  onUpdate(id: string, updateObj: Partial<Plugin>) {\n    if (!this.plugins) {\n      return;\n    }\n\n    const plugin = this.plugins.get(id);\n    if (!plugin) {\n      return;\n    }\n    const newPlugin = {\n      ...plugin,\n      ...updateObj,\n    };\n\n    this.plugins.set(id, newPlugin);\n    this.updating.set(id, plugin);\n    this.triggerState();\n  },\n\n  onUpdateSuccess(id: string, _updateObj: Partial<Plugin>) {\n    this.updating.delete(id);\n  },\n\n  onUpdateError(id: string, _updateObj: Partial<Plugin>, err) {\n    const origPlugin = this.updating.get(id);\n    if (!origPlugin || !this.plugins) {\n      return;\n    }\n\n    this.plugins.set(id, origPlugin);\n    this.updating.delete(id);\n    this.state.error = err;\n    this.triggerState();\n  },\n};\n\nconst PluginStore = createStore(makeSafeRefluxStore(storeConfig));\nexport default PluginStore;\n","import {Component} from 'react';\n\nimport {fetchPlugins} from 'sentry/actionCreators/plugins';\nimport PluginsStore from 'sentry/stores/pluginsStore';\nimport {Organization, Plugin, Project} from 'sentry/types';\nimport {defined} from 'sentry/utils';\nimport getDisplayName from 'sentry/utils/getDisplayName';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport withProject from 'sentry/utils/withProject';\n\ntype WithPluginProps = {\n  organization: Organization;\n  project?: Project;\n};\n\ntype State = {\n  loading: boolean;\n  plugins: Plugin[];\n};\n\n/**\n * Higher order component that fetches list of plugins and\n * passes PluginsStore to component as `plugins`\n */\nfunction withPlugins<P extends WithPluginProps>(\n  WrappedComponent: React.ComponentType<P>\n) {\n  class WithPlugins extends Component<Omit<P, keyof 'plugins'> & WithPluginProps, State> {\n    static displayName = `withPlugins(${getDisplayName(WrappedComponent)})`;\n    state = {plugins: [], loading: true};\n\n    componentDidMount() {\n      this.fetchPlugins();\n    }\n\n    componentDidUpdate(prevProps, _prevState, prevContext) {\n      const {organization, project} = this.props;\n\n      // Only fetch plugins when a org slug or project slug has changed\n      const prevOrg = prevProps.organization || prevContext?.organization;\n      const prevProject = prevProps.project || prevContext?.project;\n\n      // If previous org/project is undefined then it means:\n      // the HoC has mounted, `fetchPlugins` has been called (via cDM), and\n      // store was updated. We don't need to fetchPlugins again (or it will cause an infinite loop)\n      //\n      // This is for the unusual case where component is mounted and receives a new org/project prop\n      // e.g. when switching projects via breadcrumbs in settings.\n      if (!defined(prevProject) || !defined(prevOrg)) {\n        return;\n      }\n\n      const isOrgSame = prevOrg.slug === organization.slug;\n      const isProjectSame = prevProject.slug === project?.slug;\n\n      // Don't do anything if org and project are the same\n      if (isOrgSame && isProjectSame) {\n        return;\n      }\n\n      this.fetchPlugins();\n    }\n\n    componentWillUnmount() {\n      this.unsubscribe();\n    }\n\n    unsubscribe = PluginsStore.listen(({plugins, loading}: State) => {\n      // State is destructured as store updates contain additional keys\n      // that are not exposed by this HoC\n      this.setState({plugins, loading});\n    }, undefined);\n\n    fetchPlugins() {\n      const {organization, project} = this.props;\n\n      if (!project || !organization) {\n        return;\n      }\n\n      fetchPlugins({projectId: project.slug, orgId: organization.slug});\n    }\n\n    render() {\n      return (\n        <WrappedComponent {...(this.props as P & WithPluginProps)} plugins={this.state} />\n      );\n    }\n  }\n  return withOrganization(withProject(WithPlugins));\n}\n\nexport default withPlugins;\n","import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {RouteComponentProps} from 'react-router';\n\nimport {addErrorMessage, addSuccessMessage} from 'sentry/actionCreators/indicator';\nimport Alert from 'sentry/components/alert';\nimport AutoSelectText from 'sentry/components/autoSelectText';\nimport Button from 'sentry/components/button';\nimport Confirm from 'sentry/components/confirm';\nimport Field from 'sentry/components/forms/field';\nimport TextCopyInput from 'sentry/components/forms/textCopyInput';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport {Panel, PanelBody, PanelHeader} from 'sentry/components/panels';\nimport PluginList from 'sentry/components/pluginList';\nimport {t, tct} from 'sentry/locale';\nimport {Organization, Plugin, Project} from 'sentry/types';\nimport getDynamicText from 'sentry/utils/getDynamicText';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport withPlugins from 'sentry/utils/withPlugins';\nimport AsyncView from 'sentry/views/asyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\n\nconst TOKEN_PLACEHOLDER = 'YOUR_TOKEN';\nconst WEBHOOK_PLACEHOLDER = 'YOUR_WEBHOOK_URL';\n\ntype Props = {\n  organization: Organization;\n  plugins: {loading: boolean; plugins: Plugin[]};\n  project: Project;\n} & RouteComponentProps<{orgId: string; projectId: string}, {}>;\n\ntype State = {\n  data: {\n    token: string;\n    webhookUrl: string;\n  } | null;\n} & AsyncView['state'];\n\nconst placeholderData = {\n  token: TOKEN_PLACEHOLDER,\n  webhookUrl: WEBHOOK_PLACEHOLDER,\n};\n\nclass ProjectReleaseTracking extends AsyncView<Props, State> {\n  getTitle() {\n    const {projectId} = this.props.params;\n    return routeTitleGen(t('Releases'), projectId, false);\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {orgId, projectId} = this.props.params;\n\n    // Allow 403s\n    return [\n      [\n        'data',\n        `/projects/${orgId}/${projectId}/releases/token/`,\n        {},\n        {allowError: err => err && err.status === 403},\n      ],\n    ];\n  }\n\n  handleRegenerateToken = () => {\n    const {orgId, projectId} = this.props.params;\n    this.api.request(`/projects/${orgId}/${projectId}/releases/token/`, {\n      method: 'POST',\n      data: {project: projectId},\n      success: data => {\n        this.setState({\n          data: {\n            token: data.token,\n            webhookUrl: data.webhookUrl,\n          },\n        });\n        addSuccessMessage(\n          t(\n            'Your deploy token has been regenerated. You will need to update any existing deploy hooks.'\n          )\n        );\n      },\n      error: () => {\n        addErrorMessage(t('Unable to regenerate deploy token, please try again'));\n      },\n    });\n  };\n\n  getReleaseWebhookIntructions() {\n    const {webhookUrl} = this.state.data || placeholderData;\n    return (\n      'curl ' +\n      webhookUrl +\n      ' \\\\' +\n      '\\n  ' +\n      '-X POST \\\\' +\n      '\\n  ' +\n      \"-H 'Content-Type: application/json' \\\\\" +\n      '\\n  ' +\n      '-d \\'{\"version\": \"abcdefg\"}\\''\n    );\n  }\n\n  renderBody() {\n    const {organization, project, plugins} = this.props;\n    const hasWrite = organization.access.includes('project:write');\n\n    if (plugins.loading) {\n      return <LoadingIndicator />;\n    }\n\n    const pluginList = plugins.plugins.filter(\n      (p: Plugin) => p.type === 'release-tracking' && p.hasConfiguration\n    );\n\n    let {token, webhookUrl} = this.state.data || placeholderData;\n\n    token = getDynamicText({value: token, fixed: '__TOKEN__'});\n    webhookUrl = getDynamicText({value: webhookUrl, fixed: '__WEBHOOK_URL__'});\n\n    return (\n      <div>\n        <SettingsPageHeader title={t('Release Tracking')} />\n        {!hasWrite && (\n          <Alert type=\"warning\">\n            {t(\n              'You do not have sufficient permissions to access Release tokens, placeholders are displayed below.'\n            )}\n          </Alert>\n        )}\n        <p>\n          {t(\n            'Configure release tracking for this project to automatically record new releases of your application.'\n          )}\n        </p>\n\n        <Panel>\n          <PanelHeader>{t('Client Configuration')}</PanelHeader>\n          <PanelBody withPadding>\n            <p>\n              {tct(\n                'Start by binding the [release] attribute in your application, take a look at [link] to see how to configure this for the SDK you are using.',\n                {\n                  link: (\n                    <ExternalLink href=\"https://docs.sentry.io/platform-redirect/?next=/configuration/releases/\">\n                      our docs\n                    </ExternalLink>\n                  ),\n                  release: <code>release</code>,\n                }\n              )}\n            </p>\n            <p>\n              {t(\n                \"This will annotate each event with the version of your application, as well as automatically create a release entity in the system the first time it's seen.\"\n              )}\n            </p>\n            <p>\n              {t(\n                'In addition you may configure a release hook (or use our API) to push a release and include additional metadata with it.'\n              )}\n            </p>\n          </PanelBody>\n        </Panel>\n\n        <Panel>\n          <PanelHeader>{t('Deploy Token')}</PanelHeader>\n          <PanelBody>\n            <Field\n              label={t('Token')}\n              help={t('A unique secret which is used to generate deploy hook URLs')}\n            >\n              <TextCopyInput>{token}</TextCopyInput>\n            </Field>\n            <Field\n              label={t('Regenerate Token')}\n              help={t(\n                'If a service becomes compromised, you should regenerate the token and re-configure any deploy hooks with the newly generated URL.'\n              )}\n            >\n              <div>\n                <Confirm\n                  disabled={!hasWrite}\n                  priority=\"danger\"\n                  onConfirm={this.handleRegenerateToken}\n                  message={t(\n                    'Are you sure you want to regenerate your token? Your current token will no longer be usable.'\n                  )}\n                >\n                  <Button type=\"button\" priority=\"danger\" disabled={!hasWrite}>\n                    {t('Regenerate Token')}\n                  </Button>\n                </Confirm>\n              </div>\n            </Field>\n          </PanelBody>\n        </Panel>\n\n        <Panel>\n          <PanelHeader>{t('Webhook')}</PanelHeader>\n          <PanelBody withPadding>\n            <p>\n              {t(\n                'If you simply want to integrate with an existing system, sometimes its easiest just to use a webhook.'\n              )}\n            </p>\n\n            <AutoSelectText>\n              <pre>{webhookUrl}</pre>\n            </AutoSelectText>\n\n            <p>\n              {t(\n                'The release webhook accepts the same parameters as the \"Create a new Release\" API endpoint.'\n              )}\n            </p>\n\n            {getDynamicText({\n              value: (\n                <AutoSelectText>\n                  <pre>{this.getReleaseWebhookIntructions()}</pre>\n                </AutoSelectText>\n              ),\n              fixed: (\n                <pre>\n                  {`curl __WEBHOOK_URL__ \\\\\n  -X POST \\\\\n  -H 'Content-Type: application/json' \\\\\n  -d \\'{\"version\": \"abcdefg\"}\\'`}\n                </pre>\n              ),\n            })}\n          </PanelBody>\n        </Panel>\n\n        <PluginList\n          organization={organization}\n          project={project}\n          pluginList={pluginList}\n        />\n\n        <Panel>\n          <PanelHeader>{t('API')}</PanelHeader>\n          <PanelBody withPadding>\n            <p>\n              {t(\n                'You can notify Sentry when you release new versions of your application via our HTTP API.'\n              )}\n            </p>\n\n            <p>\n              {tct('See the [link:releases documentation] for more information.', {\n                link: <ExternalLink href=\"https://docs.sentry.io/workflow/releases/\" />,\n              })}\n            </p>\n          </PanelBody>\n        </Panel>\n      </div>\n    );\n  }\n}\n\nexport default withPlugins(ProjectReleaseTracking);\n\n// Export for tests\nexport {ProjectReleaseTracking};\n"],"names":["InactivePlugins","plugins","onEnablePlugin","length","t","Plugins","map","plugin","IntegrationButton","onClick","className","id","Label","StyledPluginIcon","pluginId","shortName","name","space","p","theme","fontSizeSmall","borderRadius","PluginIcon","PluginList","organization","project","pluginList","onDisablePlugin","handleDisablePlugin","disablePlugin","projectId","slug","orgId","filter","enabled","data","isHidden","enablePlugin","routeName","orgSlug","withSentry","projectSlug","tmplBase","tmpl","defaultState","loading","error","pageLinks","storeConfig","state","updating","Map","unsubscribeListeners","reset","this","getInitialState","getState","_plugins","Array","from","values","init","push","listenTo","PluginActions","onFetchAll","onFetchAllSuccess","onFetchAllError","onUpdate","onUpdateSuccess","onUpdateError","triggerState","trigger","resetLoading","err","updateObj","get","newPlugin","set","_updateObj","delete","origPlugin","createStore","makeSafeRefluxStore","WrappedComponent","WithPlugins","Component","PluginsStore","setState","undefined","componentDidMount","fetchPlugins","componentDidUpdate","prevProps","_prevState","prevContext","props","prevOrg","prevProject","defined","isOrgSame","isProjectSame","componentWillUnmount","unsubscribe","render","getDisplayName","withOrganization","withProject","AsyncView","AsyncComponent","getTitle","title","renderComponent","placeholderData","token","webhookUrl","ProjectReleaseTracking","params","api","request","method","success","addSuccessMessage","addErrorMessage","routeTitleGen","getEndpoints","allowError","status","getReleaseWebhookIntructions","renderBody","hasWrite","access","includes","type","hasConfiguration","getDynamicText","value","fixed","withPadding","tct","link","href","release","label","help","disabled","priority","onConfirm","handleRegenerateToken","message","withPlugins"],"sourceRoot":""}