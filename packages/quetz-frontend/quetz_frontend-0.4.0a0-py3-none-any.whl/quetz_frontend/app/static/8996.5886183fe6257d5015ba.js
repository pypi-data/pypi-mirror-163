"use strict";(self["webpackChunk_quetz_frontend_main_app"]=self["webpackChunk_quetz_frontend_main_app"]||[]).push([[8996],{68996:(e,a,t)=>{t.r(a);t.d(a,{CommandIDs:()=>Q,default:()=>Y});var n=t(85168);var r=t(79450);var l=t(18470);var s=t(88686);var c=t(4496);var o=t(2411);var i=t(30325);var m=t(5089);var p=t(34494);var d=t(18303);var u=t(98078);var h=t(71949);var E=t(42186);class g extends o.PureComponent{constructor(e){super(e);this.onSearch=e=>{this.setState({searchText:e})};this.state={channels:null,searchText:""}}render(){const{searchText:e}=this.state;const a=[{text:"Home",onClick:()=>{this.props.router.navigate("/")}},{text:"Channels"}];const t=u.ServerConnection.makeSettings();const n=d.URLExt.join(t.baseUrl,"/api/paginated/channels");return o.createElement(o.Fragment,null,o.createElement(h.Breadcrumbs,{items:a}),o.createElement("h2",{className:"heading2"},"Channels"),o.createElement(p.Search,{className:"channels-search",onInput:e=>{this.onSearch(e.target.value)},placeholder:"Search"}),o.createElement(E.PaginatedList,{url:n,params:{q:e},columns:b(),to:e=>{this.props.router.navigate(`/channels/${e.name}`)}}))}}const f=g;const b=()=>[{Header:"",accessor:"name",Cell:({row:e})=>{const[a,t]=o.useState(null);return o.createElement(o.Fragment,null,o.createElement("span",{ref:e=>{t(e)}},o.createElement(m.FontAwesomeIcon,{icon:e.original.private?i.faUnlockAlt:i.faGlobeAmericas})),o.createElement(p.Tooltip,{anchorElement:a,position:"right"},e.original.private?"Private":"Public"))},width:5},{Header:"",accessor:"user.profile.name",Cell:({row:e})=>o.createElement("div",null,o.createElement("p",{className:"text"},e.original.name),o.createElement("p",{className:"minor-paragraph channel-list-description"},e.original.description)),width:45},{Header:"",accessor:"user.username",Cell:({row:e})=>(0,h.formatPlural)(e.original.packages_count,"package"),width:35},{Header:"",accessor:"role",Cell:({row:e})=>(0,h.formatPlural)(e.original.members_count,"member"),width:20}];var k=t(47);class v extends o.PureComponent{constructor(){super(...arguments);this.onCopy=e=>{console.log("Copied key: ",e)};this.onDelete=e=>{console.log("Deleted key: ",e)}}render(){const{apiKeyList:e,filters:a}=this.props;const t=a?(0,k.filter)(e,(e=>(0,k.some)(e.roles,a))):e;return o.createElement(E.Table,{columns:C({onCopy:this.onCopy,onDelete:this.onDelete}),data:t||[]})}}class N extends o.PureComponent{render(){const{filters:e}=this.props;const a=u.ServerConnection.makeSettings();const t=d.URLExt.join(a.baseUrl,"api/api-keys");return o.createElement(o.Fragment,null,o.createElement(h.FetchHoc,{url:t,loadingMessage:"Fetching list of API keys",genericErrorMessage:"Error fetching API keys"},(a=>o.createElement(v,{apiKeyList:a,filters:e}))))}}const x=N;const C=({onCopy:e,onDelete:a})=>[{Header:"API key",accessor:"key"},{Header:"Description",accessor:"description"},{Header:"Role",accessor:"roles[0].role"},{Header:"Actions",accessor:"actions",Cell:({row:t})=>o.createElement(o.Fragment,null,o.createElement(p.Button,{"aria-label":"Copy API key",title:"Copy API key",appearance:"stealth",onClick:()=>e(t.original.key)},o.createElement(m.FontAwesomeIcon,{icon:i.faCopy})),o.createElement(p.Button,{"aria-label":"Delete API key",title:"Delete API key",appearance:"stealth",onClick:()=>a(t.original.key)},o.createElement(m.FontAwesomeIcon,{icon:i.faTrash})))}];class I extends o.PureComponent{render(){const{channelId:e}=this.props;return o.createElement("div",{className:"padding"},o.createElement(x,{filters:{channel:e}}))}}const w=I;class P extends o.PureComponent{render(){const{channelId:e}=this.props;const a=u.ServerConnection.makeSettings();const t=d.URLExt.join(a.baseUrl,"/api/channels",e);return o.createElement(h.FetchHoc,{url:t,loadingMessage:"Fetching channel information",genericErrorMessage:"Error fetching channel information"},(e=>o.createElement("div",{className:"padding"},o.createElement("p",{className:"paragraph"},o.createElement(m.FontAwesomeIcon,{icon:e.private?i.faUnlockAlt:i.faGlobeAmericas}),"â€ƒ",e.private?"Private":"Public"),o.createElement("p",{className:"caption-inline"},"Description"),o.createElement("p",{className:"paragraph"},e.description||o.createElement("i",null,"No description available")),o.createElement("p",{className:"caption-inline"},"Mirror mode"),o.createElement("p",{className:"paragraph"},e.mirror_mode||o.createElement("i",null,"n/a")),o.createElement("p",{className:"caption-inline"},"Mirror channel URL"),o.createElement("p",{className:"paragraph"},e.mirror_channel_url||o.createElement("i",null,"n/a")),o.createElement("p",{className:"caption-inline"},"Size limit"),o.createElement("p",{className:"paragraph"},e.size_limit?(0,h.formatSize)(e.size_limit):o.createElement("i",null,"No size limit")))))}}const y=P;class S extends o.PureComponent{render(){const{channelId:e}=this.props;const a=u.ServerConnection.makeSettings();const t=d.URLExt.join(a.baseUrl,"/api/channels",e,"/members");return o.createElement(h.FetchHoc,{url:t,loadingMessage:"Fetching list of members",genericErrorMessage:"Error fetching members"},(e=>o.createElement("div",{className:"padding"},o.createElement(E.List,{columns:R(),data:e||[]}))))}}const T=S;const R=()=>[{Header:"",accessor:"name",Cell:({row:e})=>o.createElement("img",{src:e.original.user.profile.avatar_url,className:"profile-icon",alt:""}),width:10},{Header:"",accessor:"user.profile.name",width:40},{Header:"",accessor:"user.username",width:30},{Header:"",accessor:"role",width:20}];var _=t(65519);var A=t.n(_);class H extends o.PureComponent{render(){const{channel:e,selectedPackage:a}=this.props;const t=u.ServerConnection.makeSettings();const n=d.URLExt.join(t.baseUrl,"/api/channels",e,"/packages",a,"/versions");return o.createElement(h.FetchHoc,{url:n,loadingMessage:`Loading versions in ${a}`,genericErrorMessage:"Error fetching package versions information"},(n=>{if(n.length===0){return o.createElement("div",null,"No versions available for the package")}const r=n[0].info;return o.createElement(o.Fragment,null,o.createElement("div",{className:"package-row-flex"},o.createElement("div",null,o.createElement("h4",{className:"section-heading"},"Package Info"),o.createElement("p",{className:"minor-paragraph"},o.createElement("b",null,"Arch"),": ",r.arch||"n/a",o.createElement("br",null),o.createElement("b",null,"Build"),": ",r.build||"n/a",o.createElement("br",null),o.createElement("b",null,"MD5"),": ",r.md5,o.createElement("br",null),o.createElement("b",null,"Platform"),": ",n[0].platform||r.platform,o.createElement("br",null),o.createElement("b",null,"Version"),": ",r.version)),o.createElement("div",null,o.createElement("h4",{className:"section-heading"},"Install"),o.createElement("div",{className:"package-install-command"},o.createElement("pre",null,"mamba install -c ",e," ",a)))),o.createElement("h4",{className:"section-heading"},"Dependencies"),o.createElement("p",{className:"minor-paragraph"},(0,k.map)(r.depends,((e,a)=>o.createElement("span",{key:a,className:"tag"},e)))),o.createElement("h4",{className:"section-heading"},"History"),o.createElement("table",{className:"table-small full-width"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Uploader"),o.createElement("th",null,"Date"),o.createElement("th",null,"Filename"),o.createElement("th",null,"Platform"),o.createElement("th",null,"Size"),o.createElement("th",null,"Version"))),o.createElement("tbody",null,n.map((a=>o.createElement("tr",{key:a.time_created},o.createElement("td",null,a.uploader.name),o.createElement("td",null,A()(a.time_created,{max:1,suffix:true})),o.createElement("td",null,o.createElement("a",{href:d.URLExt.join(t.baseUrl,`/get/${e}/${a.info.subdir}/${a.filename}`),download:true},a.filename)),o.createElement("td",null,a.info.platform==="linux"?o.createElement("i",{className:"fa fa-linux fa-2x"}):a.info.platform==="osx"?o.createElement("i",{className:"fa fa-apple fa-2x"}):a.info.platform==="win"?o.createElement("i",{className:"fa fa-windows fa-2x"}):o.createElement("div",{className:"package-platform-noarch"},o.createElement("i",{className:"fa fa-linux"}),o.createElement("i",{className:"fa fa-apple"}),o.createElement("i",{className:"fa fa-windows"}))),o.createElement("td",null,(0,h.formatSize)(a.info.size)),o.createElement("td",null,a.version)))))))}))}}const U=H;class F extends o.PureComponent{constructor(){super(...arguments);this.renderRowSubComponent=({row:e})=>{const{channelId:a}=this.props;const t=e.values.name;return o.createElement(U,{selectedPackage:t,channel:a})}}render(){const{channelId:e}=this.props;const a=u.ServerConnection.makeSettings();const t=d.URLExt.join(a.baseUrl,"/api/paginated/channels",e,"/packages");return o.createElement(E.PaginatedTable,{url:t,enableSearch:true,columns:$(e),renderRowSubComponent:this.renderRowSubComponent})}}const M=F;const $=e=>[{id:"expander",Header:()=>null,Cell:({row:e})=>o.createElement("span",Object.assign({},e.getToggleRowExpandedProps({style:{paddingLeft:`${e.depth*2}rem`}})),o.createElement(m.FontAwesomeIcon,{icon:e.isExpanded?i.faAngleDown:i.faAngleRight}))},{Header:"Name",accessor:"name",Cell:({row:a})=>o.createElement(c.Link,{to:`${e}/packages/${a.values.name}`},a.values.name)},{Header:"Summary",accessor:"summary"},{Header:"Version",accessor:"current_version",Cell:({row:e})=>e.values.current_version||o.createElement("i",null,"n/a")}];var L;(function(e){e["Info"]="info";e["Packages"]="packages";e["Members"]="members";e["ApiKeys"]="api-keys"})(L||(L={}));class D extends o.PureComponent{constructor(e){var a;super(e);this.setTabId=e=>{this.setState({selectedTabId:e});const a=new URLSearchParams(window.location.search);a.delete("tab");a.delete("index");a.delete("query");a.delete("size");a.append("tab",e);history.pushState(null,"","?"+a.toString())};const t=new URLSearchParams(window.location.search);const n=(a=t.get("tab"))!==null&&a!==void 0?a:"info";this.state={selectedTabId:n!==null&&n!==void 0?n:L.Info}}render(){const{selectedTabId:e}=this.state;const{match:{params:a}}=this.props;const{channelId:t}=a;const n=[{text:"Home",onClick:()=>{this.props.router.navigate("/")}},{text:"Channels",onClick:()=>{this.props.router.navigate("/channels")}},{text:t}];return o.createElement(o.Fragment,null,o.createElement(h.Breadcrumbs,{items:n}),o.createElement("h2",{className:"heading2"},t),o.createElement(p.Tabs,{activeid:`channel-${e}`,onChange:e=>{this.setTabId(e.target.activeid.slice(8))}},o.createElement(p.Tab,{id:`channel-${L.Info}`},"Info"),o.createElement(p.Tab,{id:`channel-${L.Packages}`},"Packages"),o.createElement(p.Tab,{id:`channel-${L.Members}`},"Members"),o.createElement(p.Tab,{id:`channel-${L.ApiKeys}`},"API keys"),o.createElement(p.TabPanel,null,o.createElement(y,{channelId:t})),o.createElement(p.TabPanel,null,o.createElement(M,{channelId:t})),o.createElement(p.TabPanel,null,o.createElement(T,{channelId:t})),o.createElement(p.TabPanel,null,o.createElement(w,{channelId:t}))))}}const z=(0,c.withRouter)(D);class j extends o.PureComponent{render(){const{channelId:e,packageId:a}=this.props;return o.createElement("div",{className:"padding"},o.createElement(x,{filters:{channel:e,package:a}}))}}const q=j;class B extends o.PureComponent{constructor(){super(...arguments);this._formatPlatform=e=>{const a=[];const t=[];const n=[];const r=[];e.forEach((e=>{const l=e.split("-")[0];switch(l){case"linux":a.push(e);break;case"osx":t.push(e);break;case"win":n.push(e);break;default:r.push(e);break}}));if(r.length===1&&r[0]==="noarch"){return o.createElement("div",{className:"package-platform-icons"},o.createElement("i",{className:"fa fa-linux fa-2x package-platform-icon"}),o.createElement("i",{className:"fa fa-apple fa-2x package-platform-icon"}),o.createElement("i",{className:"fa fa-windows fa-2x package-platform-icon"}))}return o.createElement("div",{className:"package-row-flex"},a.length!==0&&o.createElement("div",null,o.createElement("div",{className:"package-files-row"},o.createElement("i",{className:"fa fa-linux fa-2x"})),o.createElement("ul",{className:"package-platform-list"},a.map(((e,a)=>o.createElement("p",{key:a},e))))),t.length!==0&&o.createElement("div",null,o.createElement("div",{className:"package-files-row"},o.createElement("i",{className:"fa fa-apple fa-2x"})),o.createElement("ul",{className:"package-platform-list"},t.map(((e,a)=>o.createElement("p",{key:a},e))))),n.length!==0&&o.createElement("div",null,o.createElement("div",{className:"package-files-row"},o.createElement("i",{className:"fa fa-windows fa-2x"})),o.createElement("ul",{className:"package-platform-list"},n.map(((e,a)=>o.createElement("p",{key:a},e))))),r.length!==0&&o.createElement("div",null,o.createElement("ul",{className:"package-platform-list"},r.map(((e,a)=>o.createElement("p",{key:a},e))))))}}render(){const{match:{params:{packageId:e,channelId:a}}}=this.props;const t=u.ServerConnection.makeSettings();const n=d.URLExt.join(t.baseUrl,"/api/channels",a,"/packages",e);return o.createElement("div",{className:"padding jp-table"},o.createElement(h.FetchHoc,{url:n,loadingMessage:"Fetching package information",genericErrorMessage:"Error fetching package information"},(e=>o.createElement(o.Fragment,null,o.createElement("h4",{className:"section-heading"},"Summary"),o.createElement("p",{className:"minor-paragraph"},e.summary||o.createElement("i",null,"n/a")),o.createElement("h4",{className:"section-heading"},"Description"),o.createElement("p",{className:"minor-paragraph"},e.description||o.createElement("i",null,"n/a")),e.platforms&&e.platforms.lenght!==0&&o.createElement("div",null,o.createElement("h4",{className:"section-heading"},"Platforms"),this._formatPlatform(e.platforms))))),o.createElement(U,{selectedPackage:e,channel:a}))}}const K=(0,c.withRouter)(B);class V extends o.PureComponent{render(){const{channelId:e,packageId:a}=this.props;const t=u.ServerConnection.makeSettings();const n=d.URLExt.join(t.baseUrl,"/api/channels",e,"/packages",a,"/members");return o.createElement(h.FetchHoc,{url:n,loadingMessage:"Fetching list of members",genericErrorMessage:"Error fetching members list"},(e=>o.createElement("div",{className:"package-files-wrapper padding"},(e||[]).map((e=>o.createElement("div",{className:"list-row",key:e.user.id},o.createElement("div",{className:"member-icon-column"},o.createElement("img",{src:e.user.profile.avatar_url,className:"profile-icon",alt:""})),o.createElement("div",{className:"member-name-column"},e.user.profile.name),o.createElement("div",{className:"member-username-column"},e.user.username),o.createElement("div",{className:"member-role-column"},e.role)))))))}}const O=V;var G;(function(e){e["Info"]="info";e["Members"]="members";e["ApiKeys"]="api-keys"})(G||(G={}));class W extends o.PureComponent{constructor(e){super(e);this.setTabId=e=>{this.setState({selectedTabId:e});history.pushState(null,"",`#${e}`)};const a=(window.location.hash||`#${G.Info}`).substring(1);this.state={selectedTabId:a!==null&&a!==void 0?a:G.Info}}render(){const{selectedTabId:e}=this.state;const{match:{params:a}}=this.props;const{channelId:t,packageId:n}=a;const r=[{text:"Home",onClick:()=>{this.props.router.navigate("/")}},{text:"Channels",onClick:()=>{this.props.router.navigate("/channels")}},{text:t,onClick:()=>{this.props.router.navigate(`/channels/${t}`)}},{text:"packages",onClick:()=>{this.props.router.navigate(`/channels/${t}?tab=packages`)}},{text:n}];return o.createElement("div",null,o.createElement(h.Breadcrumbs,{items:r}),o.createElement("h2",{className:"heading2"},t,"/",n),o.createElement(p.Tabs,{activeid:`package-${e}`,onChange:e=>{this.setTabId(e.target.activeid.slice(8))}},o.createElement(p.Tab,{id:`package-${G.Info}`},"Info"),o.createElement(p.Tab,{id:`package-${G.Members}`},"Members"),o.createElement(p.Tab,{id:`package-${G.ApiKeys}`},"API keys"),o.createElement(p.TabPanel,null,o.createElement(K,null)),o.createElement(p.TabPanel,null,o.createElement(O,{channelId:t,packageId:n})),o.createElement(p.TabPanel,null,o.createElement(q,{channelId:t,packageId:n}))))}}const J=(0,c.withRouter)(W);var Q;(function(e){e.open="@quetz-frontend/channels-extension:open";e.gotoChannels="@quetz-frontend/channels-extension:navigate-to-channels"})(Q||(Q={}));const X={id:"@quetz-frontend/channels-extension:plugin",autoStart:true,requires:[n.IRouter,s.IMenu],activate:(e,a,t)=>{const{commands:n,shell:r}=e;n.addCommand(Q.open,{label:"Open Channels Panel",execute:()=>{r.add(new Z(a),"main")}});n.addCommand(Q.gotoChannels,{label:"Channels",isVisible:()=>t.profile!==null,execute:()=>{a.navigate("/channels")}});a.register({pattern:/^\/channels.*/,command:Q.open});t.addItem({command:Q.gotoChannels,rank:200})}};const Y=X;class Z extends r.ReactWidget{constructor(e){super();this._router=e;this.id=r.DOMUtils.createDomID();this.title.label="Channels main page";this.title.icon=l.fileIcon;this.addClass("jp-ReactWidget")}render(){return o.createElement("div",{className:"page-contents-width-limit"},o.createElement(c.BrowserRouter,{basename:"/channels"},o.createElement(c.Switch,null,o.createElement(c.Route,{path:"/:channelId/packages/:packageId"},o.createElement(J,{router:this._router})),o.createElement(c.Route,{path:"/:channelId"},o.createElement(z,{router:this._router})),o.createElement(c.Route,{path:"",exact:true},o.createElement(f,{router:this._router})))))}}}}]);